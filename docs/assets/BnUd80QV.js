import{_ as ot}from"./Cnueas3R.js";import{u as it,_ as lt}from"./BRVvIQmY.js";import{b as rt,$ as ct,o as ut,m as p,r as T,a0 as D,a1 as _,a2 as dt,a3 as mt,J as pt,D as d,H as gt,E as t,I as R,F as o,K as G,G as $,Z as E,C as m,O as F,P as q,a4 as vt,a5 as _t,N as B,_ as bt}from"./cwvVFwCY.js";import{C as yt,a as kt,L as ht,P as ft,b as Ct,p as Tt,c as Rt,d as St,i as It,e as Pt}from"./VO69KI5H.js";import{u as Bt}from"./M6Px6Ek9.js";const Nt={class:"track-header"},wt={class:"track-header-image"},xt=["src","alt"],Lt={class:"track-header-info"},Mt={class:"track-country-badge"},At={class:"track-title"},zt={class:"track-fullname"},Qt={class:"track-meta"},Dt={class:"meta-item"},Gt={class:"meta-item"},$t={class:"meta-item"},Et={class:"page-layout"},Ft={class:"main-content"},qt={class:"section"},Ot={class:"chart-container"},Ut={class:"chart-wrapper"},Vt=["onClick"],Ht={class:"row-left"},Jt={class:"session-time"},Wt={class:"session-date"},jt={class:"session-car"},Yt={class:"row-right"},Kt={class:"stat-chips"},Zt={class:"stat-chip"},Xt={class:"stat-chip"},te={class:"time-slot"},ee={key:0,class:"time-badge time-badge--qualy"},se={key:1,class:"time-badge time-badge--qualy time-badge--empty"},ae={class:"time-slot"},ne={key:0,class:"time-badge time-badge--race"},oe={key:1,class:"time-badge time-badge--race time-badge--empty"},ie={class:"sidebar"},le={class:"sidebar-section"},re={class:"section-header-row"},ce=["value"],ue={class:"best-times-stack"},de={class:"best-time-card best-time-card--qualy"},me={class:"time-value"},pe={key:0,class:"time-conditions"},ge={key:1,class:"no-data-hint"},ve={class:"best-time-card best-time-card--race"},_e={class:"time-value"},be={key:0,class:"time-conditions"},ye={key:1,class:"no-data-hint"},ke={class:"best-time-card best-time-card--avg"},he={class:"time-value"},fe={key:0,class:"time-conditions"},Ce={key:1,class:"no-data-hint"},Te={class:"sidebar-section"},Re={class:"activity-stack"},Se={class:"activity-item"},Ie={class:"activity-value"},Pe={class:"activity-item"},Be={class:"activity-value"},Ne={class:"activity-label"},we={class:"activity-item"},xe={class:"activity-value"},Le={class:"activity-item"},Me={class:"activity-value"},N=20,Ae=rt({__name:"TrackDetailPage",props:{trackId:{},fromSession:{}},emits:["back","go-to-session"],setup(O,{emit:U}){const{getPublicPath:V}=Bt();yt.register(kt,ht,ft,Ct,Tt,Rt,St,It);const g=O,w=U,H=it(),{sessions:J,trackStats:W,loadSessions:j}=ct();ut(async()=>{await j(H.value||void 0)});const b=p(()=>{const a=g.trackId.toLowerCase().replace(/[^a-z0-9]/g,"_");return J.value.filter(e=>{const n=e.meta.track.toLowerCase().replace(/[^a-z0-9]/g,"_");return n.includes(a)||a.includes(n)}).sort((e,n)=>n.meta.date_start.localeCompare(e.meta.date_start))}),x=p(()=>{const a=g.trackId.toLowerCase().replace(/[^a-z0-9]/g,"_");return W.value.find(e=>{const n=e.track.toLowerCase().replace(/[^a-z0-9]/g,"_");return n.includes(a)||a.includes(n)})}),L={monza:{name:"Monza",fullName:"Autodromo Nazionale Monza",country:"Italia",countryCode:"IT",length:"5.793 km",turns:11,image:"/tracks/track_monza.png"},spa:{name:"Spa-Francorchamps",fullName:"Circuit de Spa-Francorchamps",country:"Belgio",countryCode:"BE",length:"7.004 km",turns:19,image:"/tracks/track_spa.png"},spa_francorchamps:{name:"Spa-Francorchamps",fullName:"Circuit de Spa-Francorchamps",country:"Belgio",countryCode:"BE",length:"7.004 km",turns:19,image:"/tracks/track_spa.png"},suzuka:{name:"Suzuka",fullName:"Suzuka International Racing Course",country:"Giappone",countryCode:"JP",length:"5.807 km",turns:18,image:"/tracks/track_suzuka.png"},donington:{name:"Donington Park",fullName:"Donington Park Racing Circuit",country:"Regno Unito",countryCode:"GB",length:"4.020 km",turns:12,image:"/tracks/track_donington.png"},donington_park:{name:"Donington Park",fullName:"Donington Park Racing Circuit",country:"Regno Unito",countryCode:"GB",length:"4.020 km",turns:12,image:"/tracks/track_donington.png"},valencia:{name:"Valencia",fullName:"Circuit Ricardo Tormo",country:"Spagna",countryCode:"ES",length:"4.005 km",turns:14,image:"/tracks/track_valencia.png"},nurburgring:{name:"Nürburgring",fullName:"Nürburgring Grand Prix Strecke",country:"Germania",countryCode:"DE",length:"5.148 km",turns:16,image:"/tracks/track_nurburgring.png"},silverstone:{name:"Silverstone",fullName:"Silverstone Circuit",country:"Regno Unito",countryCode:"GB",length:"5.891 km",turns:18,image:"/tracks/track_silverstone.png"},imola:{name:"Imola",fullName:"Autodromo Enzo e Dino Ferrari",country:"Italia",countryCode:"IT",length:"4.909 km",turns:19,image:"/tracks/track_imola.png"},barcelona:{name:"Barcelona",fullName:"Circuit de Barcelona-Catalunya",country:"Spagna",countryCode:"ES",length:"4.655 km",turns:16,image:"/tracks/track_barcelona.png"}},Y=["Optimum","Fast","Green","Greasy","Damp","Wet","Flood"],k=T("Optimum"),u=p(()=>{const a=g.trackId.toLowerCase().replace(/[^a-z0-9]/g,"_"),e=L[a]||L[g.trackId]||{name:D(g.trackId),fullName:D(g.trackId),country:"-",countryCode:"??",length:"-",turns:0,image:"/tracks/track_default.png"},n=x.value,l=k.value,s=n?.bestByGrip?.[l],i=s?.bestQualy||null,c=s?.bestRace||null,r=s?.bestAvgRace||null,v=i?{airTemp:s?.bestQualyTemp||0,roadTemp:0,grip:l}:null,h=c?{airTemp:s?.bestRaceTemp||0,roadTemp:0,grip:l}:null,y=r?{airTemp:s?.bestAvgRaceTemp||0,roadTemp:0,grip:l}:null;return{id:g.trackId,...e,sessions:b.value.length,lastSession:n?.lastSession||"-",bestQualy:i?_(i):null,bestRace:c?_(c):null,bestAvgRace:r?_(r):null,bestQualyConditions:v,bestRaceConditions:h,bestAvgRaceConditions:y,hasGripData:!!i||!!c||!!r}}),S=p(()=>b.value.map(a=>{const e=dt(a.meta.session_type),n=new Date(a.meta.date_start),l=a.summary||{};let s,i;if(l.best_qualy_ms&&(s=_(l.best_qualy_ms)),l.best_race_ms&&(i=_(l.best_race_ms)),!s&&!i&&l.bestLap){const c=_(l.bestLap);a.meta.session_type===1?s=c:(a.meta.session_type,i=c)}return{id:a.sessionId,date:a.meta.date_start?.split("T")[0]||"",time:n.toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"}),type:e,car:mt(a.meta.car),laps:l.laps||0,stints:l.stintCount||0,bestQualy:s,bestRace:i}})),I=T(1),K=p(()=>Math.max(1,Math.ceil(S.value.length/N))),Z=p(()=>{const a=(I.value-1)*N,e=a+N;return S.value.slice(a,e)}),M=T(null),P=T(!1);function X(){P.value=!0}const f=p(()=>{const a=b.value.reduce((i,c)=>i+(c.summary?.laps||0),0),e=b.value.reduce((i,c)=>i+(c.summary?.lapsValid||0),0),n=b.value.reduce((i,c)=>i+(c.summary?.totalTime||0),0),l=Math.floor(n/36e5),s=Math.floor(n%36e5/6e4);return{totalLaps:a,validLaps:e,validPercentage:a>0?Math.round(e/a*100):0,timeOnTrack:`${l}h ${s}m`,sessionsCount:b.value.length,lastActivity:x.value?.lastSession||"-"}}),A=p(()=>[...b.value].sort((e,n)=>e.meta.date_start.localeCompare(n.meta.date_start)).map(e=>{const n=e.summary,l=e.meta.date_start?.split("T")[0]||"",[s,i,c]=l.split("-"),r=["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],v=c&&i?`${parseInt(c)} ${r[parseInt(i)-1]}`:"N/A";let h=n?.best_qualy_ms||null,y=n?.best_race_ms||null;if(!h&&!y&&n?.bestLap){const Q=e.meta.session_type;Q===1?h=n.bestLap:y=n.bestLap}return{date:v,sessionId:e.sessionId,bestQualy:h?_(h):void 0,bestRace:y?_(y):void 0}}));function C(a){if(!a||!a.includes(":"))return 0;const e=a.split(":"),n=parseInt(e[0]||"0"),s=(e[1]||"0.000").split("."),i=parseInt(s[0]||"0"),c=parseInt(s[1]||"0");return n*60+i+c/1e3}function z(a){const e=Math.floor(a/60),n=(a%60).toFixed(3);return`${e}:${n.padStart(6,"0")}`}const tt=p(()=>{const a=A.value,e=[],n=[];return a.forEach((s,i)=>{s.bestQualy&&e.push({x:i,y:C(s.bestQualy),label:s.date}),s.bestRace&&n.push({x:i,y:C(s.bestRace),label:s.date})}),{labels:a.map(s=>s.date),datasets:[{label:"Best Qualifying",data:e,borderColor:"#f0b400",backgroundColor:"rgba(240, 180, 0, 0.1)",borderWidth:2.5,pointRadius:5,pointHoverRadius:7,pointBackgroundColor:"#f0b400",pointBorderColor:"#f0b400",tension:0,fill:!1,showLine:!0},{label:"Best Race",data:n,borderColor:"#ff6464",backgroundColor:"rgba(255, 100, 100, 0.1)",borderWidth:2.5,pointRadius:5,pointHoverRadius:7,pointBackgroundColor:"#ff6464",pointBorderColor:"#ff6464",tension:0,fill:!1,showLine:!0}]}}),et=p(()=>{const a=A.value,e=a.filter(r=>r.bestQualy).map(r=>C(r.bestQualy)),n=a.filter(r=>r.bestRace).map(r=>C(r.bestRace)),l=[...e,...n],s=l.length>0?Math.min(...l)-.5:0,i=l.length>0?Math.max(...l)+.5:120,c=a.map(r=>r.date);return{responsive:!0,maintainAspectRatio:!1,interaction:{intersect:!1,mode:"nearest"},plugins:{legend:{display:!0,position:"bottom",labels:{color:"rgba(255, 255, 255, 0.7)",usePointStyle:!0,padding:20,font:{family:"'Inter', sans-serif",size:12}}},tooltip:{enabled:!0,backgroundColor:"rgba(20, 20, 30, 0.95)",titleColor:"#fff",bodyColor:"rgba(255, 255, 255, 0.8)",borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1,cornerRadius:8,padding:12,callbacks:{title:function(r){return r[0]?.raw?.label||c[r[0]?.parsed?.x]||""},label:function(r){const v=r.parsed.y;return v==null?"":`${r.dataset.label}: ${z(v)}`}}}},scales:{x:{type:"linear",min:-.5,max:a.length-.5,grid:{color:"rgba(255, 255, 255, 0.06)",drawBorder:!1},ticks:{color:"rgba(255, 255, 255, 0.5)",font:{family:"'Inter', sans-serif",size:11},stepSize:1,callback:function(r){return c[Math.round(r)]||""}}},y:{min:s,max:i,grid:{color:"rgba(255, 255, 255, 0.06)",drawBorder:!1},ticks:{color:"rgba(255, 255, 255, 0.5)",font:{family:"'JetBrains Mono', monospace",size:11},callback:function(r){return z(r)}}}}}});function st(a){const e=new Date(a),n=e.getDate(),s=["Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"][e.getMonth()],i=e.getFullYear();return`${n} ${s} ${i}`}function at(a){return{practice:"PRACTICE",qualify:"QUALIFY",race:"RACE"}[a]}function nt(a){w("go-to-session",a)}return(a,e)=>{const n=ot,l=lt;return d(),pt(l,null,{default:gt(()=>[t("button",{class:"back-button",onClick:e[0]||(e[0]=s=>w("back"))},[e[4]||(e[4]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1)),R(" "+o(g.fromSession?"Torna alla sessione":"Torna alle piste"),1)]),t("div",Nt,[t("div",wt,[t("img",{src:G(V)(u.value.image),alt:u.value.name},null,8,xt)]),t("div",Lt,[t("span",Mt,o(u.value.countryCode),1),t("h1",At,o(u.value.name),1),t("p",zt,o(u.value.fullName),1),t("div",Qt,[t("span",Dt,[e[5]||(e[5]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M12 2L2 7l10 5 10-5-10-5z"}),t("path",{d:"M2 17l10 5 10-5"}),t("path",{d:"M2 12l10 5 10-5"})],-1)),R(" "+o(u.value.length),1)]),t("span",Gt,[e[6]||(e[6]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}),t("path",{d:"M9 12l2 2 4-4"})],-1)),R(" "+o(u.value.turns)+" curve ",1)]),t("span",$t,[e[7]||(e[7]=t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),t("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),t("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),t("line",{x1:"3",y1:"10",x2:"21",y2:"10"})],-1)),R(" "+o(u.value.sessions)+" sessioni ",1)])])])]),t("div",Et,[t("div",Ft,[t("div",qt,[e[8]||(e[8]=t("h2",{class:"section-title"},"Storico Tempi",-1)),t("div",Ot,[t("div",Ut,[$(G(Pt),{data:tt.value,options:et.value},null,8,["data","options"])])])]),t("div",{ref_key:"sessionsRef",ref:M,class:"section"},[e[10]||(e[10]=t("h2",{class:"section-title"},"Sessioni Recenti",-1)),t("div",{class:E(["sessions-list",{"sessions-list--fading":P.value}]),onTransitionend:e[1]||(e[1]=s=>P.value=!1)},[(d(!0),m(F,null,q(Z.value,s=>(d(),m("div",{key:s.id,class:"session-row",onClick:i=>nt(s.id)},[t("div",Ht,[t("span",{class:E(["session-chip",`session-chip--${s.type}`])},o(at(s.type)),3),t("span",Jt,o(s.time),1),t("span",Wt,o(st(s.date)),1),t("span",jt,o(s.car),1)]),t("div",Yt,[t("div",Kt,[t("span",Zt,"GIRI "+o(s.laps),1),t("span",Xt,"STINT "+o(s.stints),1)]),t("div",te,[s.bestQualy?(d(),m("span",ee," Q "+o(s.bestQualy),1)):(d(),m("span",se," Q — "))]),t("div",ae,[s.bestRace?(d(),m("span",ne," R "+o(s.bestRace),1)):(d(),m("span",oe," R — "))]),e[9]||(e[9]=t("span",{class:"session-cta"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M9 18l6-6-6-6"})])],-1))])],8,Vt))),128))],34)],512),$(n,{currentPage:I.value,"onUpdate:currentPage":e[2]||(e[2]=s=>I.value=s),"total-pages":K.value,"total-items":S.value.length,"scroll-target":M.value,"item-label":"sessioni",onPageChange:X},null,8,["currentPage","total-pages","total-items","scroll-target"])]),t("aside",ie,[t("div",le,[t("div",re,[e[11]||(e[11]=t("h2",{class:"section-title"},"Migliori Tempi",-1)),vt(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>k.value=s),class:"grip-selector"},[(d(),m(F,null,q(Y,s=>t("option",{key:s,value:s},o(s),9,ce)),64))],512),[[_t,k.value]])]),t("div",ue,[t("div",de,[e[12]||(e[12]=t("span",{class:"time-label"},"Best Stint Qualifying",-1)),t("span",me,o(u.value.bestQualy||"—:—.---"),1),u.value.bestQualyConditions?(d(),m("span",pe,[t("span",null,"Aria "+o(u.value.bestQualyConditions.airTemp)+"°C",1)])):u.value.bestQualy?B("",!0):(d(),m("span",ge,"Nessun dato per "+o(k.value),1))]),t("div",ve,[e[13]||(e[13]=t("span",{class:"time-label"},"Best Stint Race",-1)),t("span",_e,o(u.value.bestRace||"—:—.---"),1),u.value.bestRaceConditions?(d(),m("span",be,[t("span",null,"Aria "+o(u.value.bestRaceConditions.airTemp)+"°C",1)])):u.value.bestRace?B("",!0):(d(),m("span",ye,"Nessun dato per "+o(k.value),1))]),t("div",ke,[e[14]||(e[14]=t("span",{class:"time-label"},"Best Stint Avg Race",-1)),t("span",he,o(u.value.bestAvgRace||"—:—.---"),1),u.value.bestAvgRaceConditions?(d(),m("span",fe,[t("span",null,"Aria "+o(u.value.bestAvgRaceConditions.airTemp)+"°C",1)])):u.value.bestAvgRace?B("",!0):(d(),m("span",Ce,"Nessun dato per "+o(k.value),1))])])]),t("div",Te,[e[18]||(e[18]=t("h2",{class:"section-title"},"Attività Totale",-1)),t("div",Re,[t("div",Se,[t("span",Ie,o(f.value.totalLaps),1),e[15]||(e[15]=t("span",{class:"activity-label"},"Giri Totali",-1))]),t("div",Pe,[t("span",Be,o(f.value.validLaps),1),t("span",Ne,"Giri Validi ("+o(f.value.validPercentage)+"%)",1)]),t("div",we,[t("span",xe,o(f.value.timeOnTrack),1),e[16]||(e[16]=t("span",{class:"activity-label"},"Tempo in Pista",-1))]),t("div",Le,[t("span",Me,o(f.value.sessionsCount),1),e[17]||(e[17]=t("span",{class:"activity-label"},"Sessioni",-1))])])])])])]),_:1})}}}),Ee=Object.assign(bt(Ae,[["__scopeId","data-v-abbdd2b3"]]),{__name:"PagesTrackDetailPage"});export{Ee as _};
