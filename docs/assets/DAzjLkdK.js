import{_ as j}from"./sRjqG-FK.js";import{a as z,u as H,g as Z,b as M,c as J,f as K,d as W,S as E,_ as X}from"./CGdAk5Ew.js";import{b as tt,o as et,m as p,r as g,w as st,J as at,D as n,H as ot,E as t,C as l,G as nt,Z as d,$ as O,O as m,P as _,F as i,a0 as B,_ as lt}from"./CQmpsz2T.js";const it={class:"filters"},rt={class:"filters-left"},ct={class:"filter-group"},dt={class:"segmented-control"},ut={class:"filter-group"},vt=["value"],pt={class:"filter-group"},gt=["value"],mt={class:"filter-group"},_t={class:"segmented-control segmented-control--compact"},ft={class:"filters-right"},yt={class:"view-toggle"},bt={key:0,class:"no-results"},ht={class:"day-header"},kt={class:"day-date"},Ct={class:"day-count"},wt={class:"sessions-list"},Tt=["onClick"],St={class:"row-left"},Rt={class:"session-time"},It={class:"session-track"},xt={class:"session-car"},Pt={class:"row-right"},$t={class:"stat-chips"},Mt={class:"stat-chip"},Et={class:"stat-chip"},Ot={class:"time-slot"},Bt={key:0,class:"time-badge time-badge--qualy"},Dt={key:1,class:"time-badge time-badge--qualy time-badge--empty"},Lt={class:"time-slot"},Nt={key:0,class:"time-badge time-badge--race"},Qt={key:1,class:"time-badge time-badge--race time-badge--empty"},At={key:2,class:"day-cards"},Gt={class:"card-header"},Ut={class:"card-header-info"},qt={class:"card-date"},Ft={class:"card-count"},Vt={class:"card-sessions"},Yt=["onClick"],jt={class:"card-session-time"},zt={class:"card-session-track"},Ht={class:"card-session-car"},Zt={class:"card-stat-chips"},Jt={class:"stat-chip"},Kt={class:"stat-chip"},Wt={class:"card-time-slot"},Xt={key:0,class:"time-badge time-badge--qualy"},te={key:1,class:"time-badge time-badge--qualy time-badge--empty"},ee={class:"card-time-slot"},se={key:0,class:"time-badge time-badge--race"},ae={key:1,class:"time-badge time-badge--race time-badge--empty"},S=20,oe=tt({__name:"SessioniPage",emits:["go-to-session"],setup(ne,{emit:D}){const L=D,{sessions:N,loadSessions:Q}=z(),A=H();et(async()=>{await Q(A.value||void 0)});const k=p(()=>N.value.map(a=>{const e=Z(a.meta.session_type),c=a.meta.date_start?.split("T")[0]||"";return{id:a.sessionId,date:c,time:W(a.meta.date_start),type:e,track:K(a.meta.track),car:J(a.meta.car),laps:a.summary.laps||0,stints:a.summary.stintCount||1,bestQualy:a.meta.session_type===E.QUALIFY?M(a.summary.bestLap):void 0,bestRace:a.meta.session_type===E.RACE?M(a.summary.bestLap):void 0}})),u=g("all"),f=g("all"),y=g("all"),r=g("all"),b=g("list"),G=p(()=>[...new Set(k.value.map(a=>a.track))].sort()),U=p(()=>[...new Set(k.value.map(a=>a.car))].sort()),C=p(()=>k.value.filter(a=>{if(u.value!=="all"&&a.type!==u.value||f.value!=="all"&&a.track!==f.value||y.value!=="all"&&a.car!==y.value)return!1;if(r.value!=="all"){const e=new Date,c=new Date(a.date),v=Math.floor((e.getTime()-c.getTime())/(1e3*60*60*24));if(r.value==="today"&&v>0||r.value==="7d"&&v>7||r.value==="30d"&&v>30)return!1}return!0}));p(()=>{const a={};for(const e of C.value)a[e.date]||(a[e.date]=[]),a[e.date].push(e);return Object.entries(a).sort(([e],[c])=>c.localeCompare(e)).map(([e,c])=>({date:e,sessions:c}))});const h=g(1),R=p(()=>C.value.length),q=p(()=>Math.max(1,Math.ceil(R.value/S))),w=p(()=>{const a=(h.value-1)*S,e=a+S,c=C.value.slice(a,e),v={};for(const s of c)v[s.date]||(v[s.date]=[]),v[s.date].push(s);return Object.entries(v).sort(([s],[o])=>o.localeCompare(s)).map(([s,o])=>({date:s,sessions:o}))});function F(){h.value=1}st([u,f,y,r],F);const I=g(null),T=g(!1);function V(){T.value=!0}function x(a){const e=new Date(a),c=e.getDate(),s=["GENNAIO","FEBBRAIO","MARZO","APRILE","MAGGIO","GIUGNO","LUGLIO","AGOSTO","SETTEMBRE","OTTOBRE","NOVEMBRE","DICEMBRE"][e.getMonth()],o=e.getFullYear();return`${c} ${s} ${o}`}function P(a){return{practice:"PRACTICE",qualify:"QUALIFY",race:"RACE"}[a]}function $(a){L("go-to-session",a)}return(a,e)=>{const c=j,v=X;return n(),at(v,null,{default:ot(()=>[e[21]||(e[21]=t("h1",{class:"page-title"},"SESSIONI",-1)),t("div",it,[t("div",rt,[t("div",ct,[t("div",dt,[t("button",{class:d(["seg-btn",{"seg-btn--active":u.value==="all"}]),onClick:e[0]||(e[0]=s=>u.value="all")},"Tutto",2),t("button",{class:d(["seg-btn","seg-btn--practice",{"seg-btn--active":u.value==="practice"}]),onClick:e[1]||(e[1]=s=>u.value="practice")},"Practice",2),t("button",{class:d(["seg-btn","seg-btn--qualify",{"seg-btn--active":u.value==="qualify"}]),onClick:e[2]||(e[2]=s=>u.value="qualify")},"Qualify",2),t("button",{class:d(["seg-btn","seg-btn--race",{"seg-btn--active":u.value==="race"}]),onClick:e[3]||(e[3]=s=>u.value="race")},"Race",2)])]),t("div",ut,[O(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>f.value=s),class:"filter-select"},[e[14]||(e[14]=t("option",{value:"all"},"Tutte le piste",-1)),(n(!0),l(m,null,_(G.value,s=>(n(),l("option",{key:s,value:s},i(s),9,vt))),128))],512),[[B,f.value]])]),t("div",pt,[O(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>y.value=s),class:"filter-select"},[e[15]||(e[15]=t("option",{value:"all"},"Tutte le auto",-1)),(n(!0),l(m,null,_(U.value,s=>(n(),l("option",{key:s,value:s},i(s),9,gt))),128))],512),[[B,y.value]])]),t("div",mt,[t("div",_t,[t("button",{class:d(["seg-btn",{"seg-btn--active":r.value==="today"}]),onClick:e[6]||(e[6]=s=>r.value="today")},"Oggi",2),t("button",{class:d(["seg-btn",{"seg-btn--active":r.value==="7d"}]),onClick:e[7]||(e[7]=s=>r.value="7d")},"7g",2),t("button",{class:d(["seg-btn",{"seg-btn--active":r.value==="30d"}]),onClick:e[8]||(e[8]=s=>r.value="30d")},"30g",2),t("button",{class:d(["seg-btn",{"seg-btn--active":r.value==="all"}]),onClick:e[9]||(e[9]=s=>r.value="all")},"Tutto",2)])])]),t("div",ft,[t("div",yt,[t("button",{class:d(["view-btn",{"view-btn--active":b.value==="list"}]),onClick:e[10]||(e[10]=s=>b.value="list"),title:"Vista lista"},[...e[16]||(e[16]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01"})],-1)])],2),t("button",{class:d(["view-btn",{"view-btn--active":b.value==="card"}]),onClick:e[11]||(e[11]=s=>b.value="card"),title:"Vista card"},[...e[17]||(e[17]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),t("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),t("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),t("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"})],-1)])],2)])])]),w.value.length===0?(n(),l("div",bt,[...e[18]||(e[18]=[t("p",null,"Nessuna sessione trovata con i filtri selezionati.",-1)])])):b.value==="list"?(n(),l("div",{key:1,ref_key:"sessionsRef",ref:I,class:d(["day-groups",{"day-groups--fading":T.value}]),onTransitionend:e[12]||(e[12]=s=>T.value=!1)},[(n(!0),l(m,null,_(w.value,s=>(n(),l("div",{key:s.date,class:"day-group"},[t("div",ht,[t("span",kt,i(x(s.date)),1),t("span",Ct,i(s.sessions.length)+" sessioni",1)]),t("div",wt,[(n(!0),l(m,null,_(s.sessions,o=>(n(),l("div",{key:o.id,class:"session-row",onClick:Y=>$(o.id)},[t("div",St,[t("span",{class:d(["session-chip",`session-chip--${o.type}`])},i(P(o.type)),3),t("span",Rt,i(o.time),1),t("span",It,i(o.track),1),t("span",xt,i(o.car),1)]),t("div",Pt,[t("div",$t,[t("span",Mt,"GIRI "+i(o.laps),1),t("span",Et,"STINT "+i(o.stints),1)]),t("div",Ot,[o.bestQualy?(n(),l("span",Bt," Q "+i(o.bestQualy),1)):(n(),l("span",Dt," Q — "))]),t("div",Lt,[o.bestRace?(n(),l("span",Nt," R "+i(o.bestRace),1)):(n(),l("span",Qt," R — "))]),e[19]||(e[19]=t("span",{class:"session-cta"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M9 18l6-6-6-6"})])],-1))])],8,Tt))),128))])]))),128))],34)):(n(),l("div",At,[(n(!0),l(m,null,_(w.value,s=>(n(),l("div",{key:s.date,class:"day-card"},[t("div",Gt,[t("div",Ut,[t("span",qt,i(x(s.date)),1),t("span",Ft,i(s.sessions.length)+" sessioni",1)])]),t("div",Vt,[(n(!0),l(m,null,_(s.sessions,o=>(n(),l("div",{key:o.id,class:"card-session-row",onClick:Y=>$(o.id)},[t("span",{class:d(["session-chip",`session-chip--${o.type}`])},i(P(o.type)),3),t("span",jt,i(o.time),1),t("span",zt,i(o.track),1),t("span",Ht,i(o.car),1),t("div",Zt,[t("span",Jt,"GIRI "+i(o.laps),1),t("span",Kt,"STINT "+i(o.stints),1)]),t("div",Wt,[o.bestQualy?(n(),l("span",Xt," Q "+i(o.bestQualy),1)):(n(),l("span",te," Q — "))]),t("div",ee,[o.bestRace?(n(),l("span",se," R "+i(o.bestRace),1)):(n(),l("span",ae," R — "))]),e[20]||(e[20]=t("span",{class:"session-cta"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M9 18l6-6-6-6"})])],-1))],8,Yt))),128))])]))),128))])),nt(c,{currentPage:h.value,"onUpdate:currentPage":e[13]||(e[13]=s=>h.value=s),"total-pages":q.value,"total-items":R.value,"scroll-target":I.value,"item-label":"sessioni",onPageChange:V},null,8,["currentPage","total-pages","total-items","scroll-target"])]),_:1})}}}),ce=Object.assign(lt(oe,[["__scopeId","data-v-13f10fa0"]]),{__name:"PagesSessioniPage"});export{ce as _};
