import{_ as H}from"./Cnueas3R.js";import{u as z,_ as Y}from"./BRVvIQmY.js";import{b as Z,$ as J,o as K,m as g,a2 as W,a1 as O,a3 as X,a0 as tt,aa as et,r as p,w as st,J as at,D as l,H as ot,E as t,C as n,G as lt,Z as d,a4 as R,O as m,P as _,F as i,a5 as B,ab as nt,_ as it}from"./cwvVFwCY.js";const rt={class:"filters"},ct={class:"filters-left"},dt={class:"filter-group"},ut={class:"segmented-control"},vt={class:"filter-group"},pt=["value"],gt={class:"filter-group"},mt=["value"],_t={class:"filter-group"},yt={class:"segmented-control segmented-control--compact"},bt={class:"filter-group filter-group--toggle"},ft={class:"toggle-label"},ht={class:"filters-right"},kt={class:"view-toggle"},Ct={key:0,class:"no-results"},wt={class:"day-header"},Tt={class:"day-date"},xt={class:"day-count"},Rt={class:"sessions-list"},Mt=["onClick"],St={class:"row-left"},$t={class:"session-time"},It={class:"session-track"},Pt={class:"session-car"},Et={class:"row-right"},Ot={class:"stat-chips"},Bt={class:"stat-chip"},Dt={class:"stat-chip"},Nt={class:"time-slot"},Qt={key:0,class:"time-badge time-badge--qualy"},Vt={key:1,class:"time-badge time-badge--qualy time-badge--empty"},qt={class:"time-slot"},Gt={key:0,class:"time-badge time-badge--race"},Lt={key:1,class:"time-badge time-badge--race time-badge--empty"},At={key:2,class:"day-cards"},Ut={class:"card-header"},Ft={class:"card-header-info"},jt={class:"card-date"},Ht={class:"card-count"},zt={class:"card-sessions"},Yt=["onClick"],Zt={class:"card-session-time"},Jt={class:"card-session-track"},Kt={class:"card-session-car"},Wt={class:"card-stat-chips"},Xt={class:"stat-chip"},te={class:"stat-chip"},ee={class:"card-time-slot"},se={key:0,class:"time-badge time-badge--qualy"},ae={key:1,class:"time-badge time-badge--qualy time-badge--empty"},oe={class:"card-time-slot"},le={key:0,class:"time-badge time-badge--race"},ne={key:1,class:"time-badge time-badge--race time-badge--empty"},M=20,ie=Z({__name:"SessioniPage",emits:["go-to-session"],setup(re,{emit:D}){const N=D,{sessions:Q,loadSessions:V}=J(),q=z();K(async()=>{await V(q.value||void 0)});const k=g(()=>Q.value.map(a=>{const e=W(a.meta.session_type),c=a.meta.date_start?.split("T")[0]||"";return{id:a.sessionId,date:c,time:et(a.meta.date_start),type:e,track:tt(a.meta.track),car:X(a.meta.car),laps:a.summary.laps||0,lapsValid:a.summary.lapsValid||0,stints:a.summary.stintCount||1,bestQualy:a.summary.best_qualy_ms?O(a.summary.best_qualy_ms):void 0,bestRace:a.summary.best_race_ms?O(a.summary.best_race_ms):void 0}})),u=p("all"),y=p("all"),b=p("all"),r=p("all"),C=p(!1),f=p("list"),G=g(()=>[...new Set(k.value.map(a=>a.track))].sort()),L=g(()=>[...new Set(k.value.map(a=>a.car))].sort()),w=g(()=>k.value.filter(a=>{if(C.value&&a.lapsValid===0||u.value!=="all"&&a.type!==u.value||y.value!=="all"&&a.track!==y.value||b.value!=="all"&&a.car!==b.value)return!1;if(r.value!=="all"){const e=new Date,c=new Date(a.date),v=Math.floor((e.getTime()-c.getTime())/(1e3*60*60*24));if(r.value==="today"&&v>0||r.value==="7d"&&v>7||r.value==="30d"&&v>30)return!1}return!0}));g(()=>{const a={};for(const e of w.value)a[e.date]||(a[e.date]=[]),a[e.date].push(e);return Object.entries(a).sort(([e],[c])=>c.localeCompare(e)).map(([e,c])=>({date:e,sessions:c}))});const h=p(1),S=g(()=>w.value.length),A=g(()=>Math.max(1,Math.ceil(S.value/M))),T=g(()=>{const a=(h.value-1)*M,e=a+M,c=w.value.slice(a,e),v={};for(const s of c)v[s.date]||(v[s.date]=[]),v[s.date].push(s);return Object.entries(v).sort(([s],[o])=>o.localeCompare(s)).map(([s,o])=>({date:s,sessions:o}))});function U(){h.value=1}st([u,y,b,r],U);const $=p(null),x=p(!1);function F(){x.value=!0}function I(a){const e=new Date(a),c=e.getDate(),s=["GENNAIO","FEBBRAIO","MARZO","APRILE","MAGGIO","GIUGNO","LUGLIO","AGOSTO","SETTEMBRE","OTTOBRE","NOVEMBRE","DICEMBRE"][e.getMonth()],o=e.getFullYear();return`${c} ${s} ${o}`}function P(a){return{practice:"PRACTICE",qualify:"QUALIFY",race:"RACE"}[a]}function E(a){N("go-to-session",a)}return(a,e)=>{const c=H,v=Y;return l(),at(v,null,{default:ot(()=>[e[24]||(e[24]=t("h1",{class:"page-title"},"SESSIONI",-1)),t("div",rt,[t("div",ct,[t("div",dt,[t("div",ut,[t("button",{class:d(["seg-btn",{"seg-btn--active":u.value==="all"}]),onClick:e[0]||(e[0]=s=>u.value="all")},"Tutto",2),t("button",{class:d(["seg-btn","seg-btn--practice",{"seg-btn--active":u.value==="practice"}]),onClick:e[1]||(e[1]=s=>u.value="practice")},"Practice",2),t("button",{class:d(["seg-btn","seg-btn--qualify",{"seg-btn--active":u.value==="qualify"}]),onClick:e[2]||(e[2]=s=>u.value="qualify")},"Qualify",2),t("button",{class:d(["seg-btn","seg-btn--race",{"seg-btn--active":u.value==="race"}]),onClick:e[3]||(e[3]=s=>u.value="race")},"Race",2)])]),t("div",vt,[R(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>y.value=s),class:"filter-select"},[e[15]||(e[15]=t("option",{value:"all"},"Tutte le piste",-1)),(l(!0),n(m,null,_(G.value,s=>(l(),n("option",{key:s,value:s},i(s),9,pt))),128))],512),[[B,y.value]])]),t("div",gt,[R(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>b.value=s),class:"filter-select"},[e[16]||(e[16]=t("option",{value:"all"},"Tutte le auto",-1)),(l(!0),n(m,null,_(L.value,s=>(l(),n("option",{key:s,value:s},i(s),9,mt))),128))],512),[[B,b.value]])]),t("div",_t,[t("div",yt,[t("button",{class:d(["seg-btn",{"seg-btn--active":r.value==="today"}]),onClick:e[6]||(e[6]=s=>r.value="today")},"Oggi",2),t("button",{class:d(["seg-btn",{"seg-btn--active":r.value==="7d"}]),onClick:e[7]||(e[7]=s=>r.value="7d")},"7g",2),t("button",{class:d(["seg-btn",{"seg-btn--active":r.value==="30d"}]),onClick:e[8]||(e[8]=s=>r.value="30d")},"30g",2),t("button",{class:d(["seg-btn",{"seg-btn--active":r.value==="all"}]),onClick:e[9]||(e[9]=s=>r.value="all")},"Tutto",2)])]),t("div",bt,[t("label",ft,[R(t("input",{type:"checkbox","onUpdate:modelValue":e[10]||(e[10]=s=>C.value=s),class:"toggle-checkbox"},null,512),[[nt,C.value]]),e[17]||(e[17]=t("span",{class:"toggle-switch"},null,-1)),e[18]||(e[18]=t("span",{class:"toggle-text"},"Nascondi vuote",-1))])])]),t("div",ht,[t("div",kt,[t("button",{class:d(["view-btn",{"view-btn--active":f.value==="list"}]),onClick:e[11]||(e[11]=s=>f.value="list"),title:"Vista lista"},[...e[19]||(e[19]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01"})],-1)])],2),t("button",{class:d(["view-btn",{"view-btn--active":f.value==="card"}]),onClick:e[12]||(e[12]=s=>f.value="card"),title:"Vista card"},[...e[20]||(e[20]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),t("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),t("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),t("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"})],-1)])],2)])])]),T.value.length===0?(l(),n("div",Ct,[...e[21]||(e[21]=[t("p",null,"Nessuna sessione trovata con i filtri selezionati.",-1)])])):f.value==="list"?(l(),n("div",{key:1,ref_key:"sessionsRef",ref:$,class:d(["day-groups",{"day-groups--fading":x.value}]),onTransitionend:e[13]||(e[13]=s=>x.value=!1)},[(l(!0),n(m,null,_(T.value,s=>(l(),n("div",{key:s.date,class:"day-group"},[t("div",wt,[t("span",Tt,i(I(s.date)),1),t("span",xt,i(s.sessions.length)+" sessioni",1)]),t("div",Rt,[(l(!0),n(m,null,_(s.sessions,o=>(l(),n("div",{key:o.id,class:"session-row",onClick:j=>E(o.id)},[t("div",St,[t("span",{class:d(["session-chip",`session-chip--${o.type}`])},i(P(o.type)),3),t("span",$t,i(o.time),1),t("span",It,i(o.track),1),t("span",Pt,i(o.car),1)]),t("div",Et,[t("div",Ot,[t("span",Bt,"GIRI "+i(o.laps),1),t("span",Dt,"STINT "+i(o.stints),1)]),t("div",Nt,[o.bestQualy?(l(),n("span",Qt," Q "+i(o.bestQualy),1)):(l(),n("span",Vt," Q — "))]),t("div",qt,[o.bestRace?(l(),n("span",Gt," R "+i(o.bestRace),1)):(l(),n("span",Lt," R — "))]),e[22]||(e[22]=t("span",{class:"session-cta"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M9 18l6-6-6-6"})])],-1))])],8,Mt))),128))])]))),128))],34)):(l(),n("div",At,[(l(!0),n(m,null,_(T.value,s=>(l(),n("div",{key:s.date,class:"day-card"},[t("div",Ut,[t("div",Ft,[t("span",jt,i(I(s.date)),1),t("span",Ht,i(s.sessions.length)+" sessioni",1)])]),t("div",zt,[(l(!0),n(m,null,_(s.sessions,o=>(l(),n("div",{key:o.id,class:"card-session-row",onClick:j=>E(o.id)},[t("span",{class:d(["session-chip",`session-chip--${o.type}`])},i(P(o.type)),3),t("span",Zt,i(o.time),1),t("span",Jt,i(o.track),1),t("span",Kt,i(o.car),1),t("div",Wt,[t("span",Xt,"GIRI "+i(o.laps),1),t("span",te,"STINT "+i(o.stints),1)]),t("div",ee,[o.bestQualy?(l(),n("span",se," Q "+i(o.bestQualy),1)):(l(),n("span",ae," Q — "))]),t("div",oe,[o.bestRace?(l(),n("span",le," R "+i(o.bestRace),1)):(l(),n("span",ne," R — "))]),e[23]||(e[23]=t("span",{class:"session-cta"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M9 18l6-6-6-6"})])],-1))],8,Yt))),128))])]))),128))])),lt(c,{currentPage:h.value,"onUpdate:currentPage":e[14]||(e[14]=s=>h.value=s),"total-pages":A.value,"total-items":S.value,"scroll-target":$.value,"item-label":"sessioni",onPageChange:F},null,8,["currentPage","total-pages","total-items","scroll-target"])]),_:1})}}}),ve=Object.assign(it(ie,[["__scopeId","data-v-7001486d"]]),{__name:"PagesSessioniPage"});export{ve as _};
