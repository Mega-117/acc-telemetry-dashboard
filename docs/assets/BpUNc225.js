import{b as Nn,r as tt,o as Ln,ai as ss,E as C,F as x,G as r,I as ee,a9 as mn,a0 as ot,M as se,J as ne,P as K,af as is,H as g,am as os,_ as Dn,a2 as as,t as U,a4 as xt,a6 as rs,ad as ls,an as us,a5 as cs,w as Ze,L as ds,K as w,Q as pt,R as Re,$ as me,a7 as gn,ae as Tn}from"./6ziaMTTu.js";import{_ as ps}from"./DohYDBO7.js";import{f as Ft,g as Q,h as nn,v as we,j as bn,s as yn,_ as fs,C as vs,a as hs,L as ms,P as gs,b as Ts,p as bs,c as ys,d as _s,i as Es,e as Ss}from"./3RLIVK0Z.js";import{u as xs}from"./D42-Tgau.js";const Cs=["width","height"],Is=Nn({__name:"InfoPopup",props:{title:{},position:{default:"left"},size:{default:"normal"}},setup(t){const s=tt(!1),i=tt(null),u=l=>{i.value&&!i.value.contains(l.target)&&(s.value=!1)};return Ln(()=>{document.addEventListener("click",u)}),ss(()=>{document.removeEventListener("click",u)}),(l,c)=>(x(),C("span",{ref_key:"popupRef",ref:i,class:"info-popup-wrapper"},[r("span",{class:ot(["info-icon",{"info-icon--small":t.size==="small"}]),onClick:c[0]||(c[0]=mn(v=>s.value=!se(s),["stop"]))},[(x(),C("svg",{width:t.size==="small"?12:14,height:t.size==="small"?12:14,viewBox:"0 0 512 512"},[...c[2]||(c[2]=[r("circle",{cx:"256",cy:"256",r:"256",fill:"currentColor"},null,-1),r("text",{x:"256",y:"380","text-anchor":"middle","font-size":"340","font-weight":"700","font-family":"Arial",fill:"#1a1a2e"},"i",-1)])],8,Cs))],2),ee(os,{name:"popup-fade"},{default:ne(()=>[se(s)?(x(),C("div",{key:0,class:ot(["info-popup",{"info-popup-right":t.position==="right"}])},[r("strong",null,g(t.title),1),c[3]||(c[3]=r("br",null,null,-1)),is(l.$slots,"default",{},void 0,!0),r("span",{class:"info-close",onClick:c[1]||(c[1]=mn(v=>s.value=!1,["stop"]))},"✕")],2)):K("",!0)]),_:3})],512))}}),Ps=Object.assign(Dn(Is,[["__scopeId","data-v-6594129b"]]),{__name:"UiInfoPopup"});function Ms(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Xe={exports:{}};var _n;function Os(){return _n||(_n=1,(function(t){(function(s,i,u,l){var c=["","webkit","Moz","MS","ms","o"],v=i.createElement("div"),m="function",E=Math.round,S=Math.abs,I=Date.now;function D(e,n,a){return setTimeout(Vt(e,a),n)}function N(e,n,a){return Array.isArray(e)?(z(e,a[n],a),!0):!1}function z(e,n,a){var d;if(e)if(e.forEach)e.forEach(n,a);else if(e.length!==l)for(d=0;d<e.length;)n.call(a,e[d],d,e),d++;else for(d in e)e.hasOwnProperty(d)&&n.call(a,e[d],d,e)}function kt(e,n,a){var d="DEPRECATED METHOD: "+n+`
`+a+` AT 
`;return function(){var h=new Error("get-stack-trace"),T=h&&h.stack?h.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",M=s.console&&(s.console.warn||s.console.log);return M&&M.call(s.console,d,T),e.apply(this,arguments)}}var et;typeof Object.assign!="function"?et=function(n){if(n===l||n===null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(n),d=1;d<arguments.length;d++){var h=arguments[d];if(h!==l&&h!==null)for(var T in h)h.hasOwnProperty(T)&&(a[T]=h[T])}return a}:et=Object.assign;var Ut=kt(function(n,a,d){for(var h=Object.keys(a),T=0;T<h.length;)(!d||d&&n[h[T]]===l)&&(n[h[T]]=a[h[T]]),T++;return n},"extend","Use `assign`."),oe=kt(function(n,a){return Ut(n,a,!0)},"merge","Use `assign`.");function Z(e,n,a){var d=n.prototype,h;h=e.prototype=Object.create(d),h.constructor=e,h._super=d,a&&et(h,a)}function Vt(e,n){return function(){return e.apply(n,arguments)}}function at(e,n){return typeof e==m?e.apply(n&&n[0]||l,n):e}function nt(e,n){return e===l?n:e}function ht(e,n,a){z(Zt(n),function(d){e.addEventListener(d,a,!1)})}function ct(e,n,a){z(Zt(n),function(d){e.removeEventListener(d,a,!1)})}function Tt(e,n){for(;e;){if(e==n)return!0;e=e.parentNode}return!1}function st(e,n){return e.indexOf(n)>-1}function Zt(e){return e.trim().split(/\s+/g)}function wt(e,n,a){if(e.indexOf&&!a)return e.indexOf(n);for(var d=0;d<e.length;){if(a&&e[d][a]==n||!a&&e[d]===n)return d;d++}return-1}function Xt(e){return Array.prototype.slice.call(e,0)}function H(e,n,a){for(var d=[],h=[],T=0;T<e.length;){var M=e[T][n];wt(h,M)<0&&d.push(e[T]),h[T]=M,T++}return d=d.sort(function(J,ut){return J[n]>ut[n]}),d}function B(e,n){for(var a,d,h=n[0].toUpperCase()+n.slice(1),T=0;T<c.length;){if(a=c[T],d=a?a+h:n,d in e)return d;T++}return l}var mt=1;function ae(){return mt++}function O(e){var n=e.ownerDocument||e;return n.defaultView||n.parentWindow||s}var rt=/mobile|tablet|ip(ad|hone|od)|android/i,ye="ontouchstart"in s,re=B(s,"PointerEvent")!==l,_e=ye&&rt.test(navigator.userAgent),Nt="touch",le="pen",ue="mouse",Ee="kinect",Se=25,X=1,dt=2,F=4,V=8,Wt=1,Gt=2,it=4,Mt=8,Ht=16,lt=Gt|it,Ot=Mt|Ht,$t=lt|Ot,ce=["x","y"],Qt=["clientX","clientY"];function Y(e,n){var a=this;this.manager=e,this.callback=n,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(d){at(e.options.enable,[e])&&a.handler(d)},this.init()}Y.prototype={handler:function(){},init:function(){this.evEl&&ht(this.element,this.evEl,this.domHandler),this.evTarget&&ht(this.target,this.evTarget,this.domHandler),this.evWin&&ht(O(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&ct(this.element,this.evEl,this.domHandler),this.evTarget&&ct(this.target,this.evTarget,this.domHandler),this.evWin&&ct(O(this.element),this.evWin,this.domHandler)}};function bt(e){var n,a=e.options.inputClass;return a?n=a:re?n=vt:_e?n=pe:ye?n=Fe:n=R,new n(e,Ne)}function Ne(e,n,a){var d=a.pointers.length,h=a.changedPointers.length,T=n&X&&d-h===0,M=n&(F|V)&&d-h===0;a.isFirst=!!T,a.isFinal=!!M,T&&(e.session={}),a.eventType=n,yt(e,a),e.emit("hammer.input",a),e.recognize(a),e.session.prevInput=a}function yt(e,n){var a=e.session,d=n.pointers,h=d.length;a.firstInput||(a.firstInput=Kt(n)),h>1&&!a.firstMultiple?a.firstMultiple=Kt(n):h===1&&(a.firstMultiple=!1);var T=a.firstInput,M=a.firstMultiple,j=M?M.center:T.center,J=n.center=de(d);n.timeStamp=I(),n.deltaTime=n.timeStamp-T.timeStamp,n.angle=y(j,J),n.distance=b(j,J),qt(a,n),n.offsetDirection=o(n.deltaX,n.deltaY);var ut=p(n.deltaTime,n.deltaX,n.deltaY);n.overallVelocityX=ut.x,n.overallVelocityY=ut.y,n.overallVelocity=S(ut.x)>S(ut.y)?ut.x:ut.y,n.scale=M?P(M.pointers,d):1,n.rotation=M?f(M.pointers,d):0,n.maxPointers=a.prevInput?n.pointers.length>a.prevInput.maxPointers?n.pointers.length:a.prevInput.maxPointers:n.pointers.length,jt(a,n);var Pt=e.element;Tt(n.srcEvent.target,Pt)&&(Pt=n.srcEvent.target),n.target=Pt}function qt(e,n){var a=n.center,d=e.offsetDelta||{},h=e.prevDelta||{},T=e.prevInput||{};(n.eventType===X||T.eventType===F)&&(h=e.prevDelta={x:T.deltaX||0,y:T.deltaY||0},d=e.offsetDelta={x:a.x,y:a.y}),n.deltaX=h.x+(a.x-d.x),n.deltaY=h.y+(a.y-d.y)}function jt(e,n){var a=e.lastInterval||n,d=n.timeStamp-a.timeStamp,h,T,M,j;if(n.eventType!=V&&(d>Se||a.velocity===l)){var J=n.deltaX-a.deltaX,ut=n.deltaY-a.deltaY,Pt=p(d,J,ut);T=Pt.x,M=Pt.y,h=S(Pt.x)>S(Pt.y)?Pt.x:Pt.y,j=o(J,ut),e.lastInterval=n}else h=a.velocity,T=a.velocityX,M=a.velocityY,j=a.direction;n.velocity=h,n.velocityX=T,n.velocityY=M,n.direction=j}function Kt(e){for(var n=[],a=0;a<e.pointers.length;)n[a]={clientX:E(e.pointers[a].clientX),clientY:E(e.pointers[a].clientY)},a++;return{timeStamp:I(),pointers:n,center:de(n),deltaX:e.deltaX,deltaY:e.deltaY}}function de(e){var n=e.length;if(n===1)return{x:E(e[0].clientX),y:E(e[0].clientY)};for(var a=0,d=0,h=0;h<n;)a+=e[h].clientX,d+=e[h].clientY,h++;return{x:E(a/n),y:E(d/n)}}function p(e,n,a){return{x:n/e||0,y:a/e||0}}function o(e,n){return e===n?Wt:S(e)>=S(n)?e<0?Gt:it:n<0?Mt:Ht}function b(e,n,a){a||(a=ce);var d=n[a[0]]-e[a[0]],h=n[a[1]]-e[a[1]];return Math.sqrt(d*d+h*h)}function y(e,n,a){a||(a=ce);var d=n[a[0]]-e[a[0]],h=n[a[1]]-e[a[1]];return Math.atan2(h,d)*180/Math.PI}function f(e,n){return y(n[1],n[0],Qt)+y(e[1],e[0],Qt)}function P(e,n){return b(n[0],n[1],Qt)/b(e[0],e[1],Qt)}var L={mousedown:X,mousemove:dt,mouseup:F},$="mousedown",A="mousemove mouseup";function R(){this.evEl=$,this.evWin=A,this.pressed=!1,Y.apply(this,arguments)}Z(R,Y,{handler:function(n){var a=L[n.type];a&X&&n.button===0&&(this.pressed=!0),a&dt&&n.which!==1&&(a=F),this.pressed&&(a&F&&(this.pressed=!1),this.callback(this.manager,a,{pointers:[n],changedPointers:[n],pointerType:ue,srcEvent:n}))}});var W={pointerdown:X,pointermove:dt,pointerup:F,pointercancel:V,pointerout:V},q={2:Nt,3:le,4:ue,5:Ee},_t="pointerdown",Et="pointermove pointerup pointercancel";s.MSPointerEvent&&!s.PointerEvent&&(_t="MSPointerDown",Et="MSPointerMove MSPointerUp MSPointerCancel");function vt(){this.evEl=_t,this.evWin=Et,Y.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Z(vt,Y,{handler:function(n){var a=this.store,d=!1,h=n.type.toLowerCase().replace("ms",""),T=W[h],M=q[n.pointerType]||n.pointerType,j=M==Nt,J=wt(a,n.pointerId,"pointerId");T&X&&(n.button===0||j)?J<0&&(a.push(n),J=a.length-1):T&(F|V)&&(d=!0),!(J<0)&&(a[J]=n,this.callback(this.manager,T,{pointers:a,changedPointers:[n],pointerType:M,srcEvent:n}),d&&a.splice(J,1))}});var Ct={touchstart:X,touchmove:dt,touchend:F,touchcancel:V},xe="touchstart",_="touchstart touchmove touchend touchcancel";function k(){this.evTarget=xe,this.evWin=_,this.started=!1,Y.apply(this,arguments)}Z(k,Y,{handler:function(n){var a=Ct[n.type];if(a===X&&(this.started=!0),!!this.started){var d=Jt.call(this,n,a);a&(F|V)&&d[0].length-d[1].length===0&&(this.started=!1),this.callback(this.manager,a,{pointers:d[0],changedPointers:d[1],pointerType:Nt,srcEvent:n})}}});function Jt(e,n){var a=Xt(e.touches),d=Xt(e.changedTouches);return n&(F|V)&&(a=H(a.concat(d),"identifier")),[a,d]}var Le={touchstart:X,touchmove:dt,touchend:F,touchcancel:V},De="touchstart touchmove touchend touchcancel";function pe(){this.evTarget=De,this.targetIds={},Y.apply(this,arguments)}Z(pe,Y,{handler:function(n){var a=Le[n.type],d=ze.call(this,n,a);d&&this.callback(this.manager,a,{pointers:d[0],changedPointers:d[1],pointerType:Nt,srcEvent:n})}});function ze(e,n){var a=Xt(e.touches),d=this.targetIds;if(n&(X|dt)&&a.length===1)return d[a[0].identifier]=!0,[a,a];var h,T,M=Xt(e.changedTouches),j=[],J=this.target;if(T=a.filter(function(ut){return Tt(ut.target,J)}),n===X)for(h=0;h<T.length;)d[T[h].identifier]=!0,h++;for(h=0;h<M.length;)d[M[h].identifier]&&j.push(M[h]),n&(F|V)&&delete d[M[h].identifier],h++;if(j.length)return[H(T.concat(j),"identifier"),j]}var Ce=2500,an=25;function Fe(){Y.apply(this,arguments);var e=Vt(this.handler,this);this.touch=new pe(this.manager,e),this.mouse=new R(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}Z(Fe,Y,{handler:function(n,a,d){var h=d.pointerType==Nt,T=d.pointerType==ue;if(!(T&&d.sourceCapabilities&&d.sourceCapabilities.firesTouchEvents)){if(h)qn.call(this,a,d);else if(T&&jn.call(this,d))return;this.callback(n,a,d)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function qn(e,n){e&X?(this.primaryTouch=n.changedPointers[0].identifier,rn.call(this,n)):e&(F|V)&&rn.call(this,n)}function rn(e){var n=e.changedPointers[0];if(n.identifier===this.primaryTouch){var a={x:n.clientX,y:n.clientY};this.lastTouches.push(a);var d=this.lastTouches,h=function(){var T=d.indexOf(a);T>-1&&d.splice(T,1)};setTimeout(h,Ce)}}function jn(e){for(var n=e.srcEvent.clientX,a=e.srcEvent.clientY,d=0;d<this.lastTouches.length;d++){var h=this.lastTouches[d],T=Math.abs(n-h.x),M=Math.abs(a-h.y);if(T<=an&&M<=an)return!0}return!1}var ln=B(v.style,"touchAction"),un=ln!==l,cn="compute",dn="auto",Ue="manipulation",Bt="none",fe="pan-x",ve="pan-y",Ie=Jn();function Ve(e,n){this.manager=e,this.set(n)}Ve.prototype={set:function(e){e==cn&&(e=this.compute()),un&&this.manager.element.style&&Ie[e]&&(this.manager.element.style[ln]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return z(this.manager.recognizers,function(n){at(n.options.enable,[n])&&(e=e.concat(n.getTouchAction()))}),Kn(e.join(" "))},preventDefaults:function(e){var n=e.srcEvent,a=e.offsetDirection;if(this.manager.session.prevented){n.preventDefault();return}var d=this.actions,h=st(d,Bt)&&!Ie[Bt],T=st(d,ve)&&!Ie[ve],M=st(d,fe)&&!Ie[fe];if(h){var j=e.pointers.length===1,J=e.distance<2,ut=e.deltaTime<250;if(j&&J&&ut)return}if(!(M&&T)&&(h||T&&a&lt||M&&a&Ot))return this.preventSrc(n)},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};function Kn(e){if(st(e,Bt))return Bt;var n=st(e,fe),a=st(e,ve);return n&&a?Bt:n||a?n?fe:ve:st(e,Ue)?Ue:dn}function Jn(){if(!un)return!1;var e={},n=s.CSS&&s.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(a){e[a]=n?s.CSS.supports("touch-action",a):!0}),e}var Pe=1,gt=2,te=4,Lt=8,At=Lt,he=16,It=32;function Rt(e){this.options=et({},this.defaults,e||{}),this.id=ae(),this.manager=null,this.options.enable=nt(this.options.enable,!0),this.state=Pe,this.simultaneous={},this.requireFail=[]}Rt.prototype={defaults:{},set:function(e){return et(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(N(e,"recognizeWith",this))return this;var n=this.simultaneous;return e=Me(e,this),n[e.id]||(n[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return N(e,"dropRecognizeWith",this)?this:(e=Me(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(N(e,"requireFailure",this))return this;var n=this.requireFail;return e=Me(e,this),wt(n,e)===-1&&(n.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(N(e,"dropRequireFailure",this))return this;e=Me(e,this);var n=wt(this.requireFail,e);return n>-1&&this.requireFail.splice(n,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var n=this,a=this.state;function d(h){n.manager.emit(h,e)}a<Lt&&d(n.options.event+pn(a)),d(n.options.event),e.additionalEvent&&d(e.additionalEvent),a>=Lt&&d(n.options.event+pn(a))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=It},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(It|Pe)))return!1;e++}return!0},recognize:function(e){var n=et({},e);if(!at(this.options.enable,[this,n])){this.reset(),this.state=It;return}this.state&(At|he|It)&&(this.state=Pe),this.state=this.process(n),this.state&(gt|te|Lt|he)&&this.tryEmit(n)},process:function(e){},getTouchAction:function(){},reset:function(){}};function pn(e){return e&he?"cancel":e&Lt?"end":e&te?"move":e&gt?"start":""}function fn(e){return e==Ht?"down":e==Mt?"up":e==Gt?"left":e==it?"right":""}function Me(e,n){var a=n.manager;return a?a.get(e):e}function St(){Rt.apply(this,arguments)}Z(St,Rt,{defaults:{pointers:1},attrTest:function(e){var n=this.options.pointers;return n===0||e.pointers.length===n},process:function(e){var n=this.state,a=e.eventType,d=n&(gt|te),h=this.attrTest(e);return d&&(a&V||!h)?n|he:d||h?a&F?n|Lt:n&gt?n|te:gt:It}});function Oe(){St.apply(this,arguments),this.pX=null,this.pY=null}Z(Oe,St,{defaults:{event:"pan",threshold:10,pointers:1,direction:$t},getTouchAction:function(){var e=this.options.direction,n=[];return e&lt&&n.push(ve),e&Ot&&n.push(fe),n},directionTest:function(e){var n=this.options,a=!0,d=e.distance,h=e.direction,T=e.deltaX,M=e.deltaY;return h&n.direction||(n.direction&lt?(h=T===0?Wt:T<0?Gt:it,a=T!=this.pX,d=Math.abs(e.deltaX)):(h=M===0?Wt:M<0?Mt:Ht,a=M!=this.pY,d=Math.abs(e.deltaY))),e.direction=h,a&&d>n.threshold&&h&n.direction},attrTest:function(e){return St.prototype.attrTest.call(this,e)&&(this.state&gt||!(this.state&gt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var n=fn(e.direction);n&&(e.additionalEvent=this.options.event+n),this._super.emit.call(this,e)}});function Ge(){St.apply(this,arguments)}Z(Ge,St,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Bt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&gt)},emit:function(e){if(e.scale!==1){var n=e.scale<1?"in":"out";e.additionalEvent=this.options.event+n}this._super.emit.call(this,e)}});function He(){Rt.apply(this,arguments),this._timer=null,this._input=null}Z(He,Rt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[dn]},process:function(e){var n=this.options,a=e.pointers.length===n.pointers,d=e.distance<n.threshold,h=e.deltaTime>n.time;if(this._input=e,!d||!a||e.eventType&(F|V)&&!h)this.reset();else if(e.eventType&X)this.reset(),this._timer=D(function(){this.state=At,this.tryEmit()},n.time,this);else if(e.eventType&F)return At;return It},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===At&&(e&&e.eventType&F?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=I(),this.manager.emit(this.options.event,this._input)))}});function Qe(){St.apply(this,arguments)}Z(Qe,St,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Bt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&gt)}});function Be(){St.apply(this,arguments)}Z(Be,St,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:lt|Ot,pointers:1},getTouchAction:function(){return Oe.prototype.getTouchAction.call(this)},attrTest:function(e){var n=this.options.direction,a;return n&(lt|Ot)?a=e.overallVelocity:n&lt?a=e.overallVelocityX:n&Ot&&(a=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&S(a)>this.options.velocity&&e.eventType&F},emit:function(e){var n=fn(e.offsetDirection);n&&this.manager.emit(this.options.event+n,e),this.manager.emit(this.options.event,e)}});function Ae(){Rt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Z(Ae,Rt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ue]},process:function(e){var n=this.options,a=e.pointers.length===n.pointers,d=e.distance<n.threshold,h=e.deltaTime<n.time;if(this.reset(),e.eventType&X&&this.count===0)return this.failTimeout();if(d&&h&&a){if(e.eventType!=F)return this.failTimeout();var T=this.pTime?e.timeStamp-this.pTime<n.interval:!0,M=!this.pCenter||b(this.pCenter,e.center)<n.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,!M||!T?this.count=1:this.count+=1,this._input=e;var j=this.count%n.taps;if(j===0)return this.hasRequireFailures()?(this._timer=D(function(){this.state=At,this.tryEmit()},n.interval,this),gt):At}return It},failTimeout:function(){return this._timer=D(function(){this.state=It},this.options.interval,this),It},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==At&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Dt(e,n){return n=n||{},n.recognizers=nt(n.recognizers,Dt.defaults.preset),new Ye(e,n)}Dt.VERSION="2.0.7",Dt.defaults={domEvents:!1,touchAction:cn,enable:!0,inputTarget:null,inputClass:null,preset:[[Qe,{enable:!1}],[Ge,{enable:!1},["rotate"]],[Be,{direction:lt}],[Oe,{direction:lt},["swipe"]],[Ae],[Ae,{event:"doubletap",taps:2},["tap"]],[He]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var ts=1,vn=2;function Ye(e,n){this.options=et({},Dt.defaults,n||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=bt(this),this.touchAction=new Ve(this,this.options.touchAction),hn(this,!0),z(this.options.recognizers,function(a){var d=this.add(new a[0](a[1]));a[2]&&d.recognizeWith(a[2]),a[3]&&d.requireFailure(a[3])},this)}Ye.prototype={set:function(e){return et(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?vn:ts},recognize:function(e){var n=this.session;if(!n.stopped){this.touchAction.preventDefaults(e);var a,d=this.recognizers,h=n.curRecognizer;(!h||h&&h.state&At)&&(h=n.curRecognizer=null);for(var T=0;T<d.length;)a=d[T],n.stopped!==vn&&(!h||a==h||a.canRecognizeWith(h))?a.recognize(e):a.reset(),!h&&a.state&(gt|te|Lt)&&(h=n.curRecognizer=a),T++}},get:function(e){if(e instanceof Rt)return e;for(var n=this.recognizers,a=0;a<n.length;a++)if(n[a].options.event==e)return n[a];return null},add:function(e){if(N(e,"add",this))return this;var n=this.get(e.options.event);return n&&this.remove(n),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(N(e,"remove",this))return this;if(e=this.get(e),e){var n=this.recognizers,a=wt(n,e);a!==-1&&(n.splice(a,1),this.touchAction.update())}return this},on:function(e,n){if(e!==l&&n!==l){var a=this.handlers;return z(Zt(e),function(d){a[d]=a[d]||[],a[d].push(n)}),this}},off:function(e,n){if(e!==l){var a=this.handlers;return z(Zt(e),function(d){n?a[d]&&a[d].splice(wt(a[d],n),1):delete a[d]}),this}},emit:function(e,n){this.options.domEvents&&es(e,n);var a=this.handlers[e]&&this.handlers[e].slice();if(!(!a||!a.length)){n.type=e,n.preventDefault=function(){n.srcEvent.preventDefault()};for(var d=0;d<a.length;)a[d](n),d++}},destroy:function(){this.element&&hn(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function hn(e,n){var a=e.element;if(a.style){var d;z(e.options.cssProps,function(h,T){d=B(a.style,T),n?(e.oldCssProps[d]=a.style[d],a.style[d]=h):a.style[d]=e.oldCssProps[d]||""}),n||(e.oldCssProps={})}}function es(e,n){var a=i.createEvent("Event");a.initEvent(e,!0,!0),a.gesture=n,n.target.dispatchEvent(a)}et(Dt,{INPUT_START:X,INPUT_MOVE:dt,INPUT_END:F,INPUT_CANCEL:V,STATE_POSSIBLE:Pe,STATE_BEGAN:gt,STATE_CHANGED:te,STATE_ENDED:Lt,STATE_RECOGNIZED:At,STATE_CANCELLED:he,STATE_FAILED:It,DIRECTION_NONE:Wt,DIRECTION_LEFT:Gt,DIRECTION_RIGHT:it,DIRECTION_UP:Mt,DIRECTION_DOWN:Ht,DIRECTION_HORIZONTAL:lt,DIRECTION_VERTICAL:Ot,DIRECTION_ALL:$t,Manager:Ye,Input:Y,TouchAction:Ve,TouchInput:pe,MouseInput:R,PointerEventInput:vt,TouchMouseInput:Fe,SingleTouchInput:k,Recognizer:Rt,AttrRecognizer:St,Tap:Ae,Pan:Oe,Swipe:Be,Pinch:Ge,Rotate:Qe,Press:He,on:ht,off:ct,each:z,merge:oe,extend:Ut,assign:et,inherit:Z,bindFn:Vt,prefixed:B});var ns=typeof s<"u"?s:typeof self<"u"?self:{};ns.Hammer=Dt,t.exports?t.exports=Dt:s[u]=Dt})(window,document,"Hammer")})(Xe)),Xe.exports}var As=Os();const ge=Ms(As);const be=t=>t&&t.enabled&&t.modifierKey,zn=(t,s)=>t&&s[t+"Key"],sn=(t,s)=>t&&!s[t+"Key"];function zt(t,s,i){return t===void 0?!0:typeof t=="string"?t.indexOf(s)!==-1:typeof t=="function"?t({chart:i}).indexOf(s)!==-1:!1}function We(t,s){return typeof t=="function"&&(t=t({chart:s})),typeof t=="string"?{x:t.indexOf("x")!==-1,y:t.indexOf("y")!==-1}:{x:!1,y:!1}}function Rs(t,s){let i;return function(){return clearTimeout(i),i=setTimeout(t,s),s}}function ks({x:t,y:s},i){const u=i.scales,l=Object.keys(u);for(let c=0;c<l.length;c++){const v=u[l[c]];if(s>=v.top&&s<=v.bottom&&t>=v.left&&t<=v.right)return v}return null}function Fn(t,s,i){const{mode:u="xy",scaleMode:l,overScaleMode:c}=t||{},v=ks(s,i),m=We(u,i),E=We(l,i);if(c){const I=We(c,i);for(const D of["x","y"])I[D]&&(E[D]=m[D],m[D]=!1)}if(v&&E[v.axis])return[v];const S=[];return Ft(i.scales,function(I){m[I.axis]&&S.push(I)}),S}const qe=new WeakMap;function G(t){let s=qe.get(t);return s||(s={originalScaleLimits:{},updatedScaleLimits:{},handlers:{},panDelta:{},dragging:!1,panning:!1},qe.set(t,s)),s}function ws(t){qe.delete(t)}function Un(t,s,i,u){const l=Math.max(0,Math.min(1,(t-s)/i||0)),c=1-l;return{min:u*l,max:u*c}}function Vn(t,s){const i=t.isHorizontal()?s.x:s.y;return t.getValueForPixel(i)}function Gn(t,s,i){const u=t.max-t.min,l=u*(s-1),c=Vn(t,i);return Un(c,t.min,u,l)}function Ns(t,s,i){const u=Vn(t,i);if(u===void 0)return{min:t.min,max:t.max};const l=Math.log10(t.min),c=Math.log10(t.max),v=Math.log10(u),m=c-l,E=m*(s-1),S=Un(v,l,m,E);return{min:Math.pow(10,l+S.min),max:Math.pow(10,c-S.max)}}function Ls(t,s){return s&&(s[t.id]||s[t.axis])||{}}function En(t,s,i,u,l){let c=i[u];if(c==="original"){const v=t.originalScaleLimits[s.id][u];c=we(v.options,v.scale)}return we(c,l)}function Ds(t,s,i){const u=t.getValueForPixel(s),l=t.getValueForPixel(i);return{min:Math.min(u,l),max:Math.max(u,l)}}function zs(t,{min:s,max:i,minLimit:u,maxLimit:l},c){const v=(t-i+s)/2;s-=v,i+=v;const m=c.min.options??c.min.scale,E=c.max.options??c.max.scale,S=t/1e6;return bn(s,m,S)&&(s=m),bn(i,E,S)&&(i=E),s<u?(s=u,i=Math.min(u+t,l)):i>l&&(i=l,s=Math.max(l-t,u)),{min:s,max:i}}function Yt(t,{min:s,max:i},u,l=!1){const c=G(t.chart),{options:v}=t,m=Ls(t,u),{minRange:E=0}=m,S=En(c,t,m,"min",-1/0),I=En(c,t,m,"max",1/0);if(l==="pan"&&(s<S||i>I))return!0;const D=t.max-t.min,N=l?Math.max(i-s,E):D;if(l&&N===E&&D<=E)return!0;const z=zs(N,{min:s,max:i,minLimit:S,maxLimit:I},c.originalScaleLimits[t.id]);return v.min=z.min,v.max=z.max,c.updatedScaleLimits[t.id]=z,t.parse(z.min)!==t.min||t.parse(z.max)!==t.max}function Fs(t,s,i,u){const l=Gn(t,s,i),c={min:t.min+l.min,max:t.max-l.max};return Yt(t,c,u,!0)}function Us(t,s,i,u){const l=Ns(t,s,i);return Yt(t,l,u,!0)}function Vs(t,s,i,u){Yt(t,Ds(t,s,i),u,!0)}const Sn=t=>t===0||isNaN(t)?0:t<0?Math.min(Math.round(t),-1):Math.max(Math.round(t),1);function Gs(t){const i=t.getLabels().length-1;t.min>0&&(t.min-=1),t.max<i&&(t.max+=1)}function Hs(t,s,i,u){const l=Gn(t,s,i);t.min===t.max&&s<1&&Gs(t);const c={min:t.min+Sn(l.min),max:t.max-Sn(l.max)};return Yt(t,c,u,!0)}function Qs(t){return t.isHorizontal()?t.width:t.height}function Bs(t,s,i){const l=t.getLabels().length-1;let{min:c,max:v}=t;const m=Math.max(v-c,1),E=Math.round(Qs(t)/Math.max(m,10)),S=Math.round(Math.abs(s/E));let I;return s<-E?(v=Math.min(v+S,l),c=m===1?v:v-m,I=v===l):s>E&&(c=Math.max(0,c-S),v=m===1?c:c+m,I=c===0),Yt(t,{min:c,max:v},i)||I}const Ys={second:500,minute:30*1e3,hour:1800*1e3,day:720*60*1e3,week:3.5*24*60*60*1e3,month:360*60*60*1e3,quarter:1440*60*60*1e3,year:4368*60*60*1e3};function Hn(t,s,i,u=!1){const{min:l,max:c,options:v}=t,m=v.time&&v.time.round,E=Ys[m]||0,S=t.getValueForPixel(t.getPixelForValue(l+E)-s),I=t.getValueForPixel(t.getPixelForValue(c+E)-s);return isNaN(S)||isNaN(I)?!0:Yt(t,{min:S,max:I},i,u?"pan":!1)}function xn(t,s,i){return Hn(t,s,i,!0)}const je={category:Hs,default:Fs,logarithmic:Us},Ke={default:Vs},Je={category:Bs,default:Hn,logarithmic:xn,timeseries:xn};function Zs(t,s,i){const{id:u,options:{min:l,max:c}}=t;if(!s[u]||!i[u])return!0;const v=i[u];return v.min!==l||v.max!==c}function Cn(t,s){Ft(t,(i,u)=>{s[u]||delete t[u]})}function ie(t,s){const{scales:i}=t,{originalScaleLimits:u,updatedScaleLimits:l}=s;return Ft(i,function(c){Zs(c,u,l)&&(u[c.id]={min:{scale:c.min,options:c.options.min},max:{scale:c.max,options:c.options.max}})}),Cn(u,i),Cn(l,i),u}function In(t,s,i,u){const l=je[t.type]||je.default;Q(l,[t,s,i,u])}function Pn(t,s,i,u){const l=Ke[t.type]||Ke.default;Q(l,[t,s,i,u])}function Xs(t){const s=t.chartArea;return{x:(s.left+s.right)/2,y:(s.top+s.bottom)/2}}function on(t,s,i="none",u="api"){const{x:l=1,y:c=1,focalPoint:v=Xs(t)}=typeof s=="number"?{x:s,y:s}:s,m=G(t),{options:{limits:E,zoom:S}}=m;ie(t,m);const I=l!==1,D=c!==1,N=Fn(S,v,t);Ft(N||t.scales,function(z){z.isHorizontal()&&I?In(z,l,v,E):!z.isHorizontal()&&D&&In(z,c,v,E)}),t.update(i),Q(S.onZoom,[{chart:t,trigger:u}])}function Qn(t,s,i,u="none",l="api"){const c=G(t),{options:{limits:v,zoom:m}}=c,{mode:E="xy"}=m;ie(t,c);const S=zt(E,"x",t),I=zt(E,"y",t);Ft(t.scales,function(D){D.isHorizontal()&&S?Pn(D,s.x,i.x,v):!D.isHorizontal()&&I&&Pn(D,s.y,i.y,v)}),t.update(u),Q(m.onZoom,[{chart:t,trigger:l}])}function Ws(t,s,i,u="none",l="api"){const c=G(t);ie(t,c);const v=t.scales[s];Yt(v,i,void 0,!0),t.update(u),Q(c.options.zoom?.onZoom,[{chart:t,trigger:l}])}function $s(t,s="default"){const i=G(t),u=ie(t,i);Ft(t.scales,function(l){const c=l.options;u[l.id]?(c.min=u[l.id].min.options,c.max=u[l.id].max.options):(delete c.min,delete c.max),delete i.updatedScaleLimits[l.id]}),t.update(s),Q(i.options.zoom.onZoomComplete,[{chart:t}])}function qs(t,s){const i=t.originalScaleLimits[s];if(!i)return;const{min:u,max:l}=i;return we(l.options,l.scale)-we(u.options,u.scale)}function js(t){const s=G(t);let i=1,u=1;return Ft(t.scales,function(l){const c=qs(s,l.id);if(c){const v=Math.round(c/(l.max-l.min)*100)/100;i=Math.min(i,v),u=Math.max(u,v)}}),i<1?i:u}function Mn(t,s,i,u){const{panDelta:l}=u,c=l[t.id]||0;yn(c)===yn(s)&&(s+=c);const v=Je[t.type]||Je.default;Q(v,[t,s,i])?l[t.id]=0:l[t.id]=s}function Bn(t,s,i,u="none"){const{x:l=0,y:c=0}=typeof s=="number"?{x:s,y:s}:s,v=G(t),{options:{pan:m,limits:E}}=v,{onPan:S}=m||{};ie(t,v);const I=l!==0,D=c!==0;Ft(i||t.scales,function(N){N.isHorizontal()&&I?Mn(N,l,E,v):!N.isHorizontal()&&D&&Mn(N,c,E,v)}),t.update(u),Q(S,[{chart:t}])}function Yn(t){const s=G(t);ie(t,s);const i={};for(const u of Object.keys(t.scales)){const{min:l,max:c}=s.originalScaleLimits[u]||{min:{},max:{}};i[u]={min:l.scale,max:c.scale}}return i}function Ks(t){const s=G(t),i={};for(const u of Object.keys(t.scales))i[u]=s.updatedScaleLimits[u];return i}function Js(t){const s=Yn(t);for(const i of Object.keys(t.scales)){const{min:u,max:l}=s[i];if(u!==void 0&&t.scales[i].min!==u||l!==void 0&&t.scales[i].max!==l)return!0}return!1}function On(t){const s=G(t);return s.panning||s.dragging}const An=(t,s,i)=>Math.min(i,Math.max(s,t));function ft(t,s){const{handlers:i}=G(t),u=i[s];u&&u.target&&(u.target.removeEventListener(s,u),delete i[s])}function Te(t,s,i,u){const{handlers:l,options:c}=G(t),v=l[i];if(v&&v.target===s)return;ft(t,i),l[i]=E=>u(t,E,c),l[i].target=s;const m=i==="wheel"?!1:void 0;s.addEventListener(i,l[i],{passive:m})}function ti(t,s){const i=G(t);i.dragStart&&(i.dragging=!0,i.dragEnd=s,t.update("none"))}function ei(t,s){const i=G(t);!i.dragStart||s.key!=="Escape"||(ft(t,"keydown"),i.dragging=!1,i.dragStart=i.dragEnd=null,t.update("none"))}function tn(t,s){if(t.target!==s.canvas){const i=s.canvas.getBoundingClientRect();return{x:t.clientX-i.left,y:t.clientY-i.top}}return nn(t,s)}function Zn(t,s,i){const{onZoomStart:u,onZoomRejected:l}=i;if(u){const c=tn(s,t);if(Q(u,[{chart:t,event:s,point:c}])===!1)return Q(l,[{chart:t,event:s}]),!1}}function ni(t,s){if(t.legend){const c=nn(s,t);if(fs(c,t.legend))return}const i=G(t),{pan:u,zoom:l={}}=i.options;if(s.button!==0||zn(be(u),s)||sn(be(l.drag),s))return Q(l.onZoomRejected,[{chart:t,event:s}]);Zn(t,s,l)!==!1&&(i.dragStart=s,Te(t,t.canvas.ownerDocument,"mousemove",ti),Te(t,window.document,"keydown",ei))}function si({begin:t,end:s},i){let u=s.x-t.x,l=s.y-t.y;const c=Math.abs(u/l);c>i?u=Math.sign(u)*Math.abs(l*i):c<i&&(l=Math.sign(l)*Math.abs(u/i)),s.x=t.x+u,s.y=t.y+l}function Rn(t,s,i,{min:u,max:l,prop:c}){t[u]=An(Math.min(i.begin[c],i.end[c]),s[u],s[l]),t[l]=An(Math.max(i.begin[c],i.end[c]),s[u],s[l])}function ii(t,s,i){const u={begin:tn(s.dragStart,t),end:tn(s.dragEnd,t)};if(i){const l=t.chartArea.width/t.chartArea.height;si(u,l)}return u}function Xn(t,s,i,u){const l=zt(s,"x",t),c=zt(s,"y",t),{top:v,left:m,right:E,bottom:S,width:I,height:D}=t.chartArea,N={top:v,left:m,right:E,bottom:S},z=ii(t,i,u&&l&&c);l&&Rn(N,t.chartArea,z,{min:"left",max:"right",prop:"x"}),c&&Rn(N,t.chartArea,z,{min:"top",max:"bottom",prop:"y"});const kt=N.right-N.left,et=N.bottom-N.top;return{...N,width:kt,height:et,zoomX:l&&kt?1+(I-kt)/I:1,zoomY:c&&et?1+(D-et)/D:1}}function oi(t,s){const i=G(t);if(!i.dragStart)return;ft(t,"mousemove");const{mode:u,onZoomComplete:l,drag:{threshold:c=0,maintainAspectRatio:v}}=i.options.zoom,m=Xn(t,u,{dragStart:i.dragStart,dragEnd:s},v),E=zt(u,"x",t)?m.width:0,S=zt(u,"y",t)?m.height:0,I=Math.sqrt(E*E+S*S);if(i.dragStart=i.dragEnd=null,I<=c){i.dragging=!1,t.update("none");return}Qn(t,{x:m.left,y:m.top},{x:m.right,y:m.bottom},"zoom","drag"),i.dragging=!1,i.filterNextClick=!0,Q(l,[{chart:t}])}function ai(t,s,i){if(sn(be(i.wheel),s)){Q(i.onZoomRejected,[{chart:t,event:s}]);return}if(Zn(t,s,i)!==!1&&(s.cancelable&&s.preventDefault(),s.deltaY!==void 0))return!0}function ri(t,s){const{handlers:{onZoomComplete:i},options:{zoom:u}}=G(t);if(!ai(t,s,u))return;const l=s.target.getBoundingClientRect(),c=u.wheel.speed,v=s.deltaY>=0?2-1/(1-c):1+c,m={x:v,y:v,focalPoint:{x:s.clientX-l.left,y:s.clientY-l.top}};on(t,m,"zoom","wheel"),Q(i,[{chart:t}])}function li(t,s,i,u){i&&(G(t).handlers[s]=Rs(()=>Q(i,[{chart:t}]),u))}function ui(t,s){const i=t.canvas,{wheel:u,drag:l,onZoomComplete:c}=s.zoom;u.enabled?(Te(t,i,"wheel",ri),li(t,"onZoomComplete",c,250)):ft(t,"wheel"),l.enabled?(Te(t,i,"mousedown",ni),Te(t,i.ownerDocument,"mouseup",oi)):(ft(t,"mousedown"),ft(t,"mousemove"),ft(t,"mouseup"),ft(t,"keydown"))}function ci(t){ft(t,"mousedown"),ft(t,"mousemove"),ft(t,"mouseup"),ft(t,"wheel"),ft(t,"click"),ft(t,"keydown")}function di(t,s){return function(i,u){const{pan:l,zoom:c={}}=s.options;if(!l||!l.enabled)return!1;const v=u&&u.srcEvent;return v&&!s.panning&&u.pointerType==="mouse"&&(sn(be(l),v)||zn(be(c.drag),v))?(Q(l.onPanRejected,[{chart:t,event:u}]),!1):!0}}function pi(t,s){const i=Math.abs(t.clientX-s.clientX),u=Math.abs(t.clientY-s.clientY),l=i/u;let c,v;return l>.3&&l<1.7?c=v=!0:i>u?c=!0:v=!0,{x:c,y:v}}function Wn(t,s,i){if(s.scale){const{center:u,pointers:l}=i,c=1/s.scale*i.scale,v=i.target.getBoundingClientRect(),m=pi(l[0],l[1]),E=s.options.zoom.mode,S={x:m.x&&zt(E,"x",t)?c:1,y:m.y&&zt(E,"y",t)?c:1,focalPoint:{x:u.x-v.left,y:u.y-v.top}};on(t,S,"zoom","pinch"),s.scale=i.scale}}function fi(t,s,i){if(s.options.zoom.pinch.enabled){const u=nn(i,t);Q(s.options.zoom.onZoomStart,[{chart:t,event:i,point:u}])===!1?(s.scale=null,Q(s.options.zoom.onZoomRejected,[{chart:t,event:i}])):s.scale=1}}function vi(t,s,i){s.scale&&(Wn(t,s,i),s.scale=null,Q(s.options.zoom.onZoomComplete,[{chart:t}]))}function $n(t,s,i){const u=s.delta;u&&(s.panning=!0,Bn(t,{x:i.deltaX-u.x,y:i.deltaY-u.y},s.panScales),s.delta={x:i.deltaX,y:i.deltaY})}function hi(t,s,i){const{enabled:u,onPanStart:l,onPanRejected:c}=s.options.pan;if(!u)return;const v=i.target.getBoundingClientRect(),m={x:i.center.x-v.left,y:i.center.y-v.top};if(Q(l,[{chart:t,event:i,point:m}])===!1)return Q(c,[{chart:t,event:i}]);s.panScales=Fn(s.options.pan,m,t),s.delta={x:0,y:0},$n(t,s,i)}function mi(t,s){s.delta=null,s.panning&&(s.panning=!1,s.filterNextClick=!0,Q(s.options.pan.onPanComplete,[{chart:t}]))}const en=new WeakMap;function kn(t,s){const i=G(t),u=t.canvas,{pan:l,zoom:c}=s,v=new ge.Manager(u);c&&c.pinch.enabled&&(v.add(new ge.Pinch),v.on("pinchstart",m=>fi(t,i,m)),v.on("pinch",m=>Wn(t,i,m)),v.on("pinchend",m=>vi(t,i,m))),l&&l.enabled&&(v.add(new ge.Pan({threshold:l.threshold,enable:di(t,i)})),v.on("panstart",m=>hi(t,i,m)),v.on("panmove",m=>$n(t,i,m)),v.on("panend",()=>mi(t,i))),en.set(t,v)}function wn(t){const s=en.get(t);s&&(s.remove("pinchstart"),s.remove("pinch"),s.remove("pinchend"),s.remove("panstart"),s.remove("pan"),s.remove("panend"),s.destroy(),en.delete(t))}function gi(t,s){const{pan:i,zoom:u}=t,{pan:l,zoom:c}=s;return u?.zoom?.pinch?.enabled!==c?.zoom?.pinch?.enabled||i?.enabled!==l?.enabled||i?.threshold!==l?.threshold}var Ti="2.2.0";function ke(t,s,i){const u=i.zoom.drag,{dragStart:l,dragEnd:c}=G(t);if(u.drawTime!==s||!c)return;const{left:v,top:m,width:E,height:S}=Xn(t,i.zoom.mode,{dragStart:l,dragEnd:c},u.maintainAspectRatio),I=t.ctx;I.save(),I.beginPath(),I.fillStyle=u.backgroundColor||"rgba(225,225,225,0.3)",I.fillRect(v,m,E,S),u.borderWidth>0&&(I.lineWidth=u.borderWidth,I.strokeStyle=u.borderColor||"rgba(225,225,225)",I.strokeRect(v,m,E,S)),I.restore()}var bi={id:"zoom",version:Ti,defaults:{pan:{enabled:!1,mode:"xy",threshold:10,modifierKey:null},zoom:{wheel:{enabled:!1,speed:.1,modifierKey:null},drag:{enabled:!1,drawTime:"beforeDatasetsDraw",modifierKey:null},pinch:{enabled:!1},mode:"xy"}},start:function(t,s,i){const u=G(t);u.options=i,Object.prototype.hasOwnProperty.call(i.zoom,"enabled")&&console.warn("The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`."),(Object.prototype.hasOwnProperty.call(i.zoom,"overScaleMode")||Object.prototype.hasOwnProperty.call(i.pan,"overScaleMode"))&&console.warn("The option `overScaleMode` is deprecated. Please use `scaleMode` instead (and update `mode` as desired)."),ge&&kn(t,i),t.pan=(l,c,v)=>Bn(t,l,c,v),t.zoom=(l,c)=>on(t,l,c),t.zoomRect=(l,c,v)=>Qn(t,l,c,v),t.zoomScale=(l,c,v)=>Ws(t,l,c,v),t.resetZoom=l=>$s(t,l),t.getZoomLevel=()=>js(t),t.getInitialScaleBounds=()=>Yn(t),t.getZoomedScaleBounds=()=>Ks(t),t.isZoomedOrPanned=()=>Js(t),t.isZoomingOrPanning=()=>On(t)},beforeEvent(t,{event:s}){if(On(t))return!1;if(s.type==="click"||s.type==="mouseup"){const i=G(t);if(i.filterNextClick)return i.filterNextClick=!1,!1}},beforeUpdate:function(t,s,i){const u=G(t),l=u.options;u.options=i,gi(l,i)&&(wn(t),kn(t,i)),ui(t,i)},beforeDatasetsDraw(t,s,i){ke(t,"beforeDatasetsDraw",i)},afterDatasetsDraw(t,s,i){ke(t,"afterDatasetsDraw",i)},beforeDraw(t,s,i){ke(t,"beforeDraw",i)},afterDraw(t,s,i){ke(t,"afterDraw",i)},stop:function(t){ci(t),ge&&wn(t),ws(t)},panFunctions:Je,zoomFunctions:je,zoomRectFunctions:Ke};const yi={class:"nav-bar"},_i={key:0,class:"loading-state"},Ei={key:1,class:"error-state"},Si={class:"error-text"},xi={class:"session-header"},Ci={class:"header-row"},Ii={class:"track-name"},Pi={class:"header-meta"},Mi={class:"car"},Oi={class:"master-detail"},Ai={class:"master"},Ri={class:"master-title"},ki={key:0,class:"sh-checkbox"},wi={key:0,class:"single-stint-note"},Ni={class:"stint-list"},Li=["onClick"],Di={key:0,class:"stint-checkbox"},zi={key:0,class:"checkbox-checked"},Fi={key:1,class:"checkbox-empty"},Ui=["title"],Vi={class:"stint-num"},Gi={class:"stint-laps"},Hi={class:"delta-val"},Qi={class:"delta-lbl"},Bi={class:"detail"},Yi={key:0,class:"compare-header"},Zi={class:"compare-info"},Xi={class:"compare-a"},Wi={class:"compare-b"},$i={key:1,class:"detail-header"},qi={class:"detail-title"},ji={key:0,class:"best-tag"},Ki={key:2,class:"limited-data"},Ji={class:"times-comparison"},to={class:"tc-conditions"},eo={class:"tc-cond-item"},no={class:"tc-cond-val"},so={class:"tc-cond-item"},io={class:"tc-cond-val"},oo={class:"tc-main"},ao={class:"tc-column tc-actual"},ro={class:"tc-header"},lo={class:"tc-row"},uo={class:"tc-label"},co={class:"tc-value"},po={class:"tc-row"},fo={class:"tc-label"},vo={class:"tc-value"},ho={class:"tc-column tc-theo"},mo={class:"tc-header"},go={key:0,class:"tc-row"},To={class:"tc-value"},bo={class:"tc-row"},yo={class:"tc-value"},_o={class:"tc-row"},Eo={class:"tc-value"},So={class:"tc-column tc-deltas"},xo={class:"tc-header"},Co={class:"tc-row"},Io={class:"tc-row"},Po={class:"tc-duration"},Mo={class:"tc-duration-value"},Oo={key:0,class:"tc-consistency"},Ao={class:"tc-cons-title"},Ro={class:"tc-cons-simple"},ko={class:"tc-cons-count"},wo={class:"tc-cons-bar-wide"},No={class:"tc-target-time"},Lo={class:"tc-target-value"},Do={class:"tc-toggles-row"},zo={class:"tc-toggle",title:"Mostra target zone sul grafico"},Fo={key:0,class:"tc-toggle",title:"Mostra zone grip sul grafico"},Uo={key:1,class:"tc-validity"},Vo={class:"tc-cons-simple"},Go={class:"tc-cons-count"},Ho={class:"tc-cons-bar-wide"},Qo={key:0,class:"tc-invalid-badge"},Bo={class:"chart-section"},Yo={class:"chart-header-row"},Zo={class:"chart-title"},Xo={class:"chart-toolbar"},Wo={key:0,class:"lap-manager"},$o={class:"lap-manager-header"},qo=["disabled"],jo={class:"lap-manager-grid"},Ko=["onClick","title"],Jo={key:0,class:"lap-manager-info"},ta={class:"chart-wrap"},ea={key:1,class:"grip-legend"},na={class:"grip-legend-label"},sa={class:"grip-legend-laps"},ia={class:"laps-section"},oa={class:"laps-header-row"},aa={key:0,class:"laps-tabs"},ra={key:1,class:"laps-title"},la={class:"laps-table-wrap"},ua={class:"laps-table"},ca={class:"time"},da={class:"status"},$e=.6,pa=Nn({__name:"SessionDetailPage",props:{sessionId:{}},emits:["back","go-to-track"],setup(t,{emit:s}){vs.register(hs,ms,gs,Ts,bs,ys,_s,Es,bi);const i=t,u=s,l=tt(!1),c=tt(new Set),v=tt(!1),m=tt(null);function E(p){const o=new Set(c.value);o.has(p)?o.delete(p):o.add(p),c.value=o}function S(){c.value=new Set}function I(){m.value?.chart&&m.value.chart.resetZoom()}function D(){m.value?.chart&&m.value.chart.zoom(1.2)}function N(){m.value?.chart&&m.value.chart.zoom(.8)}const{fetchSessionFull:z,loadSessions:kt,getTheoreticalTimes:et}=as(),Ut=tt(null),oe=tt(!0),Z=tt(null),Vt=xs();Ln(async()=>{oe.value=!0,Z.value=null;try{await kt(Vt.value||void 0);const p=await z(i.sessionId,Vt.value||void 0);p?(Ut.value=p,console.log("[SESSION_DETAIL] Loaded session:",p.session_info.track,p.stints.length,"stints")):Z.value="Sessione non trovata"}catch(p){Z.value=p.message||"Errore caricamento"}finally{oe.value=!1}});const at=tt(!1),nt=tt([]),ht=tt("A"),ct=U(()=>at.value&&nt.value.length===2),Tt=U(()=>nt.value[0]??mt.value),st=U(()=>nt.value[1]??null);function Zt(p){at.value?wt(p):mt.value=p}function wt(p){const o=nt.value.indexOf(p);o>=0?nt.value.splice(o,1):nt.value.length<2&&nt.value.push(p)}function Xt(){nt.value=[],at.value=!1,ht.value="A"}const H=U(()=>{if(!Ut.value)return{id:i.sessionId,track:"Caricamento...",trackId:"",type:"practice",date:"-",time:"-",car:"-",startConditions:{weather:"-",airTemp:0,trackTemp:0},bestQualy:"--:--.---",bestRace:"--:--.---",theoQualy:"--:--.---",theoRace:"--:--.---",bestDeltaQ:{value:"-",stintNum:0},bestDeltaR:{value:"-",stintNum:0},stints:[],lapsData:{}};const p=Ut.value,o=p.session_info,b=p.stints.map(A=>{const R=A.laps.filter(Ct=>Ct.is_valid&&!Ct.has_pit_stop),W=R.length,q=W>0?Math.min(...R.map(Ct=>Ct.lap_time_ms)):null,_t=5,Et=W>=_t&&A.avg_clean_lap?A.avg_clean_lap:null,vt=Et?xt(Et):W>0&&W<_t?"⚠️ min 5 giri validi":"--:--.---";return{number:A.stint_number,type:A.type==="Qualify"?"Q":"R",intent:A.type==="Qualify"?"Qualy Push":"Race Pace",fuelStart:A.fuel_start,laps:A.laps.length,validLapsCount:W,best:q?xt(q):"--:--.---",avg:vt,avgMs:Et,durationMs:A.stint_drive_time_ms||0,theoretical:xt(o.session_best_lap),deltaVsTheo:q?`+${((q-o.session_best_lap)/1e3).toFixed(3)}`:"-",conditions:{weather:o.start_weather,avgAirTemp:o.start_air_temp,avgTrackTemp:o.start_road_temp},breakdown:{base:"-",deltaTemp:"-",deltaGrip:"-"}}}),y={};p.stints.forEach(A=>{y[A.stint_number]=A.laps.map(R=>({lap:R.lap_number,time:xt(R.lap_time_ms),delta:`+${((R.lap_time_ms-o.session_best_lap)/1e3).toFixed(3)}`,valid:R.is_valid,pit:R.has_pit_stop,sectors:R.sector_times_ms?.map(W=>(W/1e3).toFixed(1))||["-","-","-"],fuel:Math.round(R.fuel_remaining),airTemp:R.air_temp||0,weather:R.rain_intensity||"No Rain",grip:R.track_grip_status||"Opt"}))});let f=null,P=null,L=0,$=0;return p.stints.forEach(A=>{const R=A.laps.filter(q=>q.is_valid&&!q.has_pit_stop);if(R.length===0)return;const W=Math.min(...R.map(q=>q.lap_time_ms));A.type==="Qualify"?(!f||W<f)&&(f=W,L=A.stint_number):(!P||W<P)&&(P=W,$=A.stint_number)}),{id:i.sessionId,track:o.track,trackId:o.track.toLowerCase().replace(/[^a-z0-9]/g,"_"),type:cs(o.session_type),date:us(o.date_start),time:ls(o.date_start),car:rs(o.car),startConditions:{weather:o.start_weather,airTemp:o.start_air_temp,trackTemp:o.start_road_temp},bestQualy:f?xt(f):"--:--.---",bestRace:P?xt(P):"--:--.---",theoQualy:xt(o.session_best_lap),theoRace:xt(o.session_best_lap),bestDeltaQ:{value:f?`+${((f-o.session_best_lap)/1e3).toFixed(3)}`:"-",stintNum:L},bestDeltaR:{value:P?`+${((P-o.session_best_lap)/1e3).toFixed(3)}`:"-",stintNum:$},stints:b,lapsData:y}}),B=tt({theoQualy:null,theoRace:null,theoAvgRace:null,dominantGrip:"Optimum",stintTemp:23,historicQualy:null,historicQualyTemp:null,historicRace:null,historicRaceTemp:null,historicAvgRace:null,historicAvgRaceTemp:null}),mt=tt(1),ae=tt(!1),O=U(()=>H.value.stints.find(p=>p.number===mt.value)),rt=U(()=>H.value.lapsData[mt.value]||[]);U(()=>rt.value.length<=1);const ye=U(()=>H.value.stints.length===1);Ze(rt,p=>{if(p.length>20){const o=p[0]?.lap,b=p[p.length-1]?.lap,y=[o,b].filter(Boolean);c.value=new Set(y)}else c.value=new Set},{immediate:!0});const re=U(()=>Tt.value?H.value.stints.find(p=>p.number===Tt.value):null),_e=U(()=>st.value?H.value.stints.find(p=>p.number===st.value):null),Nt=U(()=>Tt.value?H.value.lapsData[Tt.value]||[]:[]),le=U(()=>st.value?H.value.lapsData[st.value]||[]:[]),ue=U(()=>ht.value==="A"?Nt.value:le.value);U(()=>ht.value==="A"?re.value:_e.value);const Ee=U(()=>{const p=H.value.stints.filter(b=>b.type==="Q"&&b.laps>=2);if(p.length===0)return null;let o=p[0];return p.forEach(b=>{parseFloat(b.deltaVsTheo)<parseFloat(o.deltaVsTheo)&&(o=b)}),o}),Se=U(()=>{const p=H.value.stints.filter(b=>b.type==="R"&&b.laps>=2);if(p.length===0)return null;let o=p[0];return p.forEach(b=>{parseFloat(b.deltaVsTheo)<parseFloat(o.deltaVsTheo)&&(o=b)}),o});Ze([Se,Ee],([p,o])=>{ae.value||(p?(mt.value=p.number,ae.value=!0,console.log("[PRESELECTION] Best R stint:",p.number,"delta:",p.deltaVsTheo)):o&&(mt.value=o.number,ae.value=!0,console.log("[PRESELECTION] Best Q stint:",o.number,"delta:",o.deltaVsTheo)))});function X(p){return p.type==="Q"?Ee.value?.number===p.number:p.type==="R"?Se.value?.number===p.number:!1}function dt(p){const b=(H.value.lapsData[p.number]||[]).filter(f=>!f.pit),y=b.filter(f=>f.valid);return b.length>0&&y.length===0?{icon:"⚠️",message:"Tutti i giri invalidi"}:p.type==="R"&&b.length<5?{icon:"⚠️",message:`Stint gara troppo corto (${b.length} giri, min. 5)`}:p.type==="Q"&&b.length<=1?{icon:"⚠️",message:"Dati limitati (1 giro)"}:null}function F(p){return p<35?"#ef4444":p<75?"#f97316":"#10b981"}const V=U(()=>{const p=rt.value.filter(_=>!_.pit);if(p.length===0)return{airTemp:{start:0,mid:0,end:0,changed:!1},grip:{dominant:"Optimum",percentages:[],changed:!1,display:"Optimum"}};const o=Math.floor(p.length/2),b=p.length-1,y=Math.round(p[0]?.airTemp||0),f=Math.round(p[o]?.airTemp||y),P=Math.round(p[b]?.airTemp||y),L=Math.abs(y-P)>=2||Math.abs(y-f)>=2,$={},A=[];let R=0;const W=_=>_==="Opt"?"Optimum":_;for(const _ of p){let k=_.grip||"Unknown";k=W(k),k!=="Unknown"&&($[k]||A.push(k),$[k]=($[k]||0)+1,R++)}const q=[];let _t="Optimum",Et=0;for(const _ of A){const k=$[_]||0;if(k===0)continue;const Jt=Math.round(k/R*100);q.push({grip:_,pct:Jt}),k>Et&&(Et=k,_t=_)}const vt=q.length>1;let Ct=_t;vt&&(Ct=q.map(_=>`${_.grip} (${_.pct}%)`).join(" → "));const xe=L?Math.round((y+f+P)/3):y;return{airTemp:{start:y,mid:f,end:P,changed:L,avg:xe},grip:{dominant:_t,percentages:q,changed:vt,display:Ct}}});Ze([()=>Ut.value,()=>V.value],async([p,o])=>{if(!p)return;const b=p.session_info,y=(b.track||"").toLowerCase().replace(/[^a-z0-9]/g,"_"),f=o.grip.dominant||"Optimum",P=o.airTemp.avg||Math.round(b.start_air_temp||23),L=await et(y,f,P,Vt.value||void 0);B.value={theoQualy:L.theoQualy,theoRace:L.theoRace,theoAvgRace:L.theoAvgRace,dominantGrip:f,stintTemp:P,historicQualy:L.historicQualy,historicQualyTemp:L.historicQualyTemp,historicRace:L.historicRace,historicRaceTemp:L.historicRaceTemp,historicAvgRace:L.historicAvgRace,historicAvgRaceTemp:L.historicAvgRaceTemp}},{immediate:!0});const Wt=U(()=>{const o=(ct.value?Nt.value:rt.value).filter(_=>!c.value.has(_.lap)),b=ct.value?re.value:O.value,y=b?.type==="Q",f=y?B.value.theoQualy:B.value.theoRace,P=f?f/1e3:0,L=P>0?P+$e:0,$=b?.best;it($);const A=_=>_.pit?!1:it(_.time)<=L,R=_=>_.pit||!_.valid?!1:A(_),W=_=>_.pit||!_.valid?!1:_.time===$,q=o.map(_=>_.pit?"#6b7280":_.valid?yt.value&&W(_)?"#a855f7":yt.value&&R(_)?"#10b981":"#3b82f6":"#ef4444"),_t=o.map(_=>_.pit?"#6b7280":_.valid?yt.value&&W(_)?"#a855f7":yt.value&&R(_)?"#10b981":"#3b82f6":yt.value&&A(_)?"#10b981":"#ef4444"),Et=o.map(_=>!_.valid&&!_.pit&&yt.value&&A(_)?2:1),vt=[{label:ct.value?`A: Stint #${Tt.value}`:"Tempo",data:o.map(_=>it(_.time)),borderColor:"#3b82f6",backgroundColor:"rgba(59,130,246,0.1)",pointBackgroundColor:q,pointBorderColor:_t,pointBorderWidth:Et,pointRadius:5,tension:0,order:1},{label:`Teorico ${b?.type==="Q"?"Q":"R"}`,data:o.map(()=>P),borderColor:"#f59e0b",borderDash:[5,5],pointRadius:0,order:3}];if(!y&&yt.value&&o.length>0&&vt.push({label:`Target (+${$e}s)`,data:o.map(()=>L),borderColor:"rgba(16, 185, 129, 0.6)",borderWidth:2,borderDash:[3,3],backgroundColor:"rgba(16, 185, 129, 0.05)",fill:"origin",pointRadius:0,order:4}),qt.value&&Kt.value&&o.length>0){const _=Math.max(...o.map(k=>it(k.time)))+5;de.value.forEach((k,Jt)=>{const Le=jt[k.gripLevel]||jt.Opt,De=o.map((pe,ze)=>{const Ce=ze+1;return Ce>=k.startLap&&Ce<=k.endLap?_:null});vt.push({label:`_grip_${Jt}`,data:De,borderColor:"transparent",backgroundColor:Le?.bg,fill:"origin",pointRadius:0,order:10+Jt,spanGaps:!1})})}if(ct.value&&le.value.length>0){const _=le.value;vt.splice(1,0,{label:`B: Stint #${st.value}`,data:_.map(k=>it(k.time)),borderColor:"#8b5cf6",backgroundColor:"rgba(139,92,246,0.1)",pointBackgroundColor:_.map(k=>k.pit?"#6b7280":k.valid?"#8b5cf6":"#ef4444"),pointRadius:5,tension:0})}return{labels:o.map(_=>`G${_.lap}`),datasets:vt}}),Gt={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{color:"rgba(255,255,255,0.7)",font:{size:11},filter:p=>!p.text.startsWith("_")}},tooltip:{backgroundColor:"rgba(15,15,25,0.95)",callbacks:{label:p=>p.dataset.label?.startsWith("_")?"":`${p.dataset.label}: ${Mt(p.raw)}`}},zoom:{pan:{enabled:!0,mode:"x",modifierKey:void 0},zoom:{wheel:{enabled:!0},pinch:{enabled:!0},mode:"x",drag:{enabled:!1}},limits:{x:{min:"original",max:"original"}}}},scales:{x:{grid:{color:"rgba(255,255,255,0.08)"},ticks:{color:"rgba(255,255,255,0.6)",font:{size:11}}},y:{grid:{color:"rgba(255,255,255,0.08)"},ticks:{color:"rgba(255,255,255,0.6)",font:{size:11},callback:p=>typeof p=="number"?Mt(p):p}}}};function it(p){if(!p)return 0;const o=p.split(":"),b=Number(o[0])||0,y=Number(o[1])||0;return b*60+y}function Mt(p){return`${Math.floor(p/60)}:${(p%60).toFixed(3).padStart(6,"0")}`}function Ht(p){return{practice:"PRACTICE",qualify:"QUALIFY",race:"RACE"}[p]||p.toUpperCase()}function lt(p){if(!p||p==="-")return"far";const o=parseFloat(p);return isNaN(o)?"far":o<0?"faster":o===0?"ontarget":o<=.3?"close":o<=.5?"margin":"far"}function Ot(p){if(!p||p==="-")return"-";const o=parseFloat(p);return isNaN(o)?"-":o<0?"FASTER":o===0?"TARGET":o<=.3?"VICINO":o<=.5?"MARGINE":"LONTANO"}function $t(p){if(!p)return"-";const b=p.type==="Q"?B.value.theoQualy:B.value.theoRace;if(!b)return"-";const y=it(p.best);if(y===0)return"-";const f=b/1e3,P=y-f;return P>=0?`+${P.toFixed(3)}`:P.toFixed(3)}const ce=U(()=>{if(!O.value)return{value:"-",seconds:0,class:"neutral"};const p=it(O.value.best);if(p===0)return{value:"-",seconds:0,class:"neutral"};let o=null;if(O.value.type==="Q"?o=B.value.theoQualy:o=B.value.theoRace,!o)return{value:"-",seconds:0,class:"neutral"};const b=o/1e3,y=p-b,f=y>=0?`+${y.toFixed(3)}`:y.toFixed(3);return{value:f,seconds:y,class:lt(f)}}),Qt=U(()=>{if(!O.value)return{value:"-",seconds:0,class:"neutral"};const p=it(O.value.avg);if(p===0)return{value:"-",seconds:0,class:"neutral"};if(O.value.type==="Q")return{value:"-",seconds:0,class:"neutral"};const o=B.value.theoAvgRace;if(!o)return{value:"-",seconds:0,class:"neutral"};const b=o/1e3,y=p-b,f=y>=0?`+${y.toFixed(3)}`:y.toFixed(3);return{value:f,seconds:y,class:lt(f)}}),Y=U(()=>{if(!O.value||rt.value.length===0)return{onTarget:0,total:0,pct:0,targetLine:"-"};const o=O.value.type==="Q"?B.value.theoQualy:B.value.theoRace;if(!o)return{onTarget:0,total:0,pct:0,targetLine:"-"};const y=o/1e3+$e,f=rt.value.filter($=>!$.pit),P=f.length;let L=0;return f.forEach($=>{it($.time)<=y&&L++}),{onTarget:L,total:P,pct:P>0?Math.round(L/P*100):0,targetLine:Mt(y)}}),bt=U(()=>{const p=rt.value.filter(f=>!f.pit),o=p.length,b=p.filter(f=>f.valid).length,y=o-b;return{valid:b,invalid:y,total:o,pct:o>0?Math.round(b/o*100):100}}),Ne=U(()=>{if(!O.value)return{hours:0,minutes:0,seconds:0,formatted:"0min 00sec",showSeconds:!0};const p=O.value.durationMs||0;let o=0;p===0&&rt.value.length>0?rt.value.forEach($=>{o+=it($.time)}):o=Math.floor(p/1e3);const b=Math.floor(o/3600),y=Math.floor(o%3600/60),f=Math.floor(o%60);let P="";const L=b===0;return b>0?P=`${b}h ${y.toString().padStart(2,"0")}min`:P=`${y}min ${f.toString().padStart(2,"0")}sec`,{hours:b,minutes:y,seconds:f,formatted:P,showSeconds:L}}),yt=tt(!0),qt=tt(!1),jt={Opt:{bg:"rgba(16, 185, 129, 0.15)",border:"#10b981",label:"Optimum"},Green:{bg:"rgba(132, 204, 22, 0.15)",border:"#84cc16",label:"Green"},Greasy:{bg:"rgba(234, 179, 8, 0.15)",border:"#eab308",label:"Greasy"},Damp:{bg:"rgba(249, 115, 22, 0.15)",border:"#f97316",label:"Damp"},Wet:{bg:"rgba(59, 130, 246, 0.15)",border:"#3b82f6",label:"Wet"},Flooded:{bg:"rgba(139, 92, 246, 0.15)",border:"#8b5cf6",label:"Flooded"}},Kt=U(()=>{const p=rt.value;if(p.length<2)return!1;const o=p[0]?.grip;return p.some(b=>b.grip!==o)}),de=U(()=>{const p=rt.value;if(p.length===0)return[];const o=[];let b=p[0]?.grip||"Opt",y=1;return p.forEach((f,P)=>{f.grip!==b&&(o.push({gripLevel:b,startLap:y,endLap:P}),b=f.grip,y=P+1)}),o.push({gripLevel:b,startLap:y,endLap:p.length}),o});return(p,o)=>{const b=Ps,y=ps;return x(),ds(y,{class:"session-detail-page"},{default:ne(()=>[r("div",yi,[r("button",{class:"nav-btn",onClick:o[0]||(o[0]=f=>u("back"))},[...o[9]||(o[9]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M15 18l-6-6 6-6"})],-1),w(" Torna alle sessioni ",-1)])]),r("button",{class:"nav-btn nav-btn--accent",onClick:o[1]||(o[1]=f=>u("go-to-track",H.value.trackId))},[...o[10]||(o[10]=[w(" Apri pista ",-1),r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M9 18l6-6-6-6"})],-1)])])]),oe.value?(x(),C("div",_i,[...o[11]||(o[11]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"Caricamento sessione...",-1)])])):Z.value?(x(),C("div",Ei,[o[12]||(o[12]=r("p",{class:"error-icon"},"⚠️",-1)),r("p",Si,g(Z.value),1),r("button",{class:"nav-btn",onClick:o[2]||(o[2]=f=>u("back"))},"Torna alle sessioni")])):(x(),C(pt,{key:2},[r("header",xi,[r("div",Ci,[r("h1",Ii,g(H.value.track.toUpperCase()),1),r("span",{class:ot(["type-badge",`type-badge--${H.value.type}`])},g(Ht(H.value.type)),3)]),r("div",Pi,[r("span",null,g(H.value.date),1),o[13]||(o[13]=r("span",{class:"sep"},"•",-1)),r("span",null,g(H.value.time),1),o[14]||(o[14]=r("span",{class:"sep"},"•",-1)),r("span",Mi,g(H.value.car),1)])]),r("div",Oi,[r("aside",Ai,[r("h2",Ri,"Stint ("+g(H.value.stints.length)+")",1),o[20]||(o[20]=r("div",{class:"control-panel"},[r("button",{class:"control-btn control-btn--disabled",disabled:"",title:"Coming soon"},[r("span",{class:"control-icon"},"⚖️"),r("span",{class:"control-label"},"Confronta stint")]),r("span",{class:"control-hint"},"Coming soon")],-1)),r("div",{class:ot(["stint-header",{"stint-header--compare":at.value}])},[at.value?(x(),C("span",ki,"✓")):K("",!0),o[15]||(o[15]=r("span",{class:"sh-best-icon"},null,-1)),o[16]||(o[16]=r("span",{class:"sh-type"},"Tipo",-1)),o[17]||(o[17]=r("span",{class:"sh-num"},"#",-1)),o[18]||(o[18]=r("span",{class:"sh-laps"},"Giri",-1)),o[19]||(o[19]=r("span",{class:"sh-delta"},"Δ Theo",-1))],2),ye.value?(x(),C("div",wi," 1 stint in sessione · Nessun confronto interno disponibile ")):K("",!0),r("div",Ni,[(x(!0),C(pt,null,Re(H.value.stints,f=>(x(),C("button",{key:f.number,class:ot(["stint-item",{"stint-item--compare":at.value,selected:!at.value&&mt.value===f.number,"compare-selected":at.value&&nt.value.includes(f.number),"compare-a":at.value&&nt.value[0]===f.number,"compare-b":at.value&&nt.value[1]===f.number,"best-stint":X(f)}]),onClick:P=>Zt(f.number)},[at.value?(x(),C("span",Di,[nt.value.includes(f.number)?(x(),C("span",zi,g(nt.value[0]===f.number?"A":"B"),1)):(x(),C("span",Fi))])):K("",!0),r("span",{class:"stint-best-icon",title:dt(f)?.message},[X(f)?(x(),C(pt,{key:0},[w("🏆")],64)):dt(f)?(x(),C(pt,{key:1},[w(g(dt(f)?.icon),1)],64)):K("",!0)],8,Ui),r("span",{class:ot(["stint-type",`stint-type--${f.type.toLowerCase()}`])},g(f.type),3),r("span",Vi,"#"+g(f.number),1),r("span",Gi,g(f.laps),1),r("span",{class:ot(["stint-delta",`delta--${lt($t(f))}`])},[r("span",Hi,g($t(f)),1),r("span",Qi,g(Ot($t(f))),1)],2)],10,Li))),128))])]),r("section",Bi,[ct.value?(x(),C("div",Yi,[r("div",Zi,[o[21]||(o[21]=r("span",{class:"compare-label"},"Confronto Stint:",-1)),r("span",Xi,"A: #"+g(Tt.value)+" "+g(re.value?.type),1),o[22]||(o[22]=r("span",{class:"compare-vs"},"vs",-1)),r("span",Wi,"B: #"+g(st.value)+" "+g(_e.value?.type),1)]),r("button",{class:"compare-close",onClick:Xt},"✕ Chiudi confronto")])):K("",!0),ct.value?K("",!0):(x(),C("div",$i,[r("span",{class:ot(["stint-type-tag",`stint-type-tag--${O.value?.type?.toLowerCase()}`])},g(O.value?.type==="Q"?"QUALY":"RACE"),3),r("h3",qi,"Stint #"+g(mt.value)+" · "+g(O.value?.intent??"Seleziona uno stint"),1),O.value&&X(O.value)?(x(),C("span",ji,"🏆 Best")):K("",!0)])),O.value&&dt(O.value)?(x(),C("div",Ki,g(dt(O.value)?.icon)+" "+g(dt(O.value)?.message),1)):K("",!0),r("div",Ji,[r("div",to,[r("span",eo,[o[23]||(o[23]=r("span",{class:"tc-cond-lbl"},"Aria",-1)),r("span",no,[V.value.airTemp.changed?(x(),C(pt,{key:0},[w(g(V.value.airTemp.start)+"° → "+g(V.value.airTemp.mid)+"° → "+g(V.value.airTemp.end)+"° ",1)],64)):(x(),C(pt,{key:1},[w(g(V.value.airTemp.start)+"°",1)],64))])]),r("span",so,[o[24]||(o[24]=r("span",{class:"tc-cond-lbl"},"Grip",-1)),r("span",io,g(V.value.grip.display),1)])]),r("div",oo,[r("div",ao,[r("h5",ro,[o[26]||(o[26]=w(" TEMPI STINT ",-1)),ee(b,{title:"Tempi Stint",position:"left"},{default:ne(()=>[...o[25]||(o[25]=[r("b",null,"BEST:",-1),w(" Giro più veloce tra i giri validi dello stint.",-1),r("br",null,null,-1),r("b",null,"AVG:",-1),w(' Media dei giri "puliti" (validi, no pit, no outlap, entro 115% del best). ',-1)])]),_:1})]),r("div",lo,[r("span",uo,g(O.value?.type==="Q"?"BEST STINT Q:":"BEST STINT R:"),1),r("span",co,g(O.value?.best??"-"),1)]),r("div",po,[r("span",fo,g(O.value?.type==="Q"?"AVG STINT Q:":"AVG STINT R:"),1),r("span",vo,g(O.value?.avg??"-"),1)])]),o[33]||(o[33]=r("div",{class:"tc-divider"},null,-1)),r("div",ho,[r("h5",mo,[w(" TEORICI ("+g(V.value.grip.dominant||"Optimum")+" "+g(V.value.airTemp.avg)+"°) ",1),ee(b,{title:"Tempi Teorici",position:"right"},{default:ne(()=>[...o[27]||(o[27]=[w(" Best storico per il grip dominante + aggiustamento temperatura:",-1),r("br",null,null,-1),r("code",null,"Teorico = Storico + (TempStint - TempStorico) × 0.1s/°C",-1),r("br",null,null,-1),w(" Pista più fredda = tempo più veloce ",-1)])]),_:1})]),O.value?.type==="Q"?(x(),C("div",go,[o[28]||(o[28]=r("span",{class:"tc-label"},"THEO BEST Q:",-1)),r("span",To,g(B.value.theoQualy?se(xt)(B.value.theoQualy):"—:—.---"),1)])):(x(),C(pt,{key:1},[r("div",bo,[o[29]||(o[29]=r("span",{class:"tc-label"},"THEO BEST R:",-1)),r("span",yo,g(B.value.theoRace?se(xt)(B.value.theoRace):"—:—.---"),1)]),r("div",_o,[o[30]||(o[30]=r("span",{class:"tc-label"},"THEO AVG:",-1)),r("span",Eo,g(B.value.theoAvgRace?se(xt)(B.value.theoAvgRace):"—:—.---"),1)])],64))]),o[34]||(o[34]=r("div",{class:"tc-divider"},null,-1)),r("div",So,[r("h5",xo,[o[32]||(o[32]=w(" DELTA ",-1)),ee(b,{title:"Legenda Colori Delta",position:"right"},{default:ne(()=>[...o[31]||(o[31]=[r("span",{style:{color:"#10b981"}},"●",-1),w(),r("b",null,"Verde",-1),w(" = Più veloce o = al teorico",-1),r("br",null,null,-1),r("span",{style:{color:"#eab308"}},"●",-1),w(),r("b",null,"Giallo",-1),w(" = Vicino (+0.0 - +0.3s)",-1),r("br",null,null,-1),r("span",{style:{color:"#f97316"}},"●",-1),w(),r("b",null,"Arancione",-1),w(" = Margine (+0.3 - +0.5s)",-1),r("br",null,null,-1),r("span",{style:{color:"#ef4444"}},"●",-1),w(),r("b",null,"Rosso",-1),w(" = Lontano (> +0.5s) ",-1)])]),_:1})]),r("div",Co,[r("span",{class:ot(["tc-delta-inline",ce.value.class])},g(ce.value.value),3)]),r("div",Io,[r("span",{class:ot(["tc-delta-inline",Qt.value.class])},g(Qt.value.value),3)])])]),r("div",Po,[o[35]||(o[35]=r("span",{class:"tc-duration-label"},"DURATA STINT:",-1)),r("span",Mo,g(Ne.value.formatted),1)]),O.value?.type==="R"&&Y.value.total>0?(x(),C("div",Oo,[r("span",Ao,[o[37]||(o[37]=w(" GIRI NEL TARGET ",-1)),ee(b,{title:"Target = Teorico + 0.6s",position:"left",size:"small"},{default:ne(()=>[...o[36]||(o[36]=[w(" Conta quanti giri dello stint hanno un tempo ≤ al target.",-1),r("br",null,null,-1),w(" Include tutti i giri (validi e invalidi), esclusi i pit. ",-1)])]),_:1})]),r("div",Ro,[r("span",ko,g(Y.value.onTarget)+" su "+g(Y.value.total),1),r("div",wo,[r("div",{class:"tc-cons-fill",style:me({width:Y.value.pct+"%",background:F(Y.value.pct)})},null,4)]),r("span",{class:"tc-cons-pct",style:me({color:F(Y.value.pct)})},g(Y.value.pct)+"%",5)]),r("div",No,[o[38]||(o[38]=r("span",{class:"tc-target-label"},"TARGET:",-1)),r("span",Lo,g(Y.value.targetLine),1)]),r("div",Do,[r("label",zo,[gn(r("input",{type:"checkbox","onUpdate:modelValue":o[3]||(o[3]=f=>yt.value=f)},null,512),[[Tn,yt.value]]),o[39]||(o[39]=r("span",{class:"tc-toggle-slider"},null,-1)),o[40]||(o[40]=r("span",{class:"tc-toggle-label"},"Target",-1))]),Kt.value?(x(),C("label",Fo,[gn(r("input",{type:"checkbox","onUpdate:modelValue":o[4]||(o[4]=f=>qt.value=f)},null,512),[[Tn,qt.value]]),o[41]||(o[41]=r("span",{class:"tc-toggle-slider"},null,-1)),o[42]||(o[42]=r("span",{class:"tc-toggle-label"},"Grip",-1))])):K("",!0)])])):K("",!0),bt.value.total>0?(x(),C("div",Uo,[o[44]||(o[44]=r("span",{class:"tc-cons-title"},"GIRI VALIDI",-1)),r("div",Vo,[r("span",Go,g(bt.value.valid)+" su "+g(bt.value.total),1),r("div",Ho,[r("div",{class:"tc-cons-fill",style:me({width:bt.value.pct+"%",background:F(bt.value.pct)})},null,4)]),r("span",{class:"tc-cons-pct",style:me({color:F(bt.value.pct)})},g(bt.value.pct)+"%",5)]),bt.value.invalid>0?(x(),C("span",Qo,[o[43]||(o[43]=r("span",{class:"tc-invalid-dot"},null,-1)),w(" "+g(bt.value.invalid)+" invalidi ",1)])):K("",!0)])):K("",!0)]),r("div",Bo,[r("div",Yo,[r("h4",Zo,[ct.value?(x(),C(pt,{key:0},[w("Confronto Tempi — A: Stint #"+g(Tt.value)+" vs B: Stint #"+g(st.value),1)],64)):(x(),C(pt,{key:1},[w("Tempi Giro — Stint "+g(mt.value),1)],64))]),r("div",Xo,[r("button",{class:"toolbar-btn",onClick:D,title:"Zoom In"},[...o[45]||(o[45]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("circle",{cx:"11",cy:"11",r:"8"}),r("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),r("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),r("line",{x1:"8",y1:"11",x2:"14",y2:"11"})],-1)])]),r("button",{class:"toolbar-btn",onClick:N,title:"Zoom Out"},[...o[46]||(o[46]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("circle",{cx:"11",cy:"11",r:"8"}),r("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),r("line",{x1:"8",y1:"11",x2:"14",y2:"11"})],-1)])]),r("button",{class:"toolbar-btn",onClick:I,title:"Reset Zoom"},[...o[47]||(o[47]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("polyline",{points:"1 4 1 10 7 10"}),r("polyline",{points:"23 20 23 14 17 14"}),r("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])]),o[49]||(o[49]=r("div",{class:"toolbar-divider"},null,-1)),r("button",{class:ot(["toolbar-btn",{"toolbar-btn--active":v.value}]),onClick:o[5]||(o[5]=f=>v.value=!v.value),title:"Gestisci Giri"},[...o[48]||(o[48]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),r("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),r("line",{x1:"9",y1:"21",x2:"9",y2:"9"})],-1)])],2)])]),v.value?(x(),C("div",Wo,[r("div",$o,[o[50]||(o[50]=r("span",{class:"lap-manager-title"},"Escludi Giri dal Grafico",-1)),r("button",{class:"lap-manager-reset",onClick:S,disabled:c.value.size===0}," Reset ",8,qo)]),r("div",jo,[(x(!0),C(pt,null,Re(rt.value,f=>(x(),C("button",{key:f.lap,class:ot(["lap-toggle-btn",{"lap-toggle-btn--excluded":c.value.has(f.lap)},{"lap-toggle-btn--invalid":!f.valid&&!f.pit},{"lap-toggle-btn--pit":f.pit}]),onClick:P=>E(f.lap),title:`Giro ${f.lap} - ${f.time}${f.valid?"":" (Invalido)"}${f.pit?" (Pit)":""}`},g(f.lap),11,Ko))),128))]),c.value.size>0?(x(),C("div",Jo,g(c.value.size)+" giri esclusi ",1)):K("",!0)])):K("",!0),r("div",ta,[ee(se(Ss),{ref_key:"chartRef",ref:m,data:Wt.value,options:Gt},null,8,["data"])]),Kt.value&&qt.value?(x(),C("div",ea,[o[51]||(o[51]=r("span",{class:"grip-legend-title"},"Grip:",-1)),(x(!0),C(pt,null,Re(de.value,f=>(x(),C("div",{key:`${f.gripLevel}-${f.startLap}`,class:"grip-legend-item"},[r("span",{class:"grip-legend-dot",style:me({backgroundColor:jt[f.gripLevel]?.border||"#fff"})},null,4),r("span",na,g(jt[f.gripLevel]?.label||f.gripLevel),1),r("span",sa,"(G"+g(f.startLap)+"-G"+g(f.endLap)+")",1)]))),128))])):K("",!0)]),r("div",ia,[r("div",oa,[ct.value?(x(),C("div",aa,[r("button",{class:ot(["lap-tab",{"lap-tab--active":ht.value==="A"}]),onClick:o[6]||(o[6]=f=>ht.value="A")}," A: Stint #"+g(Tt.value),3),r("button",{class:ot(["lap-tab",{"lap-tab--active":ht.value==="B"}]),onClick:o[7]||(o[7]=f=>ht.value="B")}," B: Stint #"+g(st.value),3)])):(x(),C("h4",ra,"Tabella Giri — Stint "+g(mt.value),1)),r("button",{class:"toggle-btn",onClick:o[8]||(o[8]=f=>l.value=!l.value)},g(l.value?"Vista semplice":"Dettagli"),1)]),r("div",la,[r("table",ua,[r("thead",null,[r("tr",null,[o[58]||(o[58]=r("th",null,"Giro",-1)),o[59]||(o[59]=r("th",null,"Tempo",-1)),o[60]||(o[60]=r("th",null,"Δ Teorico",-1)),o[61]||(o[61]=r("th",null,"Stato",-1)),l.value?(x(),C(pt,{key:0},[o[52]||(o[52]=r("th",null,"S1",-1)),o[53]||(o[53]=r("th",null,"S2",-1)),o[54]||(o[54]=r("th",null,"S3",-1)),o[55]||(o[55]=r("th",null,"Fuel",-1)),o[56]||(o[56]=r("th",null,"Air°",-1)),o[57]||(o[57]=r("th",null,"Grip",-1))],64)):K("",!0)])]),r("tbody",null,[(x(!0),C(pt,null,Re(ct.value?ue.value:rt.value,f=>(x(),C("tr",{key:f.lap,class:ot({invalid:!f.valid,pit:f.pit,excluded:c.value.has(f.lap)})},[r("td",null,g(f.lap),1),r("td",ca,g(f.time),1),r("td",{class:ot(["delta",`delta--${lt(f.delta)}`])},g(f.delta),3),r("td",da,g(f.pit?"PIT":f.valid?"✓":"INV"),1),l.value?(x(),C(pt,{key:0},[r("td",null,g(f.sectors[0]),1),r("td",null,g(f.sectors[1]),1),r("td",null,g(f.sectors[2]),1),r("td",null,g(f.fuel)+"L",1),r("td",null,g(Math.round(f.airTemp))+"°",1),r("td",null,g(f.grip),1)],64)):K("",!0)],2))),128))])])])])])])],64))]),_:1})}}}),ga=Object.assign(Dn(pa,[["__scopeId","data-v-cb0915e3"]]),{__name:"PagesSessionDetailPage"});export{ga as _};
