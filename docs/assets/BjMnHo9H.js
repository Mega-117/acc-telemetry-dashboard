import{u as Ot,f as w,a as Vt,c as Pt,d as Wt,g as Ut,_ as zt}from"./ApLwZRIX.js";import{b as kt,r as L,o as Zt,m as c,w as Ht,J as Tt,D as i,H as Yt,E as e,C as r,I as A,F as l,N as x,Z as S,M as h,O as it,ad as ht,K as U,X as rt,$ as _t,ae as yt,G as qt,_ as jt,Y as Kt,n as Jt}from"./D0g2xLIp.js";import{C as Xt,a as te,L as ee,P as se,b as ae,p as le,c as ne,d as oe,i as ie,e as re}from"./7WvQwF6H.js";const ue={class:"nav-bar"},ce={key:0,class:"loading-state"},de={key:1,class:"error-state"},pe={class:"error-text"},ve={class:"session-header"},me={class:"header-row"},be={class:"track-name"},ge={class:"header-meta"},fe={class:"car"},he={class:"master-detail"},_e={class:"master"},ye={class:"master-title"},ke={key:0,class:"sh-checkbox"},Te={key:0,class:"single-stint-note"},Se={class:"stint-list"},Ce=["onClick"],Le={key:0,class:"stint-checkbox"},Ae={key:0,class:"checkbox-checked"},Re={key:1,class:"checkbox-empty"},we=["title"],xe={class:"stint-num"},$e={class:"stint-laps"},Be={class:"delta-val"},De={class:"delta-lbl"},Qe={class:"detail"},Ge={key:0,class:"compare-header"},Ee={class:"compare-info"},Me={class:"compare-a"},Fe={class:"compare-b"},Ie={key:1,class:"detail-header"},Ne={class:"detail-title"},Oe={key:0,class:"best-tag"},Ve={key:2,class:"limited-data"},Pe={class:"times-comparison"},We={class:"tc-conditions"},Ue={class:"tc-cond-item"},ze={class:"tc-cond-val"},Ze={class:"tc-cond-item"},He={class:"tc-cond-val"},Ye={class:"tc-cond-item"},qe={class:"tc-cond-val"},je={class:"tc-cond-item"},Ke={class:"tc-cond-val"},Je={class:"tc-main"},Xe={class:"tc-column tc-actual"},ts={class:"tc-header"},es={key:0,class:"info-popup"},ss={class:"tc-row"},as={class:"tc-value"},ls={class:"tc-row"},ns={class:"tc-value"},os={class:"tc-column tc-theo"},is={class:"tc-header"},rs={key:0,class:"info-popup info-popup-right"},us={key:0,class:"tc-row"},cs={class:"tc-value"},ds={class:"tc-row"},ps={class:"tc-value"},vs={class:"tc-row"},ms={class:"tc-value"},bs={class:"tc-column tc-deltas"},gs={class:"tc-row"},fs={class:"tc-row"},hs={class:"tc-duration"},_s={class:"tc-duration-value"},ys={class:"tc-duration-value"},ks={key:0,class:"tc-consistency"},Ts={class:"tc-cons-simple"},Ss={class:"tc-cons-number"},Cs={class:"tc-cons-bar-wide"},Ls={class:"tc-cons-pct"},As={class:"tc-toggles-row"},Rs={class:"tc-toggle",title:"Mostra target zone sul grafico"},ws={key:0,class:"tc-toggle",title:"Mostra zone grip sul grafico"},xs={key:1,class:"tc-validity"},$s={class:"tc-cons-simple"},Bs={class:"tc-cons-number"},Ds={class:"tc-cons-bar-wide"},Qs={key:0,class:"tc-invalid-badge"},Gs={class:"chart-section"},Es={class:"chart-title"},Ms={class:"chart-wrap"},Fs={key:0,class:"grip-legend"},Is={class:"grip-legend-label"},Ns={class:"grip-legend-laps"},Os={class:"laps-section"},Vs={class:"laps-header-row"},Ps={key:0,class:"laps-tabs"},Ws={key:1,class:"laps-title"},Us={class:"laps-table-wrap"},zs={class:"laps-table"},Zs={class:"time"},Hs={class:"status"},Ys=kt({__name:"SessionDetailPage",props:{sessionId:{}},emits:["back","open-track"],setup(ut,{emit:tt}){Xt.register(te,ee,se,ae,le,ne,oe,ie);const z=ut,V=tt,E=L(!1),P=L(!1),Z=L(!1),{fetchSessionFull:St,trackStats:Ct,loadSessions:Lt}=Ot(),H=L(null),et=L(!0),Y=L(null);Zt(async()=>{et.value=!0,Y.value=null;try{await Lt();const s=await St(z.sessionId);s?(H.value=s,console.log("[SESSION_DETAIL] Loaded session:",s.session_info.track,s.stints.length,"stints")):Y.value="Sessione non trovata"}catch(s){Y.value=s.message||"Errore caricamento"}finally{et.value=!1}});const R=L(!1),_=L([]),N=L("A"),$=c(()=>R.value&&_.value.length===2),M=c(()=>_.value[0]??B.value),F=c(()=>_.value[1]??null);function At(s){R.value?Rt(s):B.value=s}function Rt(s){const t=_.value.indexOf(s);t>=0?_.value.splice(t,1):_.value.length<2&&_.value.push(s)}function wt(){_.value=[],R.value=!1,N.value="A"}const m=c(()=>{if(!H.value)return{id:z.sessionId,track:"Caricamento...",trackId:"",type:"practice",date:"-",time:"-",car:"-",startConditions:{weather:"-",airTemp:0,trackTemp:0},bestQualy:"--:--.---",bestRace:"--:--.---",theoQualy:"--:--.---",theoRace:"--:--.---",bestDeltaQ:{value:"-",stintNum:0},bestDeltaR:{value:"-",stintNum:0},stints:[],lapsData:{}};const s=H.value,t=s.session_info,n=s.stints.map(b=>{const d=b.laps.filter(k=>k.is_valid&&!k.has_pit_stop),f=d.length>0?Math.min(...d.map(k=>k.lap_time_ms)):null,Q=d.length>0?d.reduce((k,ot)=>k+ot.lap_time_ms,0)/d.length:null;return{number:b.stint_number,type:b.type==="Qualify"?"Q":"R",intent:b.type==="Qualify"?"Qualy Push":"Race Pace",fuelStart:b.fuel_start,laps:b.laps.length,best:f?w(f):"--:--.---",avg:Q?w(Q):"--:--.---",theoretical:w(t.session_best_lap),deltaVsTheo:f?`+${((f-t.session_best_lap)/1e3).toFixed(3)}`:"-",conditions:{weather:t.start_weather,avgAirTemp:t.start_air_temp,avgTrackTemp:t.start_road_temp},breakdown:{base:"-",deltaTemp:"-",deltaGrip:"-"}}}),a={};s.stints.forEach(b=>{a[b.stint_number]=b.laps.map(d=>({lap:d.lap_number,time:w(d.lap_time_ms),delta:`+${((d.lap_time_ms-t.session_best_lap)/1e3).toFixed(3)}`,valid:d.is_valid,pit:d.has_pit_stop,sectors:d.sector_times_ms?.map(f=>(f/1e3).toFixed(1))||["-","-","-"],fuel:Math.round(d.fuel_remaining),trackTemp:Math.round(d.road_temp),grip:d.track_grip_status||"Opt"}))});let o=null,v=null,D=0,g=0;return s.stints.forEach(b=>{const d=b.laps.filter(Q=>Q.is_valid&&!Q.has_pit_stop);if(d.length===0)return;const f=Math.min(...d.map(Q=>Q.lap_time_ms));b.type==="Qualify"?(!o||f<o)&&(o=f,D=b.stint_number):(!v||f<v)&&(v=f,g=b.stint_number)}),{id:z.sessionId,track:t.track,trackId:t.track.toLowerCase().replace(/[^a-z0-9]/g,"_"),type:Ut(t.session_type),date:Wt(t.date_start),time:Pt(t.date_start),car:Vt(t.car),startConditions:{weather:t.start_weather,airTemp:t.start_air_temp,trackTemp:t.start_road_temp},bestQualy:o?w(o):"--:--.---",bestRace:v?w(v):"--:--.---",theoQualy:w(t.session_best_lap),theoRace:w(t.session_best_lap),bestDeltaQ:{value:o?`+${((o-t.session_best_lap)/1e3).toFixed(3)}`:"-",stintNum:D},bestDeltaR:{value:v?`+${((v-t.session_best_lap)/1e3).toFixed(3)}`:"-",stintNum:g},stints:n,lapsData:a}}),O=c(()=>{if(!H.value)return{theoQualy:null,theoRace:null,theoAvgRace:null};const s=H.value,t=s.session_info,n=t.start_air_temp||23,o=s.stints[0]?.laps[0]?.track_grip_status||"Optimum",v=(t.track||"").toLowerCase().replace(/[^a-z0-9]/g,"_"),D=Ct.value.find(d=>{const f=d.track.toLowerCase().replace(/[^a-z0-9]/g,"_");return f.includes(v)||v.includes(f)});if(!D?.bestByGrip)return{theoQualy:null,theoRace:null,theoAvgRace:null,sessionGrip:o,sessionTemp:n};const g=D.bestByGrip[o];if(!g)return{theoQualy:null,theoRace:null,theoAvgRace:null,sessionGrip:o,sessionTemp:n};function b(d,f){if(!d)return null;const k=(n-(f||n))*100;return Math.round(d+k)}return{theoQualy:b(g.bestQualy,g.bestQualyTemp),theoRace:b(g.bestRace,g.bestRaceTemp),theoAvgRace:b(g.bestAvgRace,g.bestAvgRaceTemp),sessionGrip:o,sessionTemp:n,historicQualy:g.bestQualy,historicQualyTemp:g.bestQualyTemp,historicRace:g.bestRace,historicRaceTemp:g.bestRaceTemp,historicAvgRace:g.bestAvgRace,historicAvgRaceTemp:g.bestAvgRaceTemp}}),B=L(1);Ht(()=>m.value.stints,s=>{if(s.length>0){const t=s.filter(n=>n.laps>=2);if(t.length>0){let n=t[0],a=parseFloat(n.deltaVsTheo)||999;t.forEach(o=>{const v=parseFloat(o.deltaVsTheo)||999;v<a&&(n=o,a=v)}),B.value=n.number}else B.value=s[0]?.number||1}},{immediate:!0});const p=c(()=>m.value.stints.find(s=>s.number===B.value)),C=c(()=>m.value.lapsData[B.value]||[]);c(()=>C.value.length<=1);const xt=c(()=>m.value.stints.length===1),st=c(()=>M.value?m.value.stints.find(s=>s.number===M.value):null),ct=c(()=>F.value?m.value.stints.find(s=>s.number===F.value):null),dt=c(()=>M.value?m.value.lapsData[M.value]||[]:[]),j=c(()=>F.value?m.value.lapsData[F.value]||[]:[]),$t=c(()=>N.value==="A"?dt.value:j.value);c(()=>N.value==="A"?st.value:ct.value);const Bt=c(()=>{const s=m.value.stints.filter(n=>n.type==="Q"&&n.laps>=2);if(s.length===0)return null;let t=s[0];return s.forEach(n=>{parseFloat(n.deltaVsTheo)<parseFloat(t.deltaVsTheo)&&(t=n)}),t}),Dt=c(()=>{const s=m.value.stints.filter(n=>n.type==="R"&&n.laps>=2);if(s.length===0)return null;let t=s[0];return s.forEach(n=>{parseFloat(n.deltaVsTheo)<parseFloat(t.deltaVsTheo)&&(t=n)}),t});function at(s){return s.type==="Q"?Bt.value?.number===s.number:s.type==="R"?Dt.value?.number===s.number:!1}function W(s){const n=(m.value.lapsData[s.number]||[]).filter(o=>!o.pit),a=n.filter(o=>o.valid);return n.length>0&&a.length===0?{icon:"‚ö†Ô∏è",message:"Tutti i giri invalidi"}:s.type==="R"&&n.length<5?{icon:"‚ö†Ô∏è",message:`Stint gara troppo corto (${n.length} giri, min. 5)`}:s.type==="Q"&&n.length<=1?{icon:"‚ö†Ô∏è",message:"Dati limitati (1 giro)"}:null}const Qt=c(()=>{const s=$.value?dt.value:C.value,t=$.value?st.value:p.value,n=y(t?.theoretical),a=t?.type==="R",o=n+.3,v=t?.best;y(v);const D=u=>u.pit?!1:y(u.time)<=o,g=u=>u.pit||!u.valid?!1:D(u),b=u=>u.pit||!u.valid?!1:u.time===v,d=s.map(u=>u.pit?"#6b7280":u.valid?G.value&&b(u)?"#a855f7":G.value&&g(u)?"#10b981":"#3b82f6":"#ef4444"),f=s.map(u=>u.pit?"#6b7280":u.valid?G.value&&b(u)?"#a855f7":G.value&&g(u)?"#10b981":"#3b82f6":G.value&&D(u)?"#10b981":"#ef4444"),Q=s.map(u=>!u.valid&&!u.pit&&G.value&&D(u)?2:1),k=[{label:$.value?`A: Stint #${M.value}`:"Tempo",data:s.map(u=>y(u.time)),borderColor:"#3b82f6",backgroundColor:"rgba(59,130,246,0.1)",pointBackgroundColor:d,pointBorderColor:f,pointBorderWidth:Q,pointRadius:5,tension:.2,order:1},{label:`Teorico ${t?.type==="Q"?"Q":"R"}`,data:s.map(()=>n),borderColor:"#f59e0b",borderDash:[5,5],pointRadius:0,order:3}];if(a&&G.value&&s.length>0&&k.push({label:"Target (+0.3s)",data:s.map(()=>o),borderColor:"rgba(16, 185, 129, 0.6)",borderWidth:2,borderDash:[3,3],backgroundColor:"rgba(16, 185, 129, 0.05)",fill:"origin",pointRadius:0,order:4}),J.value&&nt.value&&s.length>0){const u=Math.max(...s.map(T=>y(T.time)))+5;bt.value.forEach((T,gt)=>{const Ft=X[T.gripLevel]||X.Opt,It=s.map((Ks,Nt)=>{const ft=Nt+1;return ft>=T.startLap&&ft<=T.endLap?u:null});k.push({label:`_grip_${gt}`,data:It,borderColor:"transparent",backgroundColor:Ft?.bg,fill:"origin",pointRadius:0,order:10+gt,spanGaps:!1})})}if($.value&&j.value.length>0){const u=j.value;k.splice(1,0,{label:`B: Stint #${F.value}`,data:u.map(T=>y(T.time)),borderColor:"#8b5cf6",backgroundColor:"rgba(139,92,246,0.1)",pointBackgroundColor:u.map(T=>T.pit?"#6b7280":T.valid?"#8b5cf6":"#ef4444"),pointRadius:5,tension:.2})}const ot=$.value?Math.max(s.length,j.value.length):s.length;return{labels:Array.from({length:ot},(u,T)=>`G${T+1}`),datasets:k}}),Gt={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{color:"rgba(255,255,255,0.7)",font:{size:11},filter:s=>!s.text.startsWith("_")}},tooltip:{backgroundColor:"rgba(15,15,25,0.95)",callbacks:{label:s=>s.dataset.label?.startsWith("_")?"":`${s.dataset.label}: ${lt(s.raw)}`}}},scales:{x:{grid:{color:"rgba(255,255,255,0.08)"},ticks:{color:"rgba(255,255,255,0.6)",font:{size:11}}},y:{grid:{color:"rgba(255,255,255,0.08)"},ticks:{color:"rgba(255,255,255,0.6)",font:{size:11},callback:s=>typeof s=="number"?lt(s):s}}}};function y(s){if(!s)return 0;const t=s.split(":"),n=Number(t[0])||0,a=Number(t[1])||0;return n*60+a}function lt(s){return`${Math.floor(s/60)}:${(s%60).toFixed(3).padStart(6,"0")}`}function Et(s){return{practice:"PRACTICE",qualify:"QUALIFY",race:"RACE"}[s]||s.toUpperCase()}function K(s){if(!s)return"far";const t=parseFloat(s);return t<=0?"fast":t<=.3?"ok":t<=.5?"margin":"far"}function Mt(s){const t=parseFloat(s);return t<=0?"FAST":t<=.3?"OK":t<=.5?"MARGIN":"LONTANO"}const pt=c(()=>{if(!p.value)return{value:"-",seconds:0,class:"neutral"};const s=y(p.value.best),t=y(p.value.theoretical),n=s-t,a=n>=0?`+${n.toFixed(3)}`:n.toFixed(3);return{value:a,seconds:n,class:K(a)}}),vt=c(()=>{if(!p.value)return{value:"-",seconds:0,class:"neutral"};const s=y(p.value.avg),n=y(p.value.theoretical)+.5,a=s-n,o=a>=0?`+${a.toFixed(3)}`:a.toFixed(3);return{value:o,seconds:a,class:K(o)}}),q=c(()=>{if(!p.value||C.value.length===0)return{onTarget:0,total:0,pct:0,targetLine:"-"};const t=y(p.value.theoretical)+.3,n=C.value.filter(v=>v.valid&&!v.pit),a=n.length;let o=0;return n.forEach(v=>{y(v.time)<=t&&o++}),{onTarget:o,total:a,pct:a>0?Math.round(o/a*100):0,targetLine:lt(t)}}),I=c(()=>{const s=C.value.filter(o=>!o.pit),t=s.length,n=s.filter(o=>o.valid).length,a=t-n;return{valid:n,invalid:a,total:t,pct:t>0?Math.round(n/t*100):100}}),mt=c(()=>{if(!C.value||C.value.length===0)return{minutes:0,seconds:0,formatted:"0:00"};let s=0;C.value.forEach(o=>{s+=y(o.time)});const t=Math.floor(s/60),n=Math.floor(s%60),a=`${t}:${n.toString().padStart(2,"0")}`;return{minutes:t,seconds:n,formatted:a}}),G=L(!0),J=L(!0),X={Opt:{bg:"rgba(16, 185, 129, 0.15)",border:"#10b981",label:"Optimum"},Green:{bg:"rgba(132, 204, 22, 0.15)",border:"#84cc16",label:"Green"},Greasy:{bg:"rgba(234, 179, 8, 0.15)",border:"#eab308",label:"Greasy"},Damp:{bg:"rgba(249, 115, 22, 0.15)",border:"#f97316",label:"Damp"},Wet:{bg:"rgba(59, 130, 246, 0.15)",border:"#3b82f6",label:"Wet"},Flooded:{bg:"rgba(139, 92, 246, 0.15)",border:"#8b5cf6",label:"Flooded"}},nt=c(()=>{const s=C.value;if(s.length<2)return!1;const t=s[0]?.grip;return s.some(n=>n.grip!==t)}),bt=c(()=>{const s=C.value;if(s.length===0)return[];const t=[];let n=s[0]?.grip||"Opt",a=1;return s.forEach((o,v)=>{o.grip!==n&&(t.push({gripLevel:n,startLap:a,endLap:v}),n=o.grip,a=v+1)}),t.push({gripLevel:n,startLap:a,endLap:s.length}),t});return(s,t)=>{const n=zt;return i(),Tt(n,{class:"session-detail-page"},{default:Yt(()=>[e("div",ue,[e("button",{class:"nav-btn",onClick:t[0]||(t[0]=a=>V("back"))},[...t[12]||(t[12]=[e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M15 18l-6-6 6-6"})],-1),A(" Torna alle sessioni ",-1)])]),e("button",{class:"nav-btn nav-btn--accent",onClick:t[1]||(t[1]=a=>V("open-track",m.value.trackId))},[...t[13]||(t[13]=[A(" Apri pista ",-1),e("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M9 18l6-6-6-6"})],-1)])])]),et.value?(i(),r("div",ce,[...t[14]||(t[14]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"Caricamento sessione...",-1)])])):Y.value?(i(),r("div",de,[t[15]||(t[15]=e("p",{class:"error-icon"},"‚ö†Ô∏è",-1)),e("p",pe,l(Y.value),1),e("button",{class:"nav-btn",onClick:t[2]||(t[2]=a=>V("back"))},"Torna alle sessioni")])):(i(),r(x,{key:2},[e("header",ve,[e("div",me,[e("h1",be,l(m.value.track.toUpperCase()),1),e("span",{class:S(["type-badge",`type-badge--${m.value.type}`])},l(Et(m.value.type)),3)]),e("div",ge,[e("span",null,l(m.value.date),1),t[16]||(t[16]=e("span",{class:"sep"},"‚Ä¢",-1)),e("span",null,l(m.value.time),1),t[17]||(t[17]=e("span",{class:"sep"},"‚Ä¢",-1)),e("span",fe,l(m.value.car),1)])]),e("div",he,[e("aside",_e,[e("h2",ye,"Stint ("+l(m.value.stints.length)+")",1),t[23]||(t[23]=e("div",{class:"control-panel"},[e("button",{class:"control-btn control-btn--disabled",disabled:"",title:"Coming soon"},[e("span",{class:"control-icon"},"‚öñÔ∏è"),e("span",{class:"control-label"},"Confronta stint")]),e("span",{class:"control-hint"},"Coming soon")],-1)),e("div",{class:S(["stint-header",{"stint-header--compare":R.value}])},[R.value?(i(),r("span",ke,"‚úì")):h("",!0),t[18]||(t[18]=e("span",{class:"sh-best-icon"},null,-1)),t[19]||(t[19]=e("span",{class:"sh-type"},"Tipo",-1)),t[20]||(t[20]=e("span",{class:"sh-num"},"#",-1)),t[21]||(t[21]=e("span",{class:"sh-laps"},"Giri",-1)),t[22]||(t[22]=e("span",{class:"sh-delta"},"Œî Theo",-1))],2),xt.value?(i(),r("div",Te," 1 stint in sessione ¬∑ Nessun confronto interno disponibile ")):h("",!0),e("div",Se,[(i(!0),r(x,null,it(m.value.stints,a=>(i(),r("button",{key:a.number,class:S(["stint-item",{"stint-item--compare":R.value,selected:!R.value&&B.value===a.number,"compare-selected":R.value&&_.value.includes(a.number),"compare-a":R.value&&_.value[0]===a.number,"compare-b":R.value&&_.value[1]===a.number,"best-stint":at(a)}]),onClick:o=>At(a.number)},[R.value?(i(),r("span",Le,[_.value.includes(a.number)?(i(),r("span",Ae,l(_.value[0]===a.number?"A":"B"),1)):(i(),r("span",Re))])):h("",!0),e("span",{class:"stint-best-icon",title:W(a)?.message},[at(a)?(i(),r(x,{key:0},[A("üèÜ")],64)):W(a)?(i(),r(x,{key:1},[A(l(W(a)?.icon),1)],64)):h("",!0)],8,we),e("span",{class:S(["stint-type",`stint-type--${a.type.toLowerCase()}`])},l(a.type),3),e("span",xe,"#"+l(a.number),1),e("span",$e,l(a.laps),1),e("span",{class:S(["stint-delta",`delta--${K(a.deltaVsTheo)}`])},[e("span",Be,l(a.deltaVsTheo),1),e("span",De,l(Mt(a.deltaVsTheo)),1)],2)],10,Ce))),128))])]),e("section",Qe,[$.value?(i(),r("div",Ge,[e("div",Ee,[t[24]||(t[24]=e("span",{class:"compare-label"},"Confronto Stint:",-1)),e("span",Me,"A: #"+l(M.value)+" "+l(st.value?.type),1),t[25]||(t[25]=e("span",{class:"compare-vs"},"vs",-1)),e("span",Fe,"B: #"+l(F.value)+" "+l(ct.value?.type),1)]),e("button",{class:"compare-close",onClick:wt},"‚úï Chiudi confronto")])):h("",!0),$.value?h("",!0):(i(),r("div",Ie,[e("span",{class:S(["stint-type-tag",`stint-type-tag--${p.value?.type?.toLowerCase()}`])},l(p.value?.type==="Q"?"QUALY":"RACE"),3),e("h3",Ne,"Stint #"+l(B.value)+" ¬∑ "+l(p.value?.intent??"Seleziona uno stint"),1),p.value&&at(p.value)?(i(),r("span",Oe,"üèÜ Best")):h("",!0)])),p.value&&W(p.value)?(i(),r("div",Ve,l(W(p.value)?.icon)+" "+l(W(p.value)?.message),1)):h("",!0),e("div",Pe,[e("div",We,[e("span",Ue,[t[26]||(t[26]=e("span",{class:"tc-cond-icon"},"‚òÄÔ∏è",-1)),e("span",ze,l(p.value?.conditions?.weather??"Dry"),1)]),e("span",Ze,[t[27]||(t[27]=e("span",{class:"tc-cond-lbl"},"Aria",-1)),e("span",He,l(m.value.startConditions.airTemp)+"¬∞",1)]),e("span",Ye,[t[28]||(t[28]=e("span",{class:"tc-cond-lbl"},"Asfalto",-1)),e("span",qe,l(p.value?.conditions?.avgTrackTemp??"-")+"¬∞",1)]),e("span",je,[t[29]||(t[29]=e("span",{class:"tc-cond-lbl"},"Grip",-1)),e("span",Ke,l(C.value[0]?.grip??"Opt"),1)])]),e("div",Je,[e("div",Xe,[e("h5",ts,[t[39]||(t[39]=A(" TEMPI STINT ",-1)),e("span",{class:"info-icon",onClick:t[3]||(t[3]=a=>P.value=!P.value)},[...t[30]||(t[30]=[e("svg",{width:"14",height:"14",viewBox:"0 0 512 512"},[e("circle",{cx:"256",cy:"256",r:"256",fill:"currentColor"}),e("text",{x:"256",y:"380","text-anchor":"middle","font-size":"340","font-weight":"700","font-family":"Arial",fill:"#1a1a2e"},"i")],-1)])]),P.value?(i(),r("div",es,[t[31]||(t[31]=e("strong",null,"Tempi Stint",-1)),t[32]||(t[32]=e("br",null,null,-1)),t[33]||(t[33]=e("b",null,"BEST:",-1)),t[34]||(t[34]=A(" Giro pi√π veloce tra i giri validi dello stint.",-1)),t[35]||(t[35]=e("br",null,null,-1)),t[36]||(t[36]=e("b",null,"AVG:",-1)),t[37]||(t[37]=A(' Media dei giri "puliti" (validi, no pit, no outlap, entro 115% del best).',-1)),t[38]||(t[38]=e("br",null,null,-1)),e("span",{class:"info-close",onClick:t[4]||(t[4]=ht(a=>P.value=!1,["stop"]))},"‚úï")])):h("",!0)]),e("div",ss,[t[40]||(t[40]=e("span",{class:"tc-label"},"BEST:",-1)),e("span",as,l(p.value?.best??"-"),1)]),e("div",ls,[t[41]||(t[41]=e("span",{class:"tc-label"},"AVG:",-1)),e("span",ns,l(p.value?.avg??"-"),1)])]),t[53]||(t[53]=e("div",{class:"tc-divider"},null,-1)),e("div",os,[e("h5",is,[A(" TEORICI ("+l(O.value.sessionGrip||"Optimum")+") ",1),e("span",{class:"info-icon",onClick:t[5]||(t[5]=a=>Z.value=!Z.value)},[...t[42]||(t[42]=[e("svg",{width:"14",height:"14",viewBox:"0 0 512 512"},[e("circle",{cx:"256",cy:"256",r:"256",fill:"currentColor"}),e("text",{x:"256",y:"380","text-anchor":"middle","font-size":"340","font-weight":"700","font-family":"Arial",fill:"#1a1a2e"},"i")],-1)])]),Z.value?(i(),r("div",rs,[t[43]||(t[43]=e("strong",null,"Tempi Teorici",-1)),t[44]||(t[44]=e("br",null,null,-1)),t[45]||(t[45]=A(" Best storico per questo grip + aggiustamento temperatura:",-1)),t[46]||(t[46]=e("br",null,null,-1)),t[47]||(t[47]=e("code",null,"Teorico = Storico + (TempSessione - TempStorico) √ó 0.1s/¬∞C",-1)),t[48]||(t[48]=e("br",null,null,-1)),e("span",{class:"info-close",onClick:t[6]||(t[6]=ht(a=>Z.value=!1,["stop"]))},"‚úï")])):h("",!0)]),p.value?.type==="Q"?(i(),r("div",us,[t[49]||(t[49]=e("span",{class:"tc-label"},"THEO BEST Q:",-1)),e("span",cs,l(O.value.theoQualy?U(w)(O.value.theoQualy):"‚Äî:‚Äî.---"),1)])):(i(),r(x,{key:1},[e("div",ds,[t[50]||(t[50]=e("span",{class:"tc-label"},"THEO BEST R:",-1)),e("span",ps,l(O.value.theoRace?U(w)(O.value.theoRace):"‚Äî:‚Äî.---"),1)]),e("div",vs,[t[51]||(t[51]=e("span",{class:"tc-label"},"THEO AVG:",-1)),e("span",ms,l(O.value.theoAvgRace?U(w)(O.value.theoAvgRace):"‚Äî:‚Äî.---"),1)])],64))]),t[54]||(t[54]=e("div",{class:"tc-divider"},null,-1)),e("div",bs,[t[52]||(t[52]=e("h5",{class:"tc-header"},"DELTA",-1)),e("div",gs,[e("span",{class:S(["tc-delta-inline",pt.value.class])},l(pt.value.value),3)]),e("div",fs,[e("span",{class:S(["tc-delta-inline",vt.value.class])},l(vt.value.value),3)])])]),e("div",hs,[t[55]||(t[55]=e("span",{class:"tc-duration-label"},"DURATA STINT:",-1)),e("span",_s,l(mt.value.minutes),1),t[56]||(t[56]=e("span",{class:"tc-duration-unit"},"min",-1)),e("span",ys,l(mt.value.seconds.toString().padStart(2,"0")),1),t[57]||(t[57]=e("span",{class:"tc-duration-unit"},"sec",-1))]),p.value?.type==="R"&&q.value.total>0?(i(),r("div",ks,[t[63]||(t[63]=e("span",{class:"tc-cons-title"},"COSTANZA",-1)),e("div",Ts,[e("span",Ss,l(q.value.onTarget)+"/"+l(q.value.total),1),t[58]||(t[58]=e("span",{class:"tc-cons-desc"},"giri sotto target (theo +0.3s)",-1)),e("div",Cs,[e("div",{class:"tc-cons-fill tc-cons-fill--target",style:rt({width:q.value.pct+"%"})},null,4)]),e("span",Ls,l(q.value.pct)+"%",1)]),e("div",As,[e("label",Rs,[_t(e("input",{type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=a=>G.value=a)},null,512),[[yt,G.value]]),t[59]||(t[59]=e("span",{class:"tc-toggle-slider"},null,-1)),t[60]||(t[60]=e("span",{class:"tc-toggle-label"},"Target",-1))]),nt.value?(i(),r("label",ws,[_t(e("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=a=>J.value=a)},null,512),[[yt,J.value]]),t[61]||(t[61]=e("span",{class:"tc-toggle-slider"},null,-1)),t[62]||(t[62]=e("span",{class:"tc-toggle-label"},"Grip",-1))])):h("",!0)])])):h("",!0),I.value.total>0?(i(),r("div",xs,[t[66]||(t[66]=e("span",{class:"tc-cons-title"},"VALIDIT√Ä",-1)),e("div",$s,[e("span",Bs,l(I.value.valid)+"/"+l(I.value.total),1),t[64]||(t[64]=e("span",{class:"tc-cons-desc"},"giri validi",-1)),e("div",Ds,[e("div",{class:"tc-cons-fill tc-cons-fill--validity",style:rt({width:I.value.pct+"%"})},null,4)]),e("span",{class:S(["tc-cons-pct",I.value.pct<100?"tc-cons-pct--warning":""])},l(I.value.pct)+"%",3)]),I.value.invalid>0?(i(),r("span",Qs,[t[65]||(t[65]=e("span",{class:"tc-invalid-dot"},null,-1)),A(" "+l(I.value.invalid)+" invalidi ",1)])):h("",!0)])):h("",!0)]),e("div",Gs,[e("h4",Es,[$.value?(i(),r(x,{key:0},[A("Confronto Tempi ‚Äî A: Stint #"+l(M.value)+" vs B: Stint #"+l(F.value),1)],64)):(i(),r(x,{key:1},[A("Tempi Giro ‚Äî Stint "+l(B.value),1)],64))]),e("div",Ms,[qt(U(re),{data:Qt.value,options:Gt},null,8,["data"])]),nt.value&&J.value?(i(),r("div",Fs,[t[67]||(t[67]=e("span",{class:"grip-legend-title"},"Grip:",-1)),(i(!0),r(x,null,it(bt.value,a=>(i(),r("div",{key:`${a.gripLevel}-${a.startLap}`,class:"grip-legend-item"},[e("span",{class:"grip-legend-dot",style:rt({backgroundColor:X[a.gripLevel]?.border||"#fff"})},null,4),e("span",Is,l(X[a.gripLevel]?.label||a.gripLevel),1),e("span",Ns,"(G"+l(a.startLap)+"-G"+l(a.endLap)+")",1)]))),128))])):h("",!0)]),e("div",Os,[e("div",Vs,[$.value?(i(),r("div",Ps,[e("button",{class:S(["lap-tab",{"lap-tab--active":N.value==="A"}]),onClick:t[9]||(t[9]=a=>N.value="A")}," A: Stint #"+l(M.value),3),e("button",{class:S(["lap-tab",{"lap-tab--active":N.value==="B"}]),onClick:t[10]||(t[10]=a=>N.value="B")}," B: Stint #"+l(F.value),3)])):(i(),r("h4",Ws,"Tabella Giri ‚Äî Stint "+l(B.value),1)),e("button",{class:"toggle-btn",onClick:t[11]||(t[11]=a=>E.value=!E.value)},l(E.value?"Vista semplice":"Dettagli"),1)]),e("div",Us,[e("table",zs,[e("thead",null,[e("tr",null,[t[74]||(t[74]=e("th",null,"Giro",-1)),t[75]||(t[75]=e("th",null,"Tempo",-1)),t[76]||(t[76]=e("th",null,"Œî Teorico",-1)),t[77]||(t[77]=e("th",null,"Stato",-1)),E.value?(i(),r(x,{key:0},[t[68]||(t[68]=e("th",null,"S1",-1)),t[69]||(t[69]=e("th",null,"S2",-1)),t[70]||(t[70]=e("th",null,"S3",-1)),t[71]||(t[71]=e("th",null,"Fuel",-1)),t[72]||(t[72]=e("th",null,"Track¬∞",-1)),t[73]||(t[73]=e("th",null,"Grip",-1))],64)):h("",!0)])]),e("tbody",null,[(i(!0),r(x,null,it($.value?$t.value:C.value,a=>(i(),r("tr",{key:a.lap,class:S({invalid:!a.valid,pit:a.pit})},[e("td",null,l(a.lap),1),e("td",Zs,l(a.time),1),e("td",{class:S(["delta",`delta--${K(a.delta)}`])},l(a.delta),3),e("td",Hs,l(a.pit?"PIT":a.valid?"‚úì":"INV"),1),E.value?(i(),r(x,{key:0},[e("td",null,l(a.sectors[0]),1),e("td",null,l(a.sectors[1]),1),e("td",null,l(a.sectors[2]),1),e("td",null,l(a.fuel)+"L",1),e("td",null,l(a.trackTemp)+"¬∞",1),e("td",null,l(a.grip),1)],64)):h("",!0)],2))),128))])])])])])])],64))]),_:1})}}}),qs=Object.assign(jt(Ys,[["__scopeId","data-v-b89c60da"]]),{__name:"PagesSessionDetailPage"}),ea=kt({__name:"[id]",setup(ut){const tt=Kt(),z=c(()=>tt.params.id);return(V,E)=>{const P=qs;return i(),Tt(P,{"session-id":U(z),onBack:E[0]||(E[0]=Z=>("navigateTo"in V?V.navigateTo:U(Jt))("/sessioni"))},null,8,["session-id"])}}});export{ea as default};
