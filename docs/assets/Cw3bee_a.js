import{b as Ke,r as ct,o as Nn,aa as os,E as C,F as S,G as r,I as ne,af as hn,a0 as nt,M as kt,J as se,O as q,a8 as is,H as T,ag as as,_ as Ln,t as N,w as vn,L as Dn,K as w,P as ft,Q as ke,Z as ge,a1 as mn,ah as gn,$ as rs,n as bn}from"./Bf400IeT.js";import{u as ls,f as St,a as us,c as cs,d as ds,g as ps,_ as fs}from"./BlpzeAZo.js";import{f as Gt,g as G,h as Je,v as Re,j as Tn,s as yn,_ as hs,C as vs,a as ms,L as gs,P as bs,b as Ts,p as ys,c as _s,d as Es,i as Ss,e as xs}from"./Bdj_a-RS.js";const Cs=["width","height"],Is=Ke({__name:"InfoPopup",props:{title:{},position:{default:"left"},size:{default:"normal"}},setup(t){const s=ct(!1),o=ct(null),u=l=>{o.value&&!o.value.contains(l.target)&&(s.value=!1)};return Nn(()=>{document.addEventListener("click",u)}),os(()=>{document.removeEventListener("click",u)}),(l,c)=>(S(),C("span",{ref_key:"popupRef",ref:o,class:"info-popup-wrapper"},[r("span",{class:nt(["info-icon",{"info-icon--small":t.size==="small"}]),onClick:c[0]||(c[0]=hn(h=>s.value=!kt(s),["stop"]))},[(S(),C("svg",{width:t.size==="small"?12:14,height:t.size==="small"?12:14,viewBox:"0 0 512 512"},[...c[2]||(c[2]=[r("circle",{cx:"256",cy:"256",r:"256",fill:"currentColor"},null,-1),r("text",{x:"256",y:"380","text-anchor":"middle","font-size":"340","font-weight":"700","font-family":"Arial",fill:"#1a1a2e"},"i",-1)])],8,Cs))],2),ne(as,{name:"popup-fade"},{default:se(()=>[kt(s)?(S(),C("div",{key:0,class:nt(["info-popup",{"info-popup-right":t.position==="right"}])},[r("strong",null,T(t.title),1),c[3]||(c[3]=r("br",null,null,-1)),is(l.$slots,"default",{},void 0,!0),r("span",{class:"info-close",onClick:c[1]||(c[1]=hn(h=>s.value=!1,["stop"]))},"✕")],2)):q("",!0)]),_:3})],512))}}),Ps=Object.assign(Ln(Is,[["__scopeId","data-v-6594129b"]]),{__name:"UiInfoPopup"});function Ms(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Qe={exports:{}};var _n;function Os(){return _n||(_n=1,(function(t){(function(s,o,u,l){var c=["","webkit","Moz","MS","ms","o"],h=o.createElement("div"),g="function",_=Math.round,E=Math.abs,I=Date.now;function D(e,n,a){return setTimeout(st(e,a),n)}function L(e,n,a){return Array.isArray(e)?(z(e,a[n],a),!0):!1}function z(e,n,a){var d;if(e)if(e.forEach)e.forEach(n,a);else if(e.length!==l)for(d=0;d<e.length;)n.call(a,e[d],d,e),d++;else for(d in e)e.hasOwnProperty(d)&&n.call(a,e[d],d,e)}function Lt(e,n,a){var d="DEPRECATED METHOD: "+n+`
`+a+` AT 
`;return function(){var v=new Error("get-stack-trace"),b=v&&v.stack?v.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",M=s.console&&(s.console.warn||s.console.log);return M&&M.call(s.console,d,b),e.apply(this,arguments)}}var J;typeof Object.assign!="function"?J=function(n){if(n===l||n===null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(n),d=1;d<arguments.length;d++){var v=arguments[d];if(v!==l&&v!==null)for(var b in v)v.hasOwnProperty(b)&&(a[b]=v[b])}return a}:J=Object.assign;var Dt=Lt(function(n,a,d){for(var v=Object.keys(a),b=0;b<v.length;)(!d||d&&n[v[b]]===l)&&(n[v[b]]=a[v[b]]),b++;return n},"extend","Use `assign`."),ie=Lt(function(n,a){return Dt(n,a,!0)},"merge","Use `assign`.");function Y(e,n,a){var d=n.prototype,v;v=e.prototype=Object.create(d),v.constructor=e,v._super=d,a&&J(v,a)}function st(e,n){return function(){return e.apply(n,arguments)}}function j(e,n){return typeof e==g?e.apply(n&&n[0]||l,n):e}function xt(e,n){return e===l?n:e}function ot(e,n,a){z(Wt(n),function(d){e.addEventListener(d,a,!1)})}function vt(e,n,a){z(Wt(n),function(d){e.removeEventListener(d,a,!1)})}function yt(e,n){for(;e;){if(e==n)return!0;e=e.parentNode}return!1}function At(e,n){return e.indexOf(n)>-1}function Wt(e){return e.trim().split(/\s+/g)}function zt(e,n,a){if(e.indexOf&&!a)return e.indexOf(n);for(var d=0;d<e.length;){if(a&&e[d][a]==n||!a&&e[d]===n)return d;d++}return-1}function F(e){return Array.prototype.slice.call(e,0)}function X(e,n,a){for(var d=[],v=[],b=0;b<e.length;){var M=e[b][n];zt(v,M)<0&&d.push(e[b]),v[b]=M,b++}return d=d.sort(function(K,ut){return K[n]>ut[n]}),d}function it(e,n){for(var a,d,v=n[0].toUpperCase()+n.slice(1),b=0;b<c.length;){if(a=c[b],d=a?a+v:n,d in e)return d;b++}return l}var R=1;function at(){return R++}function _e(e){var n=e.ownerDocument||e;return n.defaultView||n.parentWindow||s}var ae=/mobile|tablet|ip(ad|hone|od)|android/i,re="ontouchstart"in s,Ee=it(s,"PointerEvent")!==l,qt=re&&ae.test(navigator.userAgent),Qt="touch",we="pen",le="mouse",ue="kinect",Ft=25,Q=1,$=2,B=4,tt=8,rt=1,Rt=2,Yt=4,Ct=8,Zt=16,dt=Rt|Yt,It=Ct|Zt,ce=dt|It,Ut=["x","y"],bt=["clientX","clientY"];function pt(e,n){var a=this;this.manager=e,this.callback=n,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(d){j(e.options.enable,[e])&&a.handler(d)},this.init()}pt.prototype={handler:function(){},init:function(){this.evEl&&ot(this.element,this.evEl,this.domHandler),this.evTarget&&ot(this.target,this.evTarget,this.domHandler),this.evWin&&ot(_e(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&vt(this.element,this.evEl,this.domHandler),this.evTarget&&vt(this.target,this.evTarget,this.domHandler),this.evWin&&vt(_e(this.element),this.evWin,this.domHandler)}};function _t(e){var n,a=e.options.inputClass;return a?n=a:Ee?n=et:qt?n=te:re?n=De:n=Z,new n(e,jt)}function jt(e,n,a){var d=a.pointers.length,v=a.changedPointers.length,b=n&Q&&d-v===0,M=n&(B|tt)&&d-v===0;a.isFirst=!!b,a.isFinal=!!M,b&&(e.session={}),a.eventType=n,Kt(e,a),e.emit("hammer.input",a),e.recognize(a),e.session.prevInput=a}function Kt(e,n){var a=e.session,d=n.pointers,v=d.length;a.firstInput||(a.firstInput=p(n)),v>1&&!a.firstMultiple?a.firstMultiple=p(n):v===1&&(a.firstMultiple=!1);var b=a.firstInput,M=a.firstMultiple,W=M?M.center:b.center,K=n.center=i(d);n.timeStamp=I(),n.deltaTime=n.timeStamp-b.timeStamp,n.angle=x(W,K),n.distance=f(W,K),de(a,n),n.offsetDirection=y(n.deltaX,n.deltaY);var ut=m(n.deltaTime,n.deltaX,n.deltaY);n.overallVelocityX=ut.x,n.overallVelocityY=ut.y,n.overallVelocity=E(ut.x)>E(ut.y)?ut.x:ut.y,n.scale=M?H(M.pointers,d):1,n.rotation=M?k(M.pointers,d):0,n.maxPointers=a.prevInput?n.pointers.length>a.prevInput.maxPointers?n.pointers.length:a.prevInput.maxPointers:n.pointers.length,Se(a,n);var Ot=e.element;yt(n.srcEvent.target,Ot)&&(Ot=n.srcEvent.target),n.target=Ot}function de(e,n){var a=n.center,d=e.offsetDelta||{},v=e.prevDelta||{},b=e.prevInput||{};(n.eventType===Q||b.eventType===B)&&(v=e.prevDelta={x:b.deltaX||0,y:b.deltaY||0},d=e.offsetDelta={x:a.x,y:a.y}),n.deltaX=v.x+(a.x-d.x),n.deltaY=v.y+(a.y-d.y)}function Se(e,n){var a=e.lastInterval||n,d=n.timeStamp-a.timeStamp,v,b,M,W;if(n.eventType!=tt&&(d>Ft||a.velocity===l)){var K=n.deltaX-a.deltaX,ut=n.deltaY-a.deltaY,Ot=m(d,K,ut);b=Ot.x,M=Ot.y,v=E(Ot.x)>E(Ot.y)?Ot.x:Ot.y,W=y(K,ut),e.lastInterval=n}else v=a.velocity,b=a.velocityX,M=a.velocityY,W=a.direction;n.velocity=v,n.velocityX=b,n.velocityY=M,n.direction=W}function p(e){for(var n=[],a=0;a<e.pointers.length;)n[a]={clientX:_(e.pointers[a].clientX),clientY:_(e.pointers[a].clientY)},a++;return{timeStamp:I(),pointers:n,center:i(n),deltaX:e.deltaX,deltaY:e.deltaY}}function i(e){var n=e.length;if(n===1)return{x:_(e[0].clientX),y:_(e[0].clientY)};for(var a=0,d=0,v=0;v<n;)a+=e[v].clientX,d+=e[v].clientY,v++;return{x:_(a/n),y:_(d/n)}}function m(e,n,a){return{x:n/e||0,y:a/e||0}}function y(e,n){return e===n?rt:E(e)>=E(n)?e<0?Rt:Yt:n<0?Ct:Zt}function f(e,n,a){a||(a=Ut);var d=n[a[0]]-e[a[0]],v=n[a[1]]-e[a[1]];return Math.sqrt(d*d+v*v)}function x(e,n,a){a||(a=Ut);var d=n[a[0]]-e[a[0]],v=n[a[1]]-e[a[1]];return Math.atan2(v,d)*180/Math.PI}function k(e,n){return x(n[1],n[0],bt)+x(e[1],e[0],bt)}function H(e,n){return f(n[0],n[1],bt)/f(e[0],e[1],bt)}var O={mousedown:Q,mousemove:$,mouseup:B},A="mousedown",U="mousemove mouseup";function Z(){this.evEl=A,this.evWin=U,this.pressed=!1,pt.apply(this,arguments)}Y(Z,pt,{handler:function(n){var a=O[n.type];a&Q&&n.button===0&&(this.pressed=!0),a&$&&n.which!==1&&(a=B),this.pressed&&(a&B&&(this.pressed=!1),this.callback(this.manager,a,{pointers:[n],changedPointers:[n],pointerType:le,srcEvent:n}))}});var mt={pointerdown:Q,pointermove:$,pointerup:B,pointercancel:tt,pointerout:tt},Jt={2:Qt,3:we,4:le,5:ue},Pt="pointerdown",pe="pointermove pointerup pointercancel";s.MSPointerEvent&&!s.PointerEvent&&(Pt="MSPointerDown",pe="MSPointerMove MSPointerUp MSPointerCancel");function et(){this.evEl=Pt,this.evWin=pe,pt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}Y(et,pt,{handler:function(n){var a=this.store,d=!1,v=n.type.toLowerCase().replace("ms",""),b=mt[v],M=Jt[n.pointerType]||n.pointerType,W=M==Qt,K=zt(a,n.pointerId,"pointerId");b&Q&&(n.button===0||W)?K<0&&(a.push(n),K=a.length-1):b&(B|tt)&&(d=!0),!(K<0)&&(a[K]=n,this.callback(this.manager,b,{pointers:a,changedPointers:[n],pointerType:M,srcEvent:n}),d&&a.splice(K,1))}});var gt={touchstart:Q,touchmove:$,touchend:B,touchcancel:tt},P="touchstart",lt="touchstart touchmove touchend touchcancel";function fe(){this.evTarget=P,this.evWin=lt,this.started=!1,pt.apply(this,arguments)}Y(fe,pt,{handler:function(n){var a=gt[n.type];if(a===Q&&(this.started=!0),!!this.started){var d=Ne.call(this,n,a);a&(B|tt)&&d[0].length-d[1].length===0&&(this.started=!1),this.callback(this.manager,a,{pointers:d[0],changedPointers:d[1],pointerType:Qt,srcEvent:n})}}});function Ne(e,n){var a=F(e.touches),d=F(e.changedTouches);return n&(B|tt)&&(a=X(a.concat(d),"identifier")),[a,d]}var Le={touchstart:Q,touchmove:$,touchend:B,touchcancel:tt},nn="touchstart touchmove touchend touchcancel";function te(){this.evTarget=nn,this.targetIds={},pt.apply(this,arguments)}Y(te,pt,{handler:function(n){var a=Le[n.type],d=xe.call(this,n,a);d&&this.callback(this.manager,a,{pointers:d[0],changedPointers:d[1],pointerType:Qt,srcEvent:n})}});function xe(e,n){var a=F(e.touches),d=this.targetIds;if(n&(Q|$)&&a.length===1)return d[a[0].identifier]=!0,[a,a];var v,b,M=F(e.changedTouches),W=[],K=this.target;if(b=a.filter(function(ut){return yt(ut.target,K)}),n===Q)for(v=0;v<b.length;)d[b[v].identifier]=!0,v++;for(v=0;v<M.length;)d[M[v].identifier]&&W.push(M[v]),n&(B|tt)&&delete d[M[v].identifier],v++;if(W.length)return[X(b.concat(W),"identifier"),W]}var qn=2500,sn=25;function De(){pt.apply(this,arguments);var e=st(this.handler,this);this.touch=new te(this.manager,e),this.mouse=new Z(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}Y(De,pt,{handler:function(n,a,d){var v=d.pointerType==Qt,b=d.pointerType==le;if(!(b&&d.sourceCapabilities&&d.sourceCapabilities.firesTouchEvents)){if(v)jn.call(this,a,d);else if(b&&Kn.call(this,d))return;this.callback(n,a,d)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function jn(e,n){e&Q?(this.primaryTouch=n.changedPointers[0].identifier,on.call(this,n)):e&(B|tt)&&on.call(this,n)}function on(e){var n=e.changedPointers[0];if(n.identifier===this.primaryTouch){var a={x:n.clientX,y:n.clientY};this.lastTouches.push(a);var d=this.lastTouches,v=function(){var b=d.indexOf(a);b>-1&&d.splice(b,1)};setTimeout(v,qn)}}function Kn(e){for(var n=e.srcEvent.clientX,a=e.srcEvent.clientY,d=0;d<this.lastTouches.length;d++){var v=this.lastTouches[d],b=Math.abs(n-v.x),M=Math.abs(a-v.y);if(b<=sn&&M<=sn)return!0}return!1}var an=it(h.style,"touchAction"),rn=an!==l,ln="compute",un="auto",ze="manipulation",Xt="none",he="pan-x",ve="pan-y",Ce=ts();function Fe(e,n){this.manager=e,this.set(n)}Fe.prototype={set:function(e){e==ln&&(e=this.compute()),rn&&this.manager.element.style&&Ce[e]&&(this.manager.element.style[an]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return z(this.manager.recognizers,function(n){j(n.options.enable,[n])&&(e=e.concat(n.getTouchAction()))}),Jn(e.join(" "))},preventDefaults:function(e){var n=e.srcEvent,a=e.offsetDirection;if(this.manager.session.prevented){n.preventDefault();return}var d=this.actions,v=At(d,Xt)&&!Ce[Xt],b=At(d,ve)&&!Ce[ve],M=At(d,he)&&!Ce[he];if(v){var W=e.pointers.length===1,K=e.distance<2,ut=e.deltaTime<250;if(W&&K&&ut)return}if(!(M&&b)&&(v||b&&a&dt||M&&a&It))return this.preventSrc(n)},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};function Jn(e){if(At(e,Xt))return Xt;var n=At(e,he),a=At(e,ve);return n&&a?Xt:n||a?n?he:ve:At(e,ze)?ze:un}function ts(){if(!rn)return!1;var e={},n=s.CSS&&s.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(a){e[a]=n?s.CSS.supports("touch-action",a):!0}),e}var Ie=1,Tt=2,ee=4,Vt=8,wt=Vt,me=16,Mt=32;function Nt(e){this.options=J({},this.defaults,e||{}),this.id=at(),this.manager=null,this.options.enable=xt(this.options.enable,!0),this.state=Ie,this.simultaneous={},this.requireFail=[]}Nt.prototype={defaults:{},set:function(e){return J(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(L(e,"recognizeWith",this))return this;var n=this.simultaneous;return e=Pe(e,this),n[e.id]||(n[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return L(e,"dropRecognizeWith",this)?this:(e=Pe(e,this),delete this.simultaneous[e.id],this)},requireFailure:function(e){if(L(e,"requireFailure",this))return this;var n=this.requireFail;return e=Pe(e,this),zt(n,e)===-1&&(n.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(L(e,"dropRequireFailure",this))return this;e=Pe(e,this);var n=zt(this.requireFail,e);return n>-1&&this.requireFail.splice(n,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var n=this,a=this.state;function d(v){n.manager.emit(v,e)}a<Vt&&d(n.options.event+cn(a)),d(n.options.event),e.additionalEvent&&d(e.additionalEvent),a>=Vt&&d(n.options.event+cn(a))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Mt},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Mt|Ie)))return!1;e++}return!0},recognize:function(e){var n=J({},e);if(!j(this.options.enable,[this,n])){this.reset(),this.state=Mt;return}this.state&(wt|me|Mt)&&(this.state=Ie),this.state=this.process(n),this.state&(Tt|ee|Vt|me)&&this.tryEmit(n)},process:function(e){},getTouchAction:function(){},reset:function(){}};function cn(e){return e&me?"cancel":e&Vt?"end":e&ee?"move":e&Tt?"start":""}function dn(e){return e==Zt?"down":e==Ct?"up":e==Rt?"left":e==Yt?"right":""}function Pe(e,n){var a=n.manager;return a?a.get(e):e}function Et(){Nt.apply(this,arguments)}Y(Et,Nt,{defaults:{pointers:1},attrTest:function(e){var n=this.options.pointers;return n===0||e.pointers.length===n},process:function(e){var n=this.state,a=e.eventType,d=n&(Tt|ee),v=this.attrTest(e);return d&&(a&tt||!v)?n|me:d||v?a&B?n|Vt:n&Tt?n|ee:Tt:Mt}});function Me(){Et.apply(this,arguments),this.pX=null,this.pY=null}Y(Me,Et,{defaults:{event:"pan",threshold:10,pointers:1,direction:ce},getTouchAction:function(){var e=this.options.direction,n=[];return e&dt&&n.push(ve),e&It&&n.push(he),n},directionTest:function(e){var n=this.options,a=!0,d=e.distance,v=e.direction,b=e.deltaX,M=e.deltaY;return v&n.direction||(n.direction&dt?(v=b===0?rt:b<0?Rt:Yt,a=b!=this.pX,d=Math.abs(e.deltaX)):(v=M===0?rt:M<0?Ct:Zt,a=M!=this.pY,d=Math.abs(e.deltaY))),e.direction=v,a&&d>n.threshold&&v&n.direction},attrTest:function(e){return Et.prototype.attrTest.call(this,e)&&(this.state&Tt||!(this.state&Tt)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var n=dn(e.direction);n&&(e.additionalEvent=this.options.event+n),this._super.emit.call(this,e)}});function Ue(){Et.apply(this,arguments)}Y(Ue,Et,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Xt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||this.state&Tt)},emit:function(e){if(e.scale!==1){var n=e.scale<1?"in":"out";e.additionalEvent=this.options.event+n}this._super.emit.call(this,e)}});function Ve(){Nt.apply(this,arguments),this._timer=null,this._input=null}Y(Ve,Nt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[un]},process:function(e){var n=this.options,a=e.pointers.length===n.pointers,d=e.distance<n.threshold,v=e.deltaTime>n.time;if(this._input=e,!d||!a||e.eventType&(B|tt)&&!v)this.reset();else if(e.eventType&Q)this.reset(),this._timer=D(function(){this.state=wt,this.tryEmit()},n.time,this);else if(e.eventType&B)return wt;return Mt},reset:function(){clearTimeout(this._timer)},emit:function(e){this.state===wt&&(e&&e.eventType&B?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=I(),this.manager.emit(this.options.event,this._input)))}});function Be(){Et.apply(this,arguments)}Y(Be,Et,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Xt]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||this.state&Tt)}});function He(){Et.apply(this,arguments)}Y(He,Et,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:dt|It,pointers:1},getTouchAction:function(){return Me.prototype.getTouchAction.call(this)},attrTest:function(e){var n=this.options.direction,a;return n&(dt|It)?a=e.overallVelocity:n&dt?a=e.overallVelocityX:n&It&&(a=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&E(a)>this.options.velocity&&e.eventType&B},emit:function(e){var n=dn(e.offsetDirection);n&&this.manager.emit(this.options.event+n,e),this.manager.emit(this.options.event,e)}});function Oe(){Nt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}Y(Oe,Nt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ze]},process:function(e){var n=this.options,a=e.pointers.length===n.pointers,d=e.distance<n.threshold,v=e.deltaTime<n.time;if(this.reset(),e.eventType&Q&&this.count===0)return this.failTimeout();if(d&&v&&a){if(e.eventType!=B)return this.failTimeout();var b=this.pTime?e.timeStamp-this.pTime<n.interval:!0,M=!this.pCenter||f(this.pCenter,e.center)<n.posThreshold;this.pTime=e.timeStamp,this.pCenter=e.center,!M||!b?this.count=1:this.count+=1,this._input=e;var W=this.count%n.taps;if(W===0)return this.hasRequireFailures()?(this._timer=D(function(){this.state=wt,this.tryEmit()},n.interval,this),Tt):wt}return Mt},failTimeout:function(){return this._timer=D(function(){this.state=Mt},this.options.interval,this),Mt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==wt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Bt(e,n){return n=n||{},n.recognizers=xt(n.recognizers,Bt.defaults.preset),new Ge(e,n)}Bt.VERSION="2.0.7",Bt.defaults={domEvents:!1,touchAction:ln,enable:!0,inputTarget:null,inputClass:null,preset:[[Be,{enable:!1}],[Ue,{enable:!1},["rotate"]],[He,{direction:dt}],[Me,{direction:dt},["swipe"]],[Oe],[Oe,{event:"doubletap",taps:2},["tap"]],[Ve]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var es=1,pn=2;function Ge(e,n){this.options=J({},Bt.defaults,n||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=_t(this),this.touchAction=new Fe(this,this.options.touchAction),fn(this,!0),z(this.options.recognizers,function(a){var d=this.add(new a[0](a[1]));a[2]&&d.recognizeWith(a[2]),a[3]&&d.requireFailure(a[3])},this)}Ge.prototype={set:function(e){return J(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?pn:es},recognize:function(e){var n=this.session;if(!n.stopped){this.touchAction.preventDefaults(e);var a,d=this.recognizers,v=n.curRecognizer;(!v||v&&v.state&wt)&&(v=n.curRecognizer=null);for(var b=0;b<d.length;)a=d[b],n.stopped!==pn&&(!v||a==v||a.canRecognizeWith(v))?a.recognize(e):a.reset(),!v&&a.state&(Tt|ee|Vt)&&(v=n.curRecognizer=a),b++}},get:function(e){if(e instanceof Nt)return e;for(var n=this.recognizers,a=0;a<n.length;a++)if(n[a].options.event==e)return n[a];return null},add:function(e){if(L(e,"add",this))return this;var n=this.get(e.options.event);return n&&this.remove(n),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(L(e,"remove",this))return this;if(e=this.get(e),e){var n=this.recognizers,a=zt(n,e);a!==-1&&(n.splice(a,1),this.touchAction.update())}return this},on:function(e,n){if(e!==l&&n!==l){var a=this.handlers;return z(Wt(e),function(d){a[d]=a[d]||[],a[d].push(n)}),this}},off:function(e,n){if(e!==l){var a=this.handlers;return z(Wt(e),function(d){n?a[d]&&a[d].splice(zt(a[d],n),1):delete a[d]}),this}},emit:function(e,n){this.options.domEvents&&ns(e,n);var a=this.handlers[e]&&this.handlers[e].slice();if(!(!a||!a.length)){n.type=e,n.preventDefault=function(){n.srcEvent.preventDefault()};for(var d=0;d<a.length;)a[d](n),d++}},destroy:function(){this.element&&fn(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function fn(e,n){var a=e.element;if(a.style){var d;z(e.options.cssProps,function(v,b){d=it(a.style,b),n?(e.oldCssProps[d]=a.style[d],a.style[d]=v):a.style[d]=e.oldCssProps[d]||""}),n||(e.oldCssProps={})}}function ns(e,n){var a=o.createEvent("Event");a.initEvent(e,!0,!0),a.gesture=n,n.target.dispatchEvent(a)}J(Bt,{INPUT_START:Q,INPUT_MOVE:$,INPUT_END:B,INPUT_CANCEL:tt,STATE_POSSIBLE:Ie,STATE_BEGAN:Tt,STATE_CHANGED:ee,STATE_ENDED:Vt,STATE_RECOGNIZED:wt,STATE_CANCELLED:me,STATE_FAILED:Mt,DIRECTION_NONE:rt,DIRECTION_LEFT:Rt,DIRECTION_RIGHT:Yt,DIRECTION_UP:Ct,DIRECTION_DOWN:Zt,DIRECTION_HORIZONTAL:dt,DIRECTION_VERTICAL:It,DIRECTION_ALL:ce,Manager:Ge,Input:pt,TouchAction:Fe,TouchInput:te,MouseInput:Z,PointerEventInput:et,TouchMouseInput:De,SingleTouchInput:fe,Recognizer:Nt,AttrRecognizer:Et,Tap:Oe,Pan:Me,Swipe:He,Pinch:Ue,Rotate:Be,Press:Ve,on:ot,off:vt,each:z,merge:ie,extend:Dt,assign:J,inherit:Y,bindFn:st,prefixed:it});var ss=typeof s<"u"?s:typeof self<"u"?self:{};ss.Hammer=Bt,t.exports?t.exports=Bt:s[u]=Bt})(window,document,"Hammer")})(Qe)),Qe.exports}var ks=Os();const be=Ms(ks);const ye=t=>t&&t.enabled&&t.modifierKey,zn=(t,s)=>t&&s[t+"Key"],tn=(t,s)=>t&&!s[t+"Key"];function Ht(t,s,o){return t===void 0?!0:typeof t=="string"?t.indexOf(s)!==-1:typeof t=="function"?t({chart:o}).indexOf(s)!==-1:!1}function Ye(t,s){return typeof t=="function"&&(t=t({chart:s})),typeof t=="string"?{x:t.indexOf("x")!==-1,y:t.indexOf("y")!==-1}:{x:!1,y:!1}}function As(t,s){let o;return function(){return clearTimeout(o),o=setTimeout(t,s),s}}function Rs({x:t,y:s},o){const u=o.scales,l=Object.keys(u);for(let c=0;c<l.length;c++){const h=u[l[c]];if(s>=h.top&&s<=h.bottom&&t>=h.left&&t<=h.right)return h}return null}function Fn(t,s,o){const{mode:u="xy",scaleMode:l,overScaleMode:c}=t||{},h=Rs(s,o),g=Ye(u,o),_=Ye(l,o);if(c){const I=Ye(c,o);for(const D of["x","y"])I[D]&&(_[D]=g[D],g[D]=!1)}if(h&&_[h.axis])return[h];const E=[];return Gt(o.scales,function(I){g[I.axis]&&E.push(I)}),E}const Ze=new WeakMap;function V(t){let s=Ze.get(t);return s||(s={originalScaleLimits:{},updatedScaleLimits:{},handlers:{},panDelta:{},dragging:!1,panning:!1},Ze.set(t,s)),s}function ws(t){Ze.delete(t)}function Un(t,s,o,u){const l=Math.max(0,Math.min(1,(t-s)/o||0)),c=1-l;return{min:u*l,max:u*c}}function Vn(t,s){const o=t.isHorizontal()?s.x:s.y;return t.getValueForPixel(o)}function Bn(t,s,o){const u=t.max-t.min,l=u*(s-1),c=Vn(t,o);return Un(c,t.min,u,l)}function Ns(t,s,o){const u=Vn(t,o);if(u===void 0)return{min:t.min,max:t.max};const l=Math.log10(t.min),c=Math.log10(t.max),h=Math.log10(u),g=c-l,_=g*(s-1),E=Un(h,l,g,_);return{min:Math.pow(10,l+E.min),max:Math.pow(10,c-E.max)}}function Ls(t,s){return s&&(s[t.id]||s[t.axis])||{}}function En(t,s,o,u,l){let c=o[u];if(c==="original"){const h=t.originalScaleLimits[s.id][u];c=Re(h.options,h.scale)}return Re(c,l)}function Ds(t,s,o){const u=t.getValueForPixel(s),l=t.getValueForPixel(o);return{min:Math.min(u,l),max:Math.max(u,l)}}function zs(t,{min:s,max:o,minLimit:u,maxLimit:l},c){const h=(t-o+s)/2;s-=h,o+=h;const g=c.min.options??c.min.scale,_=c.max.options??c.max.scale,E=t/1e6;return Tn(s,g,E)&&(s=g),Tn(o,_,E)&&(o=_),s<u?(s=u,o=Math.min(u+t,l)):o>l&&(o=l,s=Math.max(l-t,u)),{min:s,max:o}}function $t(t,{min:s,max:o},u,l=!1){const c=V(t.chart),{options:h}=t,g=Ls(t,u),{minRange:_=0}=g,E=En(c,t,g,"min",-1/0),I=En(c,t,g,"max",1/0);if(l==="pan"&&(s<E||o>I))return!0;const D=t.max-t.min,L=l?Math.max(o-s,_):D;if(l&&L===_&&D<=_)return!0;const z=zs(L,{min:s,max:o,minLimit:E,maxLimit:I},c.originalScaleLimits[t.id]);return h.min=z.min,h.max=z.max,c.updatedScaleLimits[t.id]=z,t.parse(z.min)!==t.min||t.parse(z.max)!==t.max}function Fs(t,s,o,u){const l=Bn(t,s,o),c={min:t.min+l.min,max:t.max-l.max};return $t(t,c,u,!0)}function Us(t,s,o,u){const l=Ns(t,s,o);return $t(t,l,u,!0)}function Vs(t,s,o,u){$t(t,Ds(t,s,o),u,!0)}const Sn=t=>t===0||isNaN(t)?0:t<0?Math.min(Math.round(t),-1):Math.max(Math.round(t),1);function Bs(t){const o=t.getLabels().length-1;t.min>0&&(t.min-=1),t.max<o&&(t.max+=1)}function Hs(t,s,o,u){const l=Bn(t,s,o);t.min===t.max&&s<1&&Bs(t);const c={min:t.min+Sn(l.min),max:t.max-Sn(l.max)};return $t(t,c,u,!0)}function Gs(t){return t.isHorizontal()?t.width:t.height}function Qs(t,s,o){const l=t.getLabels().length-1;let{min:c,max:h}=t;const g=Math.max(h-c,1),_=Math.round(Gs(t)/Math.max(g,10)),E=Math.round(Math.abs(s/_));let I;return s<-_?(h=Math.min(h+E,l),c=g===1?h:h-g,I=h===l):s>_&&(c=Math.max(0,c-E),h=g===1?c:c+g,I=c===0),$t(t,{min:c,max:h},o)||I}const Ys={second:500,minute:30*1e3,hour:1800*1e3,day:720*60*1e3,week:3.5*24*60*60*1e3,month:360*60*60*1e3,quarter:1440*60*60*1e3,year:4368*60*60*1e3};function Hn(t,s,o,u=!1){const{min:l,max:c,options:h}=t,g=h.time&&h.time.round,_=Ys[g]||0,E=t.getValueForPixel(t.getPixelForValue(l+_)-s),I=t.getValueForPixel(t.getPixelForValue(c+_)-s);return isNaN(E)||isNaN(I)?!0:$t(t,{min:E,max:I},o,u?"pan":!1)}function xn(t,s,o){return Hn(t,s,o,!0)}const Xe={category:Hs,default:Fs,logarithmic:Us},$e={default:Vs},We={category:Qs,default:Hn,logarithmic:xn,timeseries:xn};function Zs(t,s,o){const{id:u,options:{min:l,max:c}}=t;if(!s[u]||!o[u])return!0;const h=o[u];return h.min!==l||h.max!==c}function Cn(t,s){Gt(t,(o,u)=>{s[u]||delete t[u]})}function oe(t,s){const{scales:o}=t,{originalScaleLimits:u,updatedScaleLimits:l}=s;return Gt(o,function(c){Zs(c,u,l)&&(u[c.id]={min:{scale:c.min,options:c.options.min},max:{scale:c.max,options:c.options.max}})}),Cn(u,o),Cn(l,o),u}function In(t,s,o,u){const l=Xe[t.type]||Xe.default;G(l,[t,s,o,u])}function Pn(t,s,o,u){const l=$e[t.type]||$e.default;G(l,[t,s,o,u])}function Xs(t){const s=t.chartArea;return{x:(s.left+s.right)/2,y:(s.top+s.bottom)/2}}function en(t,s,o="none",u="api"){const{x:l=1,y:c=1,focalPoint:h=Xs(t)}=typeof s=="number"?{x:s,y:s}:s,g=V(t),{options:{limits:_,zoom:E}}=g;oe(t,g);const I=l!==1,D=c!==1,L=Fn(E,h,t);Gt(L||t.scales,function(z){z.isHorizontal()&&I?In(z,l,h,_):!z.isHorizontal()&&D&&In(z,c,h,_)}),t.update(o),G(E.onZoom,[{chart:t,trigger:u}])}function Gn(t,s,o,u="none",l="api"){const c=V(t),{options:{limits:h,zoom:g}}=c,{mode:_="xy"}=g;oe(t,c);const E=Ht(_,"x",t),I=Ht(_,"y",t);Gt(t.scales,function(D){D.isHorizontal()&&E?Pn(D,s.x,o.x,h):!D.isHorizontal()&&I&&Pn(D,s.y,o.y,h)}),t.update(u),G(g.onZoom,[{chart:t,trigger:l}])}function $s(t,s,o,u="none",l="api"){const c=V(t);oe(t,c);const h=t.scales[s];$t(h,o,void 0,!0),t.update(u),G(c.options.zoom?.onZoom,[{chart:t,trigger:l}])}function Ws(t,s="default"){const o=V(t),u=oe(t,o);Gt(t.scales,function(l){const c=l.options;u[l.id]?(c.min=u[l.id].min.options,c.max=u[l.id].max.options):(delete c.min,delete c.max),delete o.updatedScaleLimits[l.id]}),t.update(s),G(o.options.zoom.onZoomComplete,[{chart:t}])}function qs(t,s){const o=t.originalScaleLimits[s];if(!o)return;const{min:u,max:l}=o;return Re(l.options,l.scale)-Re(u.options,u.scale)}function js(t){const s=V(t);let o=1,u=1;return Gt(t.scales,function(l){const c=qs(s,l.id);if(c){const h=Math.round(c/(l.max-l.min)*100)/100;o=Math.min(o,h),u=Math.max(u,h)}}),o<1?o:u}function Mn(t,s,o,u){const{panDelta:l}=u,c=l[t.id]||0;yn(c)===yn(s)&&(s+=c);const h=We[t.type]||We.default;G(h,[t,s,o])?l[t.id]=0:l[t.id]=s}function Qn(t,s,o,u="none"){const{x:l=0,y:c=0}=typeof s=="number"?{x:s,y:s}:s,h=V(t),{options:{pan:g,limits:_}}=h,{onPan:E}=g||{};oe(t,h);const I=l!==0,D=c!==0;Gt(o||t.scales,function(L){L.isHorizontal()&&I?Mn(L,l,_,h):!L.isHorizontal()&&D&&Mn(L,c,_,h)}),t.update(u),G(E,[{chart:t}])}function Yn(t){const s=V(t);oe(t,s);const o={};for(const u of Object.keys(t.scales)){const{min:l,max:c}=s.originalScaleLimits[u]||{min:{},max:{}};o[u]={min:l.scale,max:c.scale}}return o}function Ks(t){const s=V(t),o={};for(const u of Object.keys(t.scales))o[u]=s.updatedScaleLimits[u];return o}function Js(t){const s=Yn(t);for(const o of Object.keys(t.scales)){const{min:u,max:l}=s[o];if(u!==void 0&&t.scales[o].min!==u||l!==void 0&&t.scales[o].max!==l)return!0}return!1}function On(t){const s=V(t);return s.panning||s.dragging}const kn=(t,s,o)=>Math.min(o,Math.max(s,t));function ht(t,s){const{handlers:o}=V(t),u=o[s];u&&u.target&&(u.target.removeEventListener(s,u),delete o[s])}function Te(t,s,o,u){const{handlers:l,options:c}=V(t),h=l[o];if(h&&h.target===s)return;ht(t,o),l[o]=_=>u(t,_,c),l[o].target=s;const g=o==="wheel"?!1:void 0;s.addEventListener(o,l[o],{passive:g})}function to(t,s){const o=V(t);o.dragStart&&(o.dragging=!0,o.dragEnd=s,t.update("none"))}function eo(t,s){const o=V(t);!o.dragStart||s.key!=="Escape"||(ht(t,"keydown"),o.dragging=!1,o.dragStart=o.dragEnd=null,t.update("none"))}function qe(t,s){if(t.target!==s.canvas){const o=s.canvas.getBoundingClientRect();return{x:t.clientX-o.left,y:t.clientY-o.top}}return Je(t,s)}function Zn(t,s,o){const{onZoomStart:u,onZoomRejected:l}=o;if(u){const c=qe(s,t);if(G(u,[{chart:t,event:s,point:c}])===!1)return G(l,[{chart:t,event:s}]),!1}}function no(t,s){if(t.legend){const c=Je(s,t);if(hs(c,t.legend))return}const o=V(t),{pan:u,zoom:l={}}=o.options;if(s.button!==0||zn(ye(u),s)||tn(ye(l.drag),s))return G(l.onZoomRejected,[{chart:t,event:s}]);Zn(t,s,l)!==!1&&(o.dragStart=s,Te(t,t.canvas.ownerDocument,"mousemove",to),Te(t,window.document,"keydown",eo))}function so({begin:t,end:s},o){let u=s.x-t.x,l=s.y-t.y;const c=Math.abs(u/l);c>o?u=Math.sign(u)*Math.abs(l*o):c<o&&(l=Math.sign(l)*Math.abs(u/o)),s.x=t.x+u,s.y=t.y+l}function An(t,s,o,{min:u,max:l,prop:c}){t[u]=kn(Math.min(o.begin[c],o.end[c]),s[u],s[l]),t[l]=kn(Math.max(o.begin[c],o.end[c]),s[u],s[l])}function oo(t,s,o){const u={begin:qe(s.dragStart,t),end:qe(s.dragEnd,t)};if(o){const l=t.chartArea.width/t.chartArea.height;so(u,l)}return u}function Xn(t,s,o,u){const l=Ht(s,"x",t),c=Ht(s,"y",t),{top:h,left:g,right:_,bottom:E,width:I,height:D}=t.chartArea,L={top:h,left:g,right:_,bottom:E},z=oo(t,o,u&&l&&c);l&&An(L,t.chartArea,z,{min:"left",max:"right",prop:"x"}),c&&An(L,t.chartArea,z,{min:"top",max:"bottom",prop:"y"});const Lt=L.right-L.left,J=L.bottom-L.top;return{...L,width:Lt,height:J,zoomX:l&&Lt?1+(I-Lt)/I:1,zoomY:c&&J?1+(D-J)/D:1}}function io(t,s){const o=V(t);if(!o.dragStart)return;ht(t,"mousemove");const{mode:u,onZoomComplete:l,drag:{threshold:c=0,maintainAspectRatio:h}}=o.options.zoom,g=Xn(t,u,{dragStart:o.dragStart,dragEnd:s},h),_=Ht(u,"x",t)?g.width:0,E=Ht(u,"y",t)?g.height:0,I=Math.sqrt(_*_+E*E);if(o.dragStart=o.dragEnd=null,I<=c){o.dragging=!1,t.update("none");return}Gn(t,{x:g.left,y:g.top},{x:g.right,y:g.bottom},"zoom","drag"),o.dragging=!1,o.filterNextClick=!0,G(l,[{chart:t}])}function ao(t,s,o){if(tn(ye(o.wheel),s)){G(o.onZoomRejected,[{chart:t,event:s}]);return}if(Zn(t,s,o)!==!1&&(s.cancelable&&s.preventDefault(),s.deltaY!==void 0))return!0}function ro(t,s){const{handlers:{onZoomComplete:o},options:{zoom:u}}=V(t);if(!ao(t,s,u))return;const l=s.target.getBoundingClientRect(),c=u.wheel.speed,h=s.deltaY>=0?2-1/(1-c):1+c,g={x:h,y:h,focalPoint:{x:s.clientX-l.left,y:s.clientY-l.top}};en(t,g,"zoom","wheel"),G(o,[{chart:t}])}function lo(t,s,o,u){o&&(V(t).handlers[s]=As(()=>G(o,[{chart:t}]),u))}function uo(t,s){const o=t.canvas,{wheel:u,drag:l,onZoomComplete:c}=s.zoom;u.enabled?(Te(t,o,"wheel",ro),lo(t,"onZoomComplete",c,250)):ht(t,"wheel"),l.enabled?(Te(t,o,"mousedown",no),Te(t,o.ownerDocument,"mouseup",io)):(ht(t,"mousedown"),ht(t,"mousemove"),ht(t,"mouseup"),ht(t,"keydown"))}function co(t){ht(t,"mousedown"),ht(t,"mousemove"),ht(t,"mouseup"),ht(t,"wheel"),ht(t,"click"),ht(t,"keydown")}function po(t,s){return function(o,u){const{pan:l,zoom:c={}}=s.options;if(!l||!l.enabled)return!1;const h=u&&u.srcEvent;return h&&!s.panning&&u.pointerType==="mouse"&&(tn(ye(l),h)||zn(ye(c.drag),h))?(G(l.onPanRejected,[{chart:t,event:u}]),!1):!0}}function fo(t,s){const o=Math.abs(t.clientX-s.clientX),u=Math.abs(t.clientY-s.clientY),l=o/u;let c,h;return l>.3&&l<1.7?c=h=!0:o>u?c=!0:h=!0,{x:c,y:h}}function $n(t,s,o){if(s.scale){const{center:u,pointers:l}=o,c=1/s.scale*o.scale,h=o.target.getBoundingClientRect(),g=fo(l[0],l[1]),_=s.options.zoom.mode,E={x:g.x&&Ht(_,"x",t)?c:1,y:g.y&&Ht(_,"y",t)?c:1,focalPoint:{x:u.x-h.left,y:u.y-h.top}};en(t,E,"zoom","pinch"),s.scale=o.scale}}function ho(t,s,o){if(s.options.zoom.pinch.enabled){const u=Je(o,t);G(s.options.zoom.onZoomStart,[{chart:t,event:o,point:u}])===!1?(s.scale=null,G(s.options.zoom.onZoomRejected,[{chart:t,event:o}])):s.scale=1}}function vo(t,s,o){s.scale&&($n(t,s,o),s.scale=null,G(s.options.zoom.onZoomComplete,[{chart:t}]))}function Wn(t,s,o){const u=s.delta;u&&(s.panning=!0,Qn(t,{x:o.deltaX-u.x,y:o.deltaY-u.y},s.panScales),s.delta={x:o.deltaX,y:o.deltaY})}function mo(t,s,o){const{enabled:u,onPanStart:l,onPanRejected:c}=s.options.pan;if(!u)return;const h=o.target.getBoundingClientRect(),g={x:o.center.x-h.left,y:o.center.y-h.top};if(G(l,[{chart:t,event:o,point:g}])===!1)return G(c,[{chart:t,event:o}]);s.panScales=Fn(s.options.pan,g,t),s.delta={x:0,y:0},Wn(t,s,o)}function go(t,s){s.delta=null,s.panning&&(s.panning=!1,s.filterNextClick=!0,G(s.options.pan.onPanComplete,[{chart:t}]))}const je=new WeakMap;function Rn(t,s){const o=V(t),u=t.canvas,{pan:l,zoom:c}=s,h=new be.Manager(u);c&&c.pinch.enabled&&(h.add(new be.Pinch),h.on("pinchstart",g=>ho(t,o,g)),h.on("pinch",g=>$n(t,o,g)),h.on("pinchend",g=>vo(t,o,g))),l&&l.enabled&&(h.add(new be.Pan({threshold:l.threshold,enable:po(t,o)})),h.on("panstart",g=>mo(t,o,g)),h.on("panmove",g=>Wn(t,o,g)),h.on("panend",()=>go(t,o))),je.set(t,h)}function wn(t){const s=je.get(t);s&&(s.remove("pinchstart"),s.remove("pinch"),s.remove("pinchend"),s.remove("panstart"),s.remove("pan"),s.remove("panend"),s.destroy(),je.delete(t))}function bo(t,s){const{pan:o,zoom:u}=t,{pan:l,zoom:c}=s;return u?.zoom?.pinch?.enabled!==c?.zoom?.pinch?.enabled||o?.enabled!==l?.enabled||o?.threshold!==l?.threshold}var To="2.2.0";function Ae(t,s,o){const u=o.zoom.drag,{dragStart:l,dragEnd:c}=V(t);if(u.drawTime!==s||!c)return;const{left:h,top:g,width:_,height:E}=Xn(t,o.zoom.mode,{dragStart:l,dragEnd:c},u.maintainAspectRatio),I=t.ctx;I.save(),I.beginPath(),I.fillStyle=u.backgroundColor||"rgba(225,225,225,0.3)",I.fillRect(h,g,_,E),u.borderWidth>0&&(I.lineWidth=u.borderWidth,I.strokeStyle=u.borderColor||"rgba(225,225,225)",I.strokeRect(h,g,_,E)),I.restore()}var yo={id:"zoom",version:To,defaults:{pan:{enabled:!1,mode:"xy",threshold:10,modifierKey:null},zoom:{wheel:{enabled:!1,speed:.1,modifierKey:null},drag:{enabled:!1,drawTime:"beforeDatasetsDraw",modifierKey:null},pinch:{enabled:!1},mode:"xy"}},start:function(t,s,o){const u=V(t);u.options=o,Object.prototype.hasOwnProperty.call(o.zoom,"enabled")&&console.warn("The option `zoom.enabled` is no longer supported. Please use `zoom.wheel.enabled`, `zoom.drag.enabled`, or `zoom.pinch.enabled`."),(Object.prototype.hasOwnProperty.call(o.zoom,"overScaleMode")||Object.prototype.hasOwnProperty.call(o.pan,"overScaleMode"))&&console.warn("The option `overScaleMode` is deprecated. Please use `scaleMode` instead (and update `mode` as desired)."),be&&Rn(t,o),t.pan=(l,c,h)=>Qn(t,l,c,h),t.zoom=(l,c)=>en(t,l,c),t.zoomRect=(l,c,h)=>Gn(t,l,c,h),t.zoomScale=(l,c,h)=>$s(t,l,c,h),t.resetZoom=l=>Ws(t,l),t.getZoomLevel=()=>js(t),t.getInitialScaleBounds=()=>Yn(t),t.getZoomedScaleBounds=()=>Ks(t),t.isZoomedOrPanned=()=>Js(t),t.isZoomingOrPanning=()=>On(t)},beforeEvent(t,{event:s}){if(On(t))return!1;if(s.type==="click"||s.type==="mouseup"){const o=V(t);if(o.filterNextClick)return o.filterNextClick=!1,!1}},beforeUpdate:function(t,s,o){const u=V(t),l=u.options;u.options=o,bo(l,o)&&(wn(t),Rn(t,o)),uo(t,o)},beforeDatasetsDraw(t,s,o){Ae(t,"beforeDatasetsDraw",o)},afterDatasetsDraw(t,s,o){Ae(t,"afterDatasetsDraw",o)},beforeDraw(t,s,o){Ae(t,"beforeDraw",o)},afterDraw(t,s,o){Ae(t,"afterDraw",o)},stop:function(t){co(t),be&&wn(t),ws(t)},panFunctions:We,zoomFunctions:Xe,zoomRectFunctions:$e};const _o={class:"nav-bar"},Eo={key:0,class:"loading-state"},So={key:1,class:"error-state"},xo={class:"error-text"},Co={class:"session-header"},Io={class:"header-row"},Po={class:"track-name"},Mo={class:"header-meta"},Oo={class:"car"},ko={class:"master-detail"},Ao={class:"master"},Ro={class:"master-title"},wo={key:0,class:"sh-checkbox"},No={key:0,class:"single-stint-note"},Lo={class:"stint-list"},Do=["onClick"],zo={key:0,class:"stint-checkbox"},Fo={key:0,class:"checkbox-checked"},Uo={key:1,class:"checkbox-empty"},Vo=["title"],Bo={class:"stint-num"},Ho={class:"stint-laps"},Go={class:"delta-val"},Qo={class:"delta-lbl"},Yo={class:"detail"},Zo={key:0,class:"compare-header"},Xo={class:"compare-info"},$o={class:"compare-a"},Wo={class:"compare-b"},qo={key:1,class:"detail-header"},jo={class:"detail-title"},Ko={key:0,class:"best-tag"},Jo={key:2,class:"limited-data"},ti={class:"times-comparison"},ei={class:"tc-conditions"},ni={class:"tc-cond-item"},si={class:"tc-cond-val"},oi={class:"tc-cond-item"},ii={class:"tc-cond-val"},ai={class:"tc-main"},ri={class:"tc-column tc-actual"},li={class:"tc-header"},ui={class:"tc-row"},ci={class:"tc-label"},di={class:"tc-value"},pi={class:"tc-row"},fi={class:"tc-label"},hi={class:"tc-value"},vi={class:"tc-column tc-theo"},mi={class:"tc-header"},gi={key:0,class:"tc-row"},bi={class:"tc-value"},Ti={class:"tc-row"},yi={class:"tc-value"},_i={class:"tc-row"},Ei={class:"tc-value"},Si={class:"tc-column tc-deltas"},xi={class:"tc-header"},Ci={class:"tc-row"},Ii={class:"tc-row"},Pi={class:"tc-duration"},Mi={class:"tc-duration-value"},Oi={key:0,class:"tc-consistency"},ki={class:"tc-cons-title"},Ai={class:"tc-cons-simple"},Ri={class:"tc-cons-bar-wide"},wi={class:"tc-toggles-row"},Ni={class:"tc-toggle",title:"Mostra target zone sul grafico"},Li={key:0,class:"tc-toggle",title:"Mostra zone grip sul grafico"},Di={key:1,class:"tc-validity"},zi={class:"tc-cons-simple"},Fi={class:"tc-cons-bar-wide"},Ui={key:0,class:"tc-invalid-badge"},Vi={class:"chart-section"},Bi={class:"chart-header-row"},Hi={class:"chart-title"},Gi={class:"chart-toolbar"},Qi={key:0,class:"lap-manager"},Yi={class:"lap-manager-header"},Zi=["disabled"],Xi={class:"lap-manager-grid"},$i=["onClick","title"],Wi={key:0,class:"lap-manager-info"},qi={class:"chart-wrap"},ji={key:1,class:"grip-legend"},Ki={class:"grip-legend-label"},Ji={class:"grip-legend-laps"},ta={class:"laps-section"},ea={class:"laps-header-row"},na={key:0,class:"laps-tabs"},sa={key:1,class:"laps-title"},oa={class:"laps-table-wrap"},ia={class:"laps-table"},aa={class:"time"},ra={class:"status"},la=Ke({__name:"SessionDetailPage",props:{sessionId:{}},emits:["back","open-track"],setup(t,{emit:s}){vs.register(ms,gs,bs,Ts,ys,_s,Es,Ss,yo);const o=t,u=s,l=ct(!1),c=ct(new Set),h=ct(!1),g=ct(null);function _(p){const i=new Set(c.value);i.has(p)?i.delete(p):i.add(p),c.value=i}function E(){c.value=new Set}function I(){g.value?.chart&&g.value.chart.resetZoom()}function D(){g.value?.chart&&g.value.chart.zoom(1.2)}function L(){g.value?.chart&&g.value.chart.zoom(.8)}const{fetchSessionFull:z,trackStats:Lt,loadSessions:J}=ls(),Dt=ct(null),ie=ct(!0),Y=ct(null);Nn(async()=>{ie.value=!0,Y.value=null;try{await J();const p=await z(o.sessionId);p?(Dt.value=p,console.log("[SESSION_DETAIL] Loaded session:",p.session_info.track,p.stints.length,"stints")):Y.value="Sessione non trovata"}catch(p){Y.value=p.message||"Errore caricamento"}finally{ie.value=!1}});const st=ct(!1),j=ct([]),xt=ct("A"),ot=N(()=>st.value&&j.value.length===2),vt=N(()=>j.value[0]??it.value),yt=N(()=>j.value[1]??null);function At(p){st.value?Wt(p):it.value=p}function Wt(p){const i=j.value.indexOf(p);i>=0?j.value.splice(i,1):j.value.length<2&&j.value.push(p)}function zt(){j.value=[],st.value=!1,xt.value="A"}const F=N(()=>{if(!Dt.value)return{id:o.sessionId,track:"Caricamento...",trackId:"",type:"practice",date:"-",time:"-",car:"-",startConditions:{weather:"-",airTemp:0,trackTemp:0},bestQualy:"--:--.---",bestRace:"--:--.---",theoQualy:"--:--.---",theoRace:"--:--.---",bestDeltaQ:{value:"-",stintNum:0},bestDeltaR:{value:"-",stintNum:0},stints:[],lapsData:{}};const p=Dt.value,i=p.session_info,m=p.stints.map(O=>{const A=O.laps.filter(mt=>mt.is_valid&&!mt.has_pit_stop),U=A.length>0?Math.min(...A.map(mt=>mt.lap_time_ms)):null,Z=O.avg_clean_lap||null;return{number:O.stint_number,type:O.type==="Qualify"?"Q":"R",intent:O.type==="Qualify"?"Qualy Push":"Race Pace",fuelStart:O.fuel_start,laps:O.laps.length,best:U?St(U):"--:--.---",avg:Z?St(Z):"--:--.---",durationMs:O.stint_drive_time_ms||0,theoretical:St(i.session_best_lap),deltaVsTheo:U?`+${((U-i.session_best_lap)/1e3).toFixed(3)}`:"-",conditions:{weather:i.start_weather,avgAirTemp:i.start_air_temp,avgTrackTemp:i.start_road_temp},breakdown:{base:"-",deltaTemp:"-",deltaGrip:"-"}}}),y={};p.stints.forEach(O=>{y[O.stint_number]=O.laps.map(A=>({lap:A.lap_number,time:St(A.lap_time_ms),delta:`+${((A.lap_time_ms-i.session_best_lap)/1e3).toFixed(3)}`,valid:A.is_valid,pit:A.has_pit_stop,sectors:A.sector_times_ms?.map(U=>(U/1e3).toFixed(1))||["-","-","-"],fuel:Math.round(A.fuel_remaining),trackTemp:Math.round(A.road_temp),airTemp:A.air_temp||0,weather:A.rain_intensity||"No Rain",grip:A.track_grip_status||"Opt"}))});let f=null,x=null,k=0,H=0;return p.stints.forEach(O=>{const A=O.laps.filter(Z=>Z.is_valid&&!Z.has_pit_stop);if(A.length===0)return;const U=Math.min(...A.map(Z=>Z.lap_time_ms));O.type==="Qualify"?(!f||U<f)&&(f=U,k=O.stint_number):(!x||U<x)&&(x=U,H=O.stint_number)}),{id:o.sessionId,track:i.track,trackId:i.track.toLowerCase().replace(/[^a-z0-9]/g,"_"),type:ps(i.session_type),date:ds(i.date_start),time:cs(i.date_start),car:us(i.car),startConditions:{weather:i.start_weather,airTemp:i.start_air_temp,trackTemp:i.start_road_temp},bestQualy:f?St(f):"--:--.---",bestRace:x?St(x):"--:--.---",theoQualy:St(i.session_best_lap),theoRace:St(i.session_best_lap),bestDeltaQ:{value:f?`+${((f-i.session_best_lap)/1e3).toFixed(3)}`:"-",stintNum:k},bestDeltaR:{value:x?`+${((x-i.session_best_lap)/1e3).toFixed(3)}`:"-",stintNum:H},stints:m,lapsData:y}}),X=N(()=>{if(!Dt.value)return{theoQualy:null,theoRace:null,theoAvgRace:null};const i=Dt.value.session_info,m=$.value.grip.dominant||"Optimum",y=$.value.airTemp.avg||Math.round(i.start_air_temp||23),f=(i.track||"").toLowerCase().replace(/[^a-z0-9]/g,"_"),x=Lt.value.find(O=>{const A=O.track.toLowerCase().replace(/[^a-z0-9]/g,"_");return A.includes(f)||f.includes(A)});if(!x?.bestByGrip)return{theoQualy:null,theoRace:null,theoAvgRace:null,dominantGrip:m,stintTemp:y};const k=x.bestByGrip[m];if(!k)return{theoQualy:null,theoRace:null,theoAvgRace:null,dominantGrip:m,stintTemp:y};function H(O,A){if(!O)return null;const U=Math.round(A||y),mt=(y-U)*100;return Math.round(O+mt)}return{theoQualy:H(k.bestQualy,k.bestQualyTemp),theoRace:H(k.bestRace,k.bestRaceTemp),theoAvgRace:H(k.bestAvgRace,k.bestAvgRaceTemp),dominantGrip:m,stintTemp:y,historicQualy:k.bestQualy,historicQualyTemp:k.bestQualyTemp,historicRace:k.bestRace,historicRaceTemp:k.bestRaceTemp,historicAvgRace:k.bestAvgRace,historicAvgRaceTemp:k.bestAvgRaceTemp}}),it=ct(1);vn(()=>F.value.stints,p=>{if(p.length>0){const i=p.filter(m=>m.laps>=2);if(i.length>0){let m=i[0],y=parseFloat(m.deltaVsTheo)||999;i.forEach(f=>{const x=parseFloat(f.deltaVsTheo)||999;x<y&&(m=f,y=x)}),it.value=m.number}else it.value=p[0]?.number||1}},{immediate:!0});const R=N(()=>F.value.stints.find(p=>p.number===it.value)),at=N(()=>F.value.lapsData[it.value]||[]);N(()=>at.value.length<=1);const _e=N(()=>F.value.stints.length===1);vn(at,p=>{if(p.length>20){const i=p[0]?.lap,m=p[p.length-1]?.lap,y=[i,m].filter(Boolean);c.value=new Set(y)}else c.value=new Set},{immediate:!0});const ae=N(()=>vt.value?F.value.stints.find(p=>p.number===vt.value):null),re=N(()=>yt.value?F.value.stints.find(p=>p.number===yt.value):null),Ee=N(()=>vt.value?F.value.lapsData[vt.value]||[]:[]),qt=N(()=>yt.value?F.value.lapsData[yt.value]||[]:[]),Qt=N(()=>xt.value==="A"?Ee.value:qt.value);N(()=>xt.value==="A"?ae.value:re.value);const we=N(()=>{const p=F.value.stints.filter(m=>m.type==="Q"&&m.laps>=2);if(p.length===0)return null;let i=p[0];return p.forEach(m=>{parseFloat(m.deltaVsTheo)<parseFloat(i.deltaVsTheo)&&(i=m)}),i}),le=N(()=>{const p=F.value.stints.filter(m=>m.type==="R"&&m.laps>=2);if(p.length===0)return null;let i=p[0];return p.forEach(m=>{parseFloat(m.deltaVsTheo)<parseFloat(i.deltaVsTheo)&&(i=m)}),i});function ue(p){return p.type==="Q"?we.value?.number===p.number:p.type==="R"?le.value?.number===p.number:!1}function Ft(p){const m=(F.value.lapsData[p.number]||[]).filter(f=>!f.pit),y=m.filter(f=>f.valid);return m.length>0&&y.length===0?{icon:"⚠️",message:"Tutti i giri invalidi"}:p.type==="R"&&m.length<5?{icon:"⚠️",message:`Stint gara troppo corto (${m.length} giri, min. 5)`}:p.type==="Q"&&m.length<=1?{icon:"⚠️",message:"Dati limitati (1 giro)"}:null}function Q(p){return p<35?"#ef4444":p<75?"#f97316":"#10b981"}const $=N(()=>{const p=at.value.filter(et=>!et.pit);if(p.length===0)return{airTemp:{start:0,mid:0,end:0,changed:!1},grip:{dominant:"Optimum",percentages:[],changed:!1,display:"Optimum"}};const i=Math.floor(p.length/2),m=p.length-1,y=Math.round(p[0]?.airTemp||0),f=Math.round(p[i]?.airTemp||y),x=Math.round(p[m]?.airTemp||y),k=Math.abs(y-x)>=2||Math.abs(y-f)>=2,H={},O=[];let A=0;for(const et of p){const gt=et.grip||"Unknown";gt!=="Unknown"&&gt!=="Opt"&&(H[gt]||O.push(gt),H[gt]=(H[gt]||0)+1,A++)}const U=[];let Z="Optimum",mt=0;for(const et of O){const gt=H[et],P=Math.round(gt/A*100);U.push({grip:et,pct:P}),gt>mt&&(mt=gt,Z=et)}const Jt=U.length>1;let Pt=Z;Jt&&(Pt=U.map(et=>`${et.grip} (${et.pct}%)`).join(" → "));const pe=k?Math.round((y+f+x)/3):y;return{airTemp:{start:y,mid:f,end:x,changed:k,avg:pe},grip:{dominant:Z,percentages:U,changed:Jt,display:Pt}}}),B=N(()=>{const i=(ot.value?Ee.value:at.value).filter(P=>!c.value.has(P.lap)),m=ot.value?ae.value:R.value,y=m?.type==="Q",f=y?X.value.theoQualy:X.value.theoRace,x=f?f/1e3:0,k=x>0?x+.3:0,H=m?.best;rt(H);const O=P=>P.pit?!1:rt(P.time)<=k,A=P=>P.pit||!P.valid?!1:O(P),U=P=>P.pit||!P.valid?!1:P.time===H,Z=i.map(P=>P.pit?"#6b7280":P.valid?_t.value&&U(P)?"#a855f7":_t.value&&A(P)?"#10b981":"#3b82f6":"#ef4444"),mt=i.map(P=>P.pit?"#6b7280":P.valid?_t.value&&U(P)?"#a855f7":_t.value&&A(P)?"#10b981":"#3b82f6":_t.value&&O(P)?"#10b981":"#ef4444"),Jt=i.map(P=>!P.valid&&!P.pit&&_t.value&&O(P)?2:1),Pt=[{label:ot.value?`A: Stint #${vt.value}`:"Tempo",data:i.map(P=>rt(P.time)),borderColor:"#3b82f6",backgroundColor:"rgba(59,130,246,0.1)",pointBackgroundColor:Z,pointBorderColor:mt,pointBorderWidth:Jt,pointRadius:5,tension:.2,order:1},{label:`Teorico ${m?.type==="Q"?"Q":"R"}`,data:i.map(()=>x),borderColor:"#f59e0b",borderDash:[5,5],pointRadius:0,order:3}];if(!y&&_t.value&&i.length>0&&Pt.push({label:"Target (+0.3s)",data:i.map(()=>k),borderColor:"rgba(16, 185, 129, 0.6)",borderWidth:2,borderDash:[3,3],backgroundColor:"rgba(16, 185, 129, 0.05)",fill:"origin",pointRadius:0,order:4}),jt.value&&de.value&&i.length>0){const P=Math.max(...i.map(lt=>rt(lt.time)))+5;Se.value.forEach((lt,fe)=>{const Ne=Kt[lt.gripLevel]||Kt.Opt,Le=i.map((nn,te)=>{const xe=te+1;return xe>=lt.startLap&&xe<=lt.endLap?P:null});Pt.push({label:`_grip_${fe}`,data:Le,borderColor:"transparent",backgroundColor:Ne?.bg,fill:"origin",pointRadius:0,order:10+fe,spanGaps:!1})})}if(ot.value&&qt.value.length>0){const P=qt.value;Pt.splice(1,0,{label:`B: Stint #${yt.value}`,data:P.map(lt=>rt(lt.time)),borderColor:"#8b5cf6",backgroundColor:"rgba(139,92,246,0.1)",pointBackgroundColor:P.map(lt=>lt.pit?"#6b7280":lt.valid?"#8b5cf6":"#ef4444"),pointRadius:5,tension:.2})}const et=ot.value?Math.max(i.length,qt.value.length):i.length;return{labels:Array.from({length:et},(P,lt)=>`G${lt+1}`),datasets:Pt}}),tt={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{color:"rgba(255,255,255,0.7)",font:{size:11},filter:p=>!p.text.startsWith("_")}},tooltip:{backgroundColor:"rgba(15,15,25,0.95)",callbacks:{label:p=>p.dataset.label?.startsWith("_")?"":`${p.dataset.label}: ${Rt(p.raw)}`}},zoom:{pan:{enabled:!0,mode:"x",modifierKey:void 0},zoom:{wheel:{enabled:!0},pinch:{enabled:!0},mode:"x",drag:{enabled:!1}},limits:{x:{min:"original",max:"original"}}}},scales:{x:{grid:{color:"rgba(255,255,255,0.08)"},ticks:{color:"rgba(255,255,255,0.6)",font:{size:11}}},y:{grid:{color:"rgba(255,255,255,0.08)"},ticks:{color:"rgba(255,255,255,0.6)",font:{size:11},callback:p=>typeof p=="number"?Rt(p):p}}}};function rt(p){if(!p)return 0;const i=p.split(":"),m=Number(i[0])||0,y=Number(i[1])||0;return m*60+y}function Rt(p){return`${Math.floor(p/60)}:${(p%60).toFixed(3).padStart(6,"0")}`}function Yt(p){return{practice:"PRACTICE",qualify:"QUALIFY",race:"RACE"}[p]||p.toUpperCase()}function Ct(p){if(!p||p==="-")return"far";const i=parseFloat(p);return isNaN(i)?"far":i<0?"faster":i===0?"ontarget":i<=.3?"close":i<=.5?"margin":"far"}function Zt(p){if(!p||p==="-")return"-";const i=parseFloat(p);return isNaN(i)?"-":i<0?"FASTER":i===0?"TARGET":i<=.3?"VICINO":i<=.5?"MARGINE":"LONTANO"}function dt(p){if(!p)return"-";const m=p.type==="Q"?X.value.theoQualy:X.value.theoRace;if(!m)return"-";const y=rt(p.best);if(y===0)return"-";const f=m/1e3,x=y-f;return x>=0?`+${x.toFixed(3)}`:x.toFixed(3)}const It=N(()=>{if(!R.value)return{value:"-",seconds:0,class:"neutral"};const p=rt(R.value.best);if(p===0)return{value:"-",seconds:0,class:"neutral"};let i=null;if(R.value.type==="Q"?i=X.value.theoQualy:i=X.value.theoRace,!i)return{value:"-",seconds:0,class:"neutral"};const m=i/1e3,y=p-m,f=y>=0?`+${y.toFixed(3)}`:y.toFixed(3);return{value:f,seconds:y,class:Ct(f)}}),ce=N(()=>{if(!R.value)return{value:"-",seconds:0,class:"neutral"};const p=rt(R.value.avg);if(p===0)return{value:"-",seconds:0,class:"neutral"};if(R.value.type==="Q")return{value:"-",seconds:0,class:"neutral"};const i=X.value.theoAvgRace;if(!i)return{value:"-",seconds:0,class:"neutral"};const m=i/1e3,y=p-m,f=y>=0?`+${y.toFixed(3)}`:y.toFixed(3);return{value:f,seconds:y,class:Ct(f)}}),Ut=N(()=>{if(!R.value||at.value.length===0)return{onTarget:0,total:0,pct:0,targetLine:"-"};const i=R.value.type==="Q"?X.value.theoQualy:X.value.theoRace;if(!i)return{onTarget:0,total:0,pct:0,targetLine:"-"};const y=i/1e3+.3,f=at.value.filter(H=>!H.pit),x=f.length;let k=0;return f.forEach(H=>{rt(H.time)<=y&&k++}),{onTarget:k,total:x,pct:x>0?Math.round(k/x*100):0,targetLine:Rt(y)}}),bt=N(()=>{const p=at.value.filter(f=>!f.pit),i=p.length,m=p.filter(f=>f.valid).length,y=i-m;return{valid:m,invalid:y,total:i,pct:i>0?Math.round(m/i*100):100}}),pt=N(()=>{if(!R.value)return{hours:0,minutes:0,seconds:0,formatted:"0min 00sec",showSeconds:!0};const p=R.value.durationMs||0;let i=0;p===0&&at.value.length>0?at.value.forEach(H=>{i+=rt(H.time)}):i=Math.floor(p/1e3);const m=Math.floor(i/3600),y=Math.floor(i%3600/60),f=Math.floor(i%60);let x="";const k=m===0;return m>0?x=`${m}h ${y.toString().padStart(2,"0")}min`:x=`${y}min ${f.toString().padStart(2,"0")}sec`,{hours:m,minutes:y,seconds:f,formatted:x,showSeconds:k}}),_t=ct(!0),jt=ct(!1),Kt={Opt:{bg:"rgba(16, 185, 129, 0.15)",border:"#10b981",label:"Optimum"},Green:{bg:"rgba(132, 204, 22, 0.15)",border:"#84cc16",label:"Green"},Greasy:{bg:"rgba(234, 179, 8, 0.15)",border:"#eab308",label:"Greasy"},Damp:{bg:"rgba(249, 115, 22, 0.15)",border:"#f97316",label:"Damp"},Wet:{bg:"rgba(59, 130, 246, 0.15)",border:"#3b82f6",label:"Wet"},Flooded:{bg:"rgba(139, 92, 246, 0.15)",border:"#8b5cf6",label:"Flooded"}},de=N(()=>{const p=at.value;if(p.length<2)return!1;const i=p[0]?.grip;return p.some(m=>m.grip!==i)}),Se=N(()=>{const p=at.value;if(p.length===0)return[];const i=[];let m=p[0]?.grip||"Opt",y=1;return p.forEach((f,x)=>{f.grip!==m&&(i.push({gripLevel:m,startLap:y,endLap:x}),m=f.grip,y=x+1)}),i.push({gripLevel:m,startLap:y,endLap:p.length}),i});return(p,i)=>{const m=Ps,y=fs;return S(),Dn(y,{class:"session-detail-page"},{default:se(()=>[r("div",_o,[r("button",{class:"nav-btn",onClick:i[0]||(i[0]=f=>u("back"))},[...i[9]||(i[9]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M15 18l-6-6 6-6"})],-1),w(" Torna alle sessioni ",-1)])]),r("button",{class:"nav-btn nav-btn--accent",onClick:i[1]||(i[1]=f=>u("open-track",F.value.trackId))},[...i[10]||(i[10]=[w(" Apri pista ",-1),r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M9 18l6-6-6-6"})],-1)])])]),ie.value?(S(),C("div",Eo,[...i[11]||(i[11]=[r("div",{class:"loading-spinner"},null,-1),r("p",null,"Caricamento sessione...",-1)])])):Y.value?(S(),C("div",So,[i[12]||(i[12]=r("p",{class:"error-icon"},"⚠️",-1)),r("p",xo,T(Y.value),1),r("button",{class:"nav-btn",onClick:i[2]||(i[2]=f=>u("back"))},"Torna alle sessioni")])):(S(),C(ft,{key:2},[r("header",Co,[r("div",Io,[r("h1",Po,T(F.value.track.toUpperCase()),1),r("span",{class:nt(["type-badge",`type-badge--${F.value.type}`])},T(Yt(F.value.type)),3)]),r("div",Mo,[r("span",null,T(F.value.date),1),i[13]||(i[13]=r("span",{class:"sep"},"•",-1)),r("span",null,T(F.value.time),1),i[14]||(i[14]=r("span",{class:"sep"},"•",-1)),r("span",Oo,T(F.value.car),1)])]),r("div",ko,[r("aside",Ao,[r("h2",Ro,"Stint ("+T(F.value.stints.length)+")",1),i[20]||(i[20]=r("div",{class:"control-panel"},[r("button",{class:"control-btn control-btn--disabled",disabled:"",title:"Coming soon"},[r("span",{class:"control-icon"},"⚖️"),r("span",{class:"control-label"},"Confronta stint")]),r("span",{class:"control-hint"},"Coming soon")],-1)),r("div",{class:nt(["stint-header",{"stint-header--compare":st.value}])},[st.value?(S(),C("span",wo,"✓")):q("",!0),i[15]||(i[15]=r("span",{class:"sh-best-icon"},null,-1)),i[16]||(i[16]=r("span",{class:"sh-type"},"Tipo",-1)),i[17]||(i[17]=r("span",{class:"sh-num"},"#",-1)),i[18]||(i[18]=r("span",{class:"sh-laps"},"Giri",-1)),i[19]||(i[19]=r("span",{class:"sh-delta"},"Δ Theo",-1))],2),_e.value?(S(),C("div",No," 1 stint in sessione · Nessun confronto interno disponibile ")):q("",!0),r("div",Lo,[(S(!0),C(ft,null,ke(F.value.stints,f=>(S(),C("button",{key:f.number,class:nt(["stint-item",{"stint-item--compare":st.value,selected:!st.value&&it.value===f.number,"compare-selected":st.value&&j.value.includes(f.number),"compare-a":st.value&&j.value[0]===f.number,"compare-b":st.value&&j.value[1]===f.number,"best-stint":ue(f)}]),onClick:x=>At(f.number)},[st.value?(S(),C("span",zo,[j.value.includes(f.number)?(S(),C("span",Fo,T(j.value[0]===f.number?"A":"B"),1)):(S(),C("span",Uo))])):q("",!0),r("span",{class:"stint-best-icon",title:Ft(f)?.message},[ue(f)?(S(),C(ft,{key:0},[w("🏆")],64)):Ft(f)?(S(),C(ft,{key:1},[w(T(Ft(f)?.icon),1)],64)):q("",!0)],8,Vo),r("span",{class:nt(["stint-type",`stint-type--${f.type.toLowerCase()}`])},T(f.type),3),r("span",Bo,"#"+T(f.number),1),r("span",Ho,T(f.laps),1),r("span",{class:nt(["stint-delta",`delta--${Ct(dt(f))}`])},[r("span",Go,T(dt(f)),1),r("span",Qo,T(Zt(dt(f))),1)],2)],10,Do))),128))])]),r("section",Yo,[ot.value?(S(),C("div",Zo,[r("div",Xo,[i[21]||(i[21]=r("span",{class:"compare-label"},"Confronto Stint:",-1)),r("span",$o,"A: #"+T(vt.value)+" "+T(ae.value?.type),1),i[22]||(i[22]=r("span",{class:"compare-vs"},"vs",-1)),r("span",Wo,"B: #"+T(yt.value)+" "+T(re.value?.type),1)]),r("button",{class:"compare-close",onClick:zt},"✕ Chiudi confronto")])):q("",!0),ot.value?q("",!0):(S(),C("div",qo,[r("span",{class:nt(["stint-type-tag",`stint-type-tag--${R.value?.type?.toLowerCase()}`])},T(R.value?.type==="Q"?"QUALY":"RACE"),3),r("h3",jo,"Stint #"+T(it.value)+" · "+T(R.value?.intent??"Seleziona uno stint"),1),R.value&&ue(R.value)?(S(),C("span",Ko,"🏆 Best")):q("",!0)])),R.value&&Ft(R.value)?(S(),C("div",Jo,T(Ft(R.value)?.icon)+" "+T(Ft(R.value)?.message),1)):q("",!0),r("div",ti,[r("div",ei,[r("span",ni,[i[23]||(i[23]=r("span",{class:"tc-cond-lbl"},"Aria",-1)),r("span",si,[$.value.airTemp.changed?(S(),C(ft,{key:0},[w(T($.value.airTemp.start)+"° → "+T($.value.airTemp.mid)+"° → "+T($.value.airTemp.end)+"° ",1)],64)):(S(),C(ft,{key:1},[w(T($.value.airTemp.start)+"°",1)],64))])]),r("span",oi,[i[24]||(i[24]=r("span",{class:"tc-cond-lbl"},"Grip",-1)),r("span",ii,T($.value.grip.display),1)])]),r("div",ai,[r("div",ri,[r("h5",li,[i[26]||(i[26]=w(" TEMPI STINT ",-1)),ne(m,{title:"Tempi Stint",position:"left"},{default:se(()=>[...i[25]||(i[25]=[r("b",null,"BEST:",-1),w(" Giro più veloce tra i giri validi dello stint.",-1),r("br",null,null,-1),r("b",null,"AVG:",-1),w(' Media dei giri "puliti" (validi, no pit, no outlap, entro 115% del best). ',-1)])]),_:1})]),r("div",ui,[r("span",ci,T(R.value?.type==="Q"?"BEST STINT Q:":"BEST STINT R:"),1),r("span",di,T(R.value?.best??"-"),1)]),r("div",pi,[r("span",fi,T(R.value?.type==="Q"?"AVG STINT Q:":"AVG STINT R:"),1),r("span",hi,T(R.value?.avg??"-"),1)])]),i[33]||(i[33]=r("div",{class:"tc-divider"},null,-1)),r("div",vi,[r("h5",mi,[w(" TEORICI ("+T($.value.grip.dominant||"Optimum")+" "+T($.value.airTemp.avg)+"°) ",1),ne(m,{title:"Tempi Teorici",position:"right"},{default:se(()=>[...i[27]||(i[27]=[w(" Best storico per il grip dominante + aggiustamento temperatura:",-1),r("br",null,null,-1),r("code",null,"Teorico = Storico + (TempStint - TempStorico) × 0.1s/°C",-1),r("br",null,null,-1),w(" Pista più fredda = tempo più veloce ",-1)])]),_:1})]),R.value?.type==="Q"?(S(),C("div",gi,[i[28]||(i[28]=r("span",{class:"tc-label"},"THEO BEST Q:",-1)),r("span",bi,T(X.value.theoQualy?kt(St)(X.value.theoQualy):"—:—.---"),1)])):(S(),C(ft,{key:1},[r("div",Ti,[i[29]||(i[29]=r("span",{class:"tc-label"},"THEO BEST R:",-1)),r("span",yi,T(X.value.theoRace?kt(St)(X.value.theoRace):"—:—.---"),1)]),r("div",_i,[i[30]||(i[30]=r("span",{class:"tc-label"},"THEO AVG:",-1)),r("span",Ei,T(X.value.theoAvgRace?kt(St)(X.value.theoAvgRace):"—:—.---"),1)])],64))]),i[34]||(i[34]=r("div",{class:"tc-divider"},null,-1)),r("div",Si,[r("h5",xi,[i[32]||(i[32]=w(" DELTA ",-1)),ne(m,{title:"Legenda Colori Delta",position:"right"},{default:se(()=>[...i[31]||(i[31]=[r("span",{style:{color:"#10b981"}},"●",-1),w(),r("b",null,"Verde",-1),w(" = Più veloce o = al teorico",-1),r("br",null,null,-1),r("span",{style:{color:"#eab308"}},"●",-1),w(),r("b",null,"Giallo",-1),w(" = Vicino (+0.0 - +0.3s)",-1),r("br",null,null,-1),r("span",{style:{color:"#f97316"}},"●",-1),w(),r("b",null,"Arancione",-1),w(" = Margine (+0.3 - +0.5s)",-1),r("br",null,null,-1),r("span",{style:{color:"#ef4444"}},"●",-1),w(),r("b",null,"Rosso",-1),w(" = Lontano (> +0.5s) ",-1)])]),_:1})]),r("div",Ci,[r("span",{class:nt(["tc-delta-inline",It.value.class])},T(It.value.value),3)]),r("div",Ii,[r("span",{class:nt(["tc-delta-inline",ce.value.class])},T(ce.value.value),3)])])]),r("div",Pi,[i[35]||(i[35]=r("span",{class:"tc-duration-label"},"DURATA STINT:",-1)),r("span",Mi,T(pt.value.formatted),1)]),R.value?.type==="R"&&Ut.value.total>0?(S(),C("div",Oi,[r("span",ki,[i[37]||(i[37]=w(" GIRI NEL TARGET ",-1)),ne(m,{title:"Target = Teorico + 0.3s",position:"left",size:"small"},{default:se(()=>[...i[36]||(i[36]=[w(" Conta quanti giri dello stint hanno un tempo ≤ al target.",-1),r("br",null,null,-1),w(" Include tutti i giri (validi e invalidi), esclusi i pit. ",-1)])]),_:1})]),r("div",Ai,[r("div",Ri,[r("div",{class:"tc-cons-fill",style:ge({width:Ut.value.pct+"%",background:Q(Ut.value.pct)})},null,4)]),r("span",{class:"tc-cons-pct",style:ge({color:Q(Ut.value.pct)})},T(Ut.value.pct)+"%",5)]),r("div",wi,[r("label",Ni,[mn(r("input",{type:"checkbox","onUpdate:modelValue":i[3]||(i[3]=f=>_t.value=f)},null,512),[[gn,_t.value]]),i[38]||(i[38]=r("span",{class:"tc-toggle-slider"},null,-1)),i[39]||(i[39]=r("span",{class:"tc-toggle-label"},"Target",-1))]),de.value?(S(),C("label",Li,[mn(r("input",{type:"checkbox","onUpdate:modelValue":i[4]||(i[4]=f=>jt.value=f)},null,512),[[gn,jt.value]]),i[40]||(i[40]=r("span",{class:"tc-toggle-slider"},null,-1)),i[41]||(i[41]=r("span",{class:"tc-toggle-label"},"Grip",-1))])):q("",!0)])])):q("",!0),bt.value.total>0?(S(),C("div",Di,[i[43]||(i[43]=r("span",{class:"tc-cons-title"},"GIRI VALIDI",-1)),r("div",zi,[r("div",Fi,[r("div",{class:"tc-cons-fill",style:ge({width:bt.value.pct+"%",background:Q(bt.value.pct)})},null,4)]),r("span",{class:"tc-cons-pct",style:ge({color:Q(bt.value.pct)})},T(bt.value.pct)+"%",5)]),bt.value.invalid>0?(S(),C("span",Ui,[i[42]||(i[42]=r("span",{class:"tc-invalid-dot"},null,-1)),w(" "+T(bt.value.invalid)+" invalidi ",1)])):q("",!0)])):q("",!0)]),r("div",Vi,[r("div",Bi,[r("h4",Hi,[ot.value?(S(),C(ft,{key:0},[w("Confronto Tempi — A: Stint #"+T(vt.value)+" vs B: Stint #"+T(yt.value),1)],64)):(S(),C(ft,{key:1},[w("Tempi Giro — Stint "+T(it.value),1)],64))]),r("div",Gi,[r("button",{class:"toolbar-btn",onClick:D,title:"Zoom In"},[...i[44]||(i[44]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("circle",{cx:"11",cy:"11",r:"8"}),r("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),r("line",{x1:"11",y1:"8",x2:"11",y2:"14"}),r("line",{x1:"8",y1:"11",x2:"14",y2:"11"})],-1)])]),r("button",{class:"toolbar-btn",onClick:L,title:"Zoom Out"},[...i[45]||(i[45]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("circle",{cx:"11",cy:"11",r:"8"}),r("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"}),r("line",{x1:"8",y1:"11",x2:"14",y2:"11"})],-1)])]),r("button",{class:"toolbar-btn",onClick:I,title:"Reset Zoom"},[...i[46]||(i[46]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("polyline",{points:"1 4 1 10 7 10"}),r("polyline",{points:"23 20 23 14 17 14"}),r("path",{d:"M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"})],-1)])]),i[48]||(i[48]=r("div",{class:"toolbar-divider"},null,-1)),r("button",{class:nt(["toolbar-btn",{"toolbar-btn--active":h.value}]),onClick:i[5]||(i[5]=f=>h.value=!h.value),title:"Gestisci Giri"},[...i[47]||(i[47]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),r("line",{x1:"3",y1:"9",x2:"21",y2:"9"}),r("line",{x1:"9",y1:"21",x2:"9",y2:"9"})],-1)])],2)])]),h.value?(S(),C("div",Qi,[r("div",Yi,[i[49]||(i[49]=r("span",{class:"lap-manager-title"},"Escludi Giri dal Grafico",-1)),r("button",{class:"lap-manager-reset",onClick:E,disabled:c.value.size===0}," Reset ",8,Zi)]),r("div",Xi,[(S(!0),C(ft,null,ke(at.value,f=>(S(),C("button",{key:f.lap,class:nt(["lap-toggle-btn",{"lap-toggle-btn--excluded":c.value.has(f.lap)},{"lap-toggle-btn--invalid":!f.valid&&!f.pit},{"lap-toggle-btn--pit":f.pit}]),onClick:x=>_(f.lap),title:`Giro ${f.lap} - ${f.time}${f.valid?"":" (Invalido)"}${f.pit?" (Pit)":""}`},T(f.lap),11,$i))),128))]),c.value.size>0?(S(),C("div",Wi,T(c.value.size)+" giri esclusi ",1)):q("",!0)])):q("",!0),r("div",qi,[ne(kt(xs),{ref_key:"chartRef",ref:g,data:B.value,options:tt},null,8,["data"])]),de.value&&jt.value?(S(),C("div",ji,[i[50]||(i[50]=r("span",{class:"grip-legend-title"},"Grip:",-1)),(S(!0),C(ft,null,ke(Se.value,f=>(S(),C("div",{key:`${f.gripLevel}-${f.startLap}`,class:"grip-legend-item"},[r("span",{class:"grip-legend-dot",style:ge({backgroundColor:Kt[f.gripLevel]?.border||"#fff"})},null,4),r("span",Ki,T(Kt[f.gripLevel]?.label||f.gripLevel),1),r("span",Ji,"(G"+T(f.startLap)+"-G"+T(f.endLap)+")",1)]))),128))])):q("",!0)]),r("div",ta,[r("div",ea,[ot.value?(S(),C("div",na,[r("button",{class:nt(["lap-tab",{"lap-tab--active":xt.value==="A"}]),onClick:i[6]||(i[6]=f=>xt.value="A")}," A: Stint #"+T(vt.value),3),r("button",{class:nt(["lap-tab",{"lap-tab--active":xt.value==="B"}]),onClick:i[7]||(i[7]=f=>xt.value="B")}," B: Stint #"+T(yt.value),3)])):(S(),C("h4",sa,"Tabella Giri — Stint "+T(it.value),1)),r("button",{class:"toggle-btn",onClick:i[8]||(i[8]=f=>l.value=!l.value)},T(l.value?"Vista semplice":"Dettagli"),1)]),r("div",oa,[r("table",ia,[r("thead",null,[r("tr",null,[i[57]||(i[57]=r("th",null,"Giro",-1)),i[58]||(i[58]=r("th",null,"Tempo",-1)),i[59]||(i[59]=r("th",null,"Δ Teorico",-1)),i[60]||(i[60]=r("th",null,"Stato",-1)),l.value?(S(),C(ft,{key:0},[i[51]||(i[51]=r("th",null,"S1",-1)),i[52]||(i[52]=r("th",null,"S2",-1)),i[53]||(i[53]=r("th",null,"S3",-1)),i[54]||(i[54]=r("th",null,"Fuel",-1)),i[55]||(i[55]=r("th",null,"Track°",-1)),i[56]||(i[56]=r("th",null,"Grip",-1))],64)):q("",!0)])]),r("tbody",null,[(S(!0),C(ft,null,ke(ot.value?Qt.value:at.value,f=>(S(),C("tr",{key:f.lap,class:nt({invalid:!f.valid,pit:f.pit,excluded:c.value.has(f.lap)})},[r("td",null,T(f.lap),1),r("td",aa,T(f.time),1),r("td",{class:nt(["delta",`delta--${Ct(f.delta)}`])},T(f.delta),3),r("td",ra,T(f.pit?"PIT":f.valid?"✓":"INV"),1),l.value?(S(),C(ft,{key:0},[r("td",null,T(f.sectors[0]),1),r("td",null,T(f.sectors[1]),1),r("td",null,T(f.sectors[2]),1),r("td",null,T(f.fuel)+"L",1),r("td",null,T(f.trackTemp)+"°",1),r("td",null,T(f.grip),1)],64)):q("",!0)],2))),128))])])])])])])],64))]),_:1})}}}),ua=Object.assign(Ln(la,[["__scopeId","data-v-216c193c"]]),{__name:"PagesSessionDetailPage"}),fa=Ke({__name:"[id]",setup(t){const s=rs(),o=N(()=>s.params.id);return(u,l)=>{const c=ua;return S(),Dn(c,{"session-id":kt(o),onBack:l[0]||(l[0]=h=>("navigateTo"in u?u.navigateTo:kt(bn))("/sessioni")),onOpenTrack:l[1]||(l[1]=h=>("navigateTo"in u?u.navigateTo:kt(bn))(`/piste/${h}?from=${kt(o)}`))},null,8,["session-id"])}}});export{fa as default};
