import{_ as Y}from"./Bze_1V6Z.js";import{u as j,g as z,f as E,a as H,b as Z,c as J,S as P,_ as K}from"./ApLwZRIX.js";import{b as W,o as X,m as p,r as g,w as tt,J as et,D as n,H as st,E as t,C as l,G as at,Z as d,$ as O,N as m,O as _,F as i,a4 as B,_ as ot}from"./D0g2xLIp.js";const nt={class:"filters"},lt={class:"filters-left"},it={class:"filter-group"},rt={class:"segmented-control"},ct={class:"filter-group"},dt=["value"],ut={class:"filter-group"},vt=["value"],pt={class:"filter-group"},gt={class:"segmented-control segmented-control--compact"},mt={class:"filters-right"},_t={class:"view-toggle"},yt={key:0,class:"no-results"},bt={class:"day-header"},ft={class:"day-date"},ht={class:"day-count"},kt={class:"sessions-list"},Ct=["onClick"],wt={class:"row-left"},Tt={class:"session-time"},St={class:"session-track"},Rt={class:"session-car"},It={class:"row-right"},$t={class:"stat-chips"},xt={class:"stat-chip"},Mt={class:"stat-chip"},Et={class:"time-slot"},Pt={key:0,class:"time-badge time-badge--qualy"},Ot={key:1,class:"time-badge time-badge--qualy time-badge--empty"},Bt={class:"time-slot"},Nt={key:0,class:"time-badge time-badge--race"},Dt={key:1,class:"time-badge time-badge--race time-badge--empty"},Lt={key:2,class:"day-cards"},Qt={class:"card-header"},At={class:"card-header-info"},Gt={class:"card-date"},qt={class:"card-count"},Ut={class:"card-sessions"},Ft=["onClick"],Vt={class:"card-session-time"},Yt={class:"card-session-track"},jt={class:"card-session-car"},zt={class:"card-stat-chips"},Ht={class:"stat-chip"},Zt={class:"stat-chip"},Jt={class:"card-time-slot"},Kt={key:0,class:"time-badge time-badge--qualy"},Wt={key:1,class:"time-badge time-badge--qualy time-badge--empty"},Xt={class:"card-time-slot"},te={key:0,class:"time-badge time-badge--race"},ee={key:1,class:"time-badge time-badge--race time-badge--empty"},S=20,se=W({__name:"SessioniPage",emits:["go-to-session"],setup(ae,{emit:N}){const D=N,{sessions:L,loadSessions:Q}=j();X(async()=>{await Q()});const k=p(()=>L.value.map(a=>{const e=z(a.meta.session_type),c=a.meta.date_start?.split("T")[0]||"";return{id:a.sessionId,date:c,time:J(a.meta.date_start),type:e,track:Z(a.meta.track),car:H(a.meta.car),laps:a.summary.laps||0,stints:a.summary.stintCount||1,bestQualy:a.meta.session_type===P.QUALIFY?E(a.summary.bestLap):void 0,bestRace:a.meta.session_type===P.RACE?E(a.summary.bestLap):void 0}})),u=g("all"),y=g("all"),b=g("all"),r=g("all"),f=g("list"),A=p(()=>[...new Set(k.value.map(a=>a.track))].sort()),G=p(()=>[...new Set(k.value.map(a=>a.car))].sort()),C=p(()=>k.value.filter(a=>{if(u.value!=="all"&&a.type!==u.value||y.value!=="all"&&a.track!==y.value||b.value!=="all"&&a.car!==b.value)return!1;if(r.value!=="all"){const e=new Date,c=new Date(a.date),v=Math.floor((e.getTime()-c.getTime())/(1e3*60*60*24));if(r.value==="today"&&v>0||r.value==="7d"&&v>7||r.value==="30d"&&v>30)return!1}return!0}));p(()=>{const a={};for(const e of C.value)a[e.date]||(a[e.date]=[]),a[e.date].push(e);return Object.entries(a).sort(([e],[c])=>c.localeCompare(e)).map(([e,c])=>({date:e,sessions:c}))});const h=g(1),R=p(()=>C.value.length),q=p(()=>Math.max(1,Math.ceil(R.value/S))),w=p(()=>{const a=(h.value-1)*S,e=a+S,c=C.value.slice(a,e),v={};for(const s of c)v[s.date]||(v[s.date]=[]),v[s.date].push(s);return Object.entries(v).sort(([s],[o])=>o.localeCompare(s)).map(([s,o])=>({date:s,sessions:o}))});function U(){h.value=1}tt([u,y,b,r],U);const I=g(null),T=g(!1);function F(){T.value=!0}function $(a){const e=new Date(a),c=e.getDate(),s=["GENNAIO","FEBBRAIO","MARZO","APRILE","MAGGIO","GIUGNO","LUGLIO","AGOSTO","SETTEMBRE","OTTOBRE","NOVEMBRE","DICEMBRE"][e.getMonth()],o=e.getFullYear();return`${c} ${s} ${o}`}function x(a){return{practice:"PRACTICE",qualify:"QUALIFY",race:"RACE"}[a]}function M(a){D("go-to-session",a)}return(a,e)=>{const c=Y,v=K;return n(),et(v,null,{default:st(()=>[e[21]||(e[21]=t("h1",{class:"page-title"},"SESSIONI",-1)),t("div",nt,[t("div",lt,[t("div",it,[t("div",rt,[t("button",{class:d(["seg-btn",{"seg-btn--active":u.value==="all"}]),onClick:e[0]||(e[0]=s=>u.value="all")},"Tutto",2),t("button",{class:d(["seg-btn","seg-btn--practice",{"seg-btn--active":u.value==="practice"}]),onClick:e[1]||(e[1]=s=>u.value="practice")},"Practice",2),t("button",{class:d(["seg-btn","seg-btn--qualify",{"seg-btn--active":u.value==="qualify"}]),onClick:e[2]||(e[2]=s=>u.value="qualify")},"Qualify",2),t("button",{class:d(["seg-btn","seg-btn--race",{"seg-btn--active":u.value==="race"}]),onClick:e[3]||(e[3]=s=>u.value="race")},"Race",2)])]),t("div",ct,[O(t("select",{"onUpdate:modelValue":e[4]||(e[4]=s=>y.value=s),class:"filter-select"},[e[14]||(e[14]=t("option",{value:"all"},"Tutte le piste",-1)),(n(!0),l(m,null,_(A.value,s=>(n(),l("option",{key:s,value:s},i(s),9,dt))),128))],512),[[B,y.value]])]),t("div",ut,[O(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>b.value=s),class:"filter-select"},[e[15]||(e[15]=t("option",{value:"all"},"Tutte le auto",-1)),(n(!0),l(m,null,_(G.value,s=>(n(),l("option",{key:s,value:s},i(s),9,vt))),128))],512),[[B,b.value]])]),t("div",pt,[t("div",gt,[t("button",{class:d(["seg-btn",{"seg-btn--active":r.value==="today"}]),onClick:e[6]||(e[6]=s=>r.value="today")},"Oggi",2),t("button",{class:d(["seg-btn",{"seg-btn--active":r.value==="7d"}]),onClick:e[7]||(e[7]=s=>r.value="7d")},"7g",2),t("button",{class:d(["seg-btn",{"seg-btn--active":r.value==="30d"}]),onClick:e[8]||(e[8]=s=>r.value="30d")},"30g",2),t("button",{class:d(["seg-btn",{"seg-btn--active":r.value==="all"}]),onClick:e[9]||(e[9]=s=>r.value="all")},"Tutto",2)])])]),t("div",mt,[t("div",_t,[t("button",{class:d(["view-btn",{"view-btn--active":f.value==="list"}]),onClick:e[10]||(e[10]=s=>f.value="list"),title:"Vista lista"},[...e[16]||(e[16]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M8 6h13M8 12h13M8 18h13M3 6h.01M3 12h.01M3 18h.01"})],-1)])],2),t("button",{class:d(["view-btn",{"view-btn--active":f.value==="card"}]),onClick:e[11]||(e[11]=s=>f.value="card"),title:"Vista card"},[...e[17]||(e[17]=[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"3",y:"3",width:"7",height:"7",rx:"1"}),t("rect",{x:"14",y:"3",width:"7",height:"7",rx:"1"}),t("rect",{x:"3",y:"14",width:"7",height:"7",rx:"1"}),t("rect",{x:"14",y:"14",width:"7",height:"7",rx:"1"})],-1)])],2)])])]),w.value.length===0?(n(),l("div",yt,[...e[18]||(e[18]=[t("p",null,"Nessuna sessione trovata con i filtri selezionati.",-1)])])):f.value==="list"?(n(),l("div",{key:1,ref_key:"sessionsRef",ref:I,class:d(["day-groups",{"day-groups--fading":T.value}]),onTransitionend:e[12]||(e[12]=s=>T.value=!1)},[(n(!0),l(m,null,_(w.value,s=>(n(),l("div",{key:s.date,class:"day-group"},[t("div",bt,[t("span",ft,i($(s.date)),1),t("span",ht,i(s.sessions.length)+" sessioni",1)]),t("div",kt,[(n(!0),l(m,null,_(s.sessions,o=>(n(),l("div",{key:o.id,class:"session-row",onClick:V=>M(o.id)},[t("div",wt,[t("span",{class:d(["session-chip",`session-chip--${o.type}`])},i(x(o.type)),3),t("span",Tt,i(o.time),1),t("span",St,i(o.track),1),t("span",Rt,i(o.car),1)]),t("div",It,[t("div",$t,[t("span",xt,"GIRI "+i(o.laps),1),t("span",Mt,"STINT "+i(o.stints),1)]),t("div",Et,[o.bestQualy?(n(),l("span",Pt," Q "+i(o.bestQualy),1)):(n(),l("span",Ot," Q — "))]),t("div",Bt,[o.bestRace?(n(),l("span",Nt," R "+i(o.bestRace),1)):(n(),l("span",Dt," R — "))]),e[19]||(e[19]=t("span",{class:"session-cta"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M9 18l6-6-6-6"})])],-1))])],8,Ct))),128))])]))),128))],34)):(n(),l("div",Lt,[(n(!0),l(m,null,_(w.value,s=>(n(),l("div",{key:s.date,class:"day-card"},[t("div",Qt,[t("div",At,[t("span",Gt,i($(s.date)),1),t("span",qt,i(s.sessions.length)+" sessioni",1)])]),t("div",Ut,[(n(!0),l(m,null,_(s.sessions,o=>(n(),l("div",{key:o.id,class:"card-session-row",onClick:V=>M(o.id)},[t("span",{class:d(["session-chip",`session-chip--${o.type}`])},i(x(o.type)),3),t("span",Vt,i(o.time),1),t("span",Yt,i(o.track),1),t("span",jt,i(o.car),1),t("div",zt,[t("span",Ht,"GIRI "+i(o.laps),1),t("span",Zt,"STINT "+i(o.stints),1)]),t("div",Jt,[o.bestQualy?(n(),l("span",Kt," Q "+i(o.bestQualy),1)):(n(),l("span",Wt," Q — "))]),t("div",Xt,[o.bestRace?(n(),l("span",te," R "+i(o.bestRace),1)):(n(),l("span",ee," R — "))]),e[20]||(e[20]=t("span",{class:"session-cta"},[t("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[t("path",{d:"M9 18l6-6-6-6"})])],-1))],8,Ft))),128))])]))),128))])),at(c,{currentPage:h.value,"onUpdate:currentPage":e[13]||(e[13]=s=>h.value=s),"total-pages":q.value,"total-items":R.value,"scroll-target":I.value,"item-label":"sessioni",onPageChange:F},null,8,["currentPage","total-pages","total-items","scroll-target"])]),_:1})}}}),ie=Object.assign(ot(se,[["__scopeId","data-v-ba198446"]]),{__name:"PagesSessioniPage"});export{ie as _};
